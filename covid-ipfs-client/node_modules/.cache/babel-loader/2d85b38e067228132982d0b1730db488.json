{"ast":null,"code":"import \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/steps/style\";\nimport _Steps from \"antd/es/steps\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport \"antd/es/row/style\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/col/style\";\nimport _Col from \"antd/es/col\";\nvar _excluded = [\"current\", \"onCurrentChange\", \"submitter\", \"stepsFormRender\", \"stepsRender\", \"stepFormRender\", \"stepsProps\", \"onFinish\", \"formProps\", \"containerStyle\", \"formRef\", \"formMapRef\"];\nimport { ConfigProviderWrap, useIntl } from '@ant-design/pro-provider';\nimport { merge, useRefFunction } from '@ant-design/pro-utils';\nimport classNames from 'classnames';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport React, { useCallback, useContext, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport './index.less';\nimport StepForm from './StepForm';\nexport var StepsFormProvide = /*#__PURE__*/React.createContext(undefined);\nvar StepsLayoutStrategy = {\n  horizontal: function horizontal(_ref) {\n    var stepsDom = _ref.stepsDom,\n        formDom = _ref.formDom;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(_Row, {\n      gutter: {\n        xs: 8,\n        sm: 16,\n        md: 24\n      }\n    }, /*#__PURE__*/React.createElement(_Col, {\n      span: 24\n    }, stepsDom)), /*#__PURE__*/React.createElement(_Row, {\n      gutter: {\n        xs: 8,\n        sm: 16,\n        md: 24\n      }\n    }, /*#__PURE__*/React.createElement(_Col, {\n      span: 24\n    }, formDom)));\n  },\n  vertical: function vertical(_ref2) {\n    var stepsDom = _ref2.stepsDom,\n        formDom = _ref2.formDom;\n    return /*#__PURE__*/React.createElement(_Row, {\n      align: \"stretch\",\n      wrap: true,\n      gutter: {\n        xs: 8,\n        sm: 16,\n        md: 24\n      }\n    }, /*#__PURE__*/React.createElement(_Col, {\n      xxl: 4,\n      xl: 6,\n      lg: 7,\n      md: 8,\n      sm: 10,\n      xs: 12\n    }, /*#__PURE__*/React.cloneElement(stepsDom, {\n      style: {\n        height: '100%'\n      }\n    })), /*#__PURE__*/React.createElement(_Col, null, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        width: '100%',\n        height: '100%'\n      }\n    }, formDom)));\n  }\n};\n\nfunction StepsForm(props) {\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-steps-form');\n\n  var current = props.current,\n      onCurrentChange = props.onCurrentChange,\n      submitter = props.submitter,\n      stepsFormRender = props.stepsFormRender,\n      stepsRender = props.stepsRender,\n      stepFormRender = props.stepFormRender,\n      stepsProps = props.stepsProps,\n      onFinish = props.onFinish,\n      formProps = props.formProps,\n      containerStyle = props.containerStyle,\n      formRef = props.formRef,\n      propsFormMapRef = props.formMapRef,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var formDataRef = useRef(new Map());\n  var formMapRef = useRef(new Map());\n  var formArrayRef = useRef([]);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      formArray = _useState2[0],\n      setFormArray = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var intl = useIntl();\n  /**\n   * 受控的方式来操作表单\n   */\n\n  var _useMergedState = useMergedState(0, {\n    value: props.current,\n    onChange: props.onCurrentChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      step = _useMergedState2[0],\n      setStep = _useMergedState2[1];\n\n  var layoutRender = useMemo(function () {\n    return StepsLayoutStrategy[(stepsProps === null || stepsProps === void 0 ? void 0 : stepsProps.direction) || 'horizontal'];\n  }, [stepsProps === null || stepsProps === void 0 ? void 0 : stepsProps.direction]);\n  var lastStep = useMemo(function () {\n    return step === formArray.length - 1;\n  }, [formArray.length, step]);\n  /**\n   * 注册一个form进入，方便进行 props 的修改\n   */\n\n  var regForm = useCallback(function (name, childrenFormProps) {\n    if (!formMapRef.current.has(name)) {\n      setFormArray(function (oldFormArray) {\n        return [].concat(_toConsumableArray(oldFormArray), [name]);\n      });\n    }\n\n    formMapRef.current.set(name, childrenFormProps);\n  }, []);\n  /**\n   * 解除挂载掉这个 form，同时步数 -1\n   */\n\n  var unRegForm = useCallback(function (name) {\n    setFormArray(function (oldFormArray) {\n      return oldFormArray.filter(function (n) {\n        return n === name;\n      });\n    });\n    formMapRef.current.delete(name);\n    formDataRef.current.delete(name);\n  }, []);\n  useImperativeHandle(propsFormMapRef, function () {\n    return formArrayRef.current;\n  });\n  useImperativeHandle(formRef, function () {\n    var _formArrayRef$current;\n\n    return (_formArrayRef$current = formArrayRef.current[step || 0]) === null || _formArrayRef$current === void 0 ? void 0 : _formArrayRef$current.current;\n  }, [step]);\n  /**\n   * ProForm处理了一下 from 的数据，在其中做了一些操作 如果使用 Provider 自带的，自带的数据处理就无法生效了\n   */\n\n  var onFormFinish = useCallback( /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(name, formData) {\n      var values, success;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              formDataRef.current.set(name, formData); // 如果不是最后一步\n\n              if (!(!lastStep || !onFinish)) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 3:\n              setLoading(true);\n              values = merge.apply(void 0, [{}].concat(_toConsumableArray(Array.from(formDataRef.current.values()))));\n              _context.prev = 5;\n              _context.next = 8;\n              return onFinish(values);\n\n            case 8:\n              success = _context.sent;\n\n              if (success) {\n                setStep(0);\n                formArrayRef.current.forEach(function (form) {\n                  var _form$current;\n\n                  return (_form$current = form.current) === null || _form$current === void 0 ? void 0 : _form$current.resetFields();\n                });\n              }\n\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](5);\n              console.log(_context.t0);\n\n            case 15:\n              _context.prev = 15;\n              setLoading(false);\n              return _context.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 12, 15, 18]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }(), [lastStep, onFinish, setLoading, setStep]);\n  var stepsDom = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(prefixCls, \"-steps-container\"),\n      style: {\n        maxWidth: Math.min(formArray.length * 320, 1160)\n      }\n    }, /*#__PURE__*/React.createElement(_Steps, _extends({}, stepsProps, {\n      current: step,\n      onChange: undefined\n    }), formArray.map(function (item) {\n      var itemProps = formMapRef.current.get(item);\n      return /*#__PURE__*/React.createElement(_Steps.Step, _extends({\n        key: item,\n        title: itemProps === null || itemProps === void 0 ? void 0 : itemProps.title\n      }, itemProps === null || itemProps === void 0 ? void 0 : itemProps.stepProps));\n    })));\n  }, [formArray, prefixCls, step, stepsProps]);\n  var onSubmit = useRefFunction(function () {\n    var _from$current;\n\n    var from = formArrayRef.current[step];\n    (_from$current = from.current) === null || _from$current === void 0 ? void 0 : _from$current.submit();\n  });\n  /** 上一页功能 */\n\n  var prePage = useRefFunction(function () {\n    if (step < 1) return;\n    setStep(step - 1);\n  });\n  var next = useMemo(function () {\n    return submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n      key: \"next\",\n      type: \"primary\",\n      loading: loading\n    }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n      onClick: function onClick() {\n        var _submitter$onSubmit;\n\n        submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit = submitter.onSubmit) === null || _submitter$onSubmit === void 0 ? void 0 : _submitter$onSubmit.call(submitter);\n        onSubmit();\n      }\n    }), intl.getMessage('stepsForm.next', '下一步'));\n  }, [intl, loading, onSubmit, submitter]);\n  var pre = useMemo(function () {\n    return submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n      key: \"pre\"\n    }, submitter === null || submitter === void 0 ? void 0 : submitter.resetButtonProps, {\n      onClick: function onClick() {\n        var _submitter$onReset;\n\n        prePage();\n        submitter === null || submitter === void 0 ? void 0 : (_submitter$onReset = submitter.onReset) === null || _submitter$onReset === void 0 ? void 0 : _submitter$onReset.call(submitter);\n      }\n    }), intl.getMessage('stepsForm.prev', '上一步'));\n  }, [intl, prePage, submitter]);\n  var submit = useMemo(function () {\n    return submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n      key: \"submit\",\n      type: \"primary\",\n      loading: loading\n    }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n      onClick: function onClick() {\n        var _submitter$onSubmit2;\n\n        submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit2 = submitter.onSubmit) === null || _submitter$onSubmit2 === void 0 ? void 0 : _submitter$onSubmit2.call(submitter);\n        onSubmit();\n      }\n    }), intl.getMessage('stepsForm.submit', '提交'));\n  }, [intl, loading, onSubmit, submitter]);\n  var nextPage = useRefFunction(function () {\n    if (step > formArray.length - 2) return;\n    setStep(step + 1);\n  });\n  var submitterDom = useMemo(function () {\n    var buttons = [];\n    var index = step || 0;\n\n    if (index < 1) {\n      buttons.push(next);\n    } else if (index + 1 === formArray.length) {\n      buttons.push(pre, submit);\n    } else {\n      buttons.push(pre, next);\n    }\n\n    buttons = buttons.filter(React.isValidElement);\n\n    if (submitter && submitter.render) {\n      var _formArrayRef$current2;\n\n      var submitterProps = {\n        form: (_formArrayRef$current2 = formArrayRef.current[step]) === null || _formArrayRef$current2 === void 0 ? void 0 : _formArrayRef$current2.current,\n        onSubmit: onSubmit,\n        step: step,\n        onPre: prePage\n      };\n      return submitter.render(submitterProps, buttons);\n    }\n\n    if (submitter && (submitter === null || submitter === void 0 ? void 0 : submitter.render) === false) {\n      return null;\n    }\n\n    return buttons;\n  }, [formArray.length, next, onSubmit, pre, prePage, step, submit, submitter]);\n  var formDom = useMemo(function () {\n    return toArray(props.children).map(function (item, index) {\n      var itemProps = item.props;\n      var name = itemProps.name || \"\".concat(index);\n      /** 是否是当前的表单 */\n\n      var isShow = step === index;\n      var config = isShow ? {\n        contentRender: stepFormRender,\n        submitter: false\n      } : {};\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(\"\".concat(prefixCls, \"-step\"), _defineProperty({}, \"\".concat(prefixCls, \"-step-active\"), isShow)),\n        key: name\n      }, /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, config), formProps), itemProps), {}, {\n        name: name,\n        step: index,\n        key: name\n      })));\n    });\n  }, [formProps, prefixCls, props.children, step, stepFormRender]);\n  var finalStepsDom = useMemo(function () {\n    if (stepsRender) {\n      return stepsRender(formArray.map(function (item) {\n        var _formMapRef$current$g;\n\n        return {\n          key: item,\n          title: (_formMapRef$current$g = formMapRef.current.get(item)) === null || _formMapRef$current$g === void 0 ? void 0 : _formMapRef$current$g.title\n        };\n      }), stepsDom);\n    }\n\n    return stepsDom;\n  }, [formArray, stepsDom, stepsRender]);\n  var formContainer = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(prefixCls, \"-container\"),\n      style: containerStyle\n    }, formDom, stepsFormRender ? null : /*#__PURE__*/React.createElement(_Space, null, submitterDom));\n  }, [containerStyle, formDom, prefixCls, stepsFormRender, submitterDom]);\n  var stepsFormDom = useMemo(function () {\n    var doms = {\n      stepsDom: finalStepsDom,\n      formDom: formContainer\n    };\n\n    if (stepsFormRender) {\n      return stepsFormRender(layoutRender(doms), submitterDom);\n    }\n\n    return layoutRender(doms);\n  }, [finalStepsDom, formContainer, layoutRender, stepsFormRender, submitterDom]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: prefixCls\n  }, /*#__PURE__*/React.createElement(_Form.Provider, rest, /*#__PURE__*/React.createElement(StepsFormProvide.Provider, {\n    value: {\n      loading: loading,\n      setLoading: setLoading,\n      regForm: regForm,\n      keyArray: formArray,\n      next: nextPage,\n      formArrayRef: formArrayRef,\n      formMapRef: formMapRef,\n      lastStep: lastStep,\n      unRegForm: unRegForm,\n      onFormFinish: onFormFinish\n    }\n  }, stepsFormDom)));\n}\n\nexport { StepsFormWarp as StepsForm };\n\nfunction StepsFormWarp(props) {\n  return /*#__PURE__*/React.createElement(ConfigProviderWrap, null, /*#__PURE__*/React.createElement(StepsForm, props));\n}\n\nStepsFormWarp.StepForm = StepForm;\nStepsFormWarp.useForm = _Form.useForm;","map":{"version":3,"sources":["/Users/jameszow/Documents/RustWorkSpace/covid-ipfs/covid-ipfs-client/node_modules/@ant-design/pro-form/es/layouts/StepsForm/index.js"],"names":["_Form","_Space","_objectSpread","_defineProperty","_Button","_Steps","_extends","_regeneratorRuntime","_asyncToGenerator","_toConsumableArray","_slicedToArray","_objectWithoutProperties","_ConfigProvider","_Row","_Col","_excluded","ConfigProviderWrap","useIntl","merge","useRefFunction","classNames","toArray","useMergedState","React","useCallback","useContext","useImperativeHandle","useMemo","useRef","useState","StepForm","StepsFormProvide","createContext","undefined","StepsLayoutStrategy","horizontal","_ref","stepsDom","formDom","createElement","Fragment","gutter","xs","sm","md","span","vertical","_ref2","align","wrap","xxl","xl","lg","cloneElement","style","height","display","alignItems","width","StepsForm","props","_useContext","ConfigContext","getPrefixCls","prefixCls","current","onCurrentChange","submitter","stepsFormRender","stepsRender","stepFormRender","stepsProps","onFinish","formProps","containerStyle","formRef","propsFormMapRef","formMapRef","rest","formDataRef","Map","formArrayRef","_useState","_useState2","formArray","setFormArray","_useState3","_useState4","loading","setLoading","intl","_useMergedState","value","onChange","_useMergedState2","step","setStep","layoutRender","direction","lastStep","length","regForm","name","childrenFormProps","has","oldFormArray","concat","set","unRegForm","filter","n","delete","_formArrayRef$current","onFormFinish","_ref3","mark","_callee","formData","values","success","_callee$","_context","prev","next","abrupt","apply","Array","from","sent","forEach","form","_form$current","resetFields","t0","console","log","finish","stop","_x","_x2","arguments","className","maxWidth","Math","min","map","item","itemProps","get","Step","key","title","stepProps","onSubmit","_from$current","submit","prePage","type","submitButtonProps","onClick","_submitter$onSubmit","call","getMessage","pre","resetButtonProps","_submitter$onReset","onReset","_submitter$onSubmit2","nextPage","submitterDom","buttons","index","push","isValidElement","render","_formArrayRef$current2","submitterProps","onPre","children","isShow","config","contentRender","finalStepsDom","_formMapRef$current$g","formContainer","stepsFormDom","doms","Provider","keyArray","StepsFormWarp","useForm"],"mappings":"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","sourcesContent":["import \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/steps/style\";\nimport _Steps from \"antd/es/steps\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/helpers/esm/regeneratorRuntime\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport \"antd/es/row/style\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/col/style\";\nimport _Col from \"antd/es/col\";\nvar _excluded = [\"current\", \"onCurrentChange\", \"submitter\", \"stepsFormRender\", \"stepsRender\", \"stepFormRender\", \"stepsProps\", \"onFinish\", \"formProps\", \"containerStyle\", \"formRef\", \"formMapRef\"];\nimport { ConfigProviderWrap, useIntl } from '@ant-design/pro-provider';\nimport { merge, useRefFunction } from '@ant-design/pro-utils';\nimport classNames from 'classnames';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport React, { useCallback, useContext, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport './index.less';\nimport StepForm from './StepForm';\nexport var StepsFormProvide = /*#__PURE__*/React.createContext(undefined);\nvar StepsLayoutStrategy = {\n  horizontal: function horizontal(_ref) {\n    var stepsDom = _ref.stepsDom,\n        formDom = _ref.formDom;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(_Row, {\n      gutter: {\n        xs: 8,\n        sm: 16,\n        md: 24\n      }\n    }, /*#__PURE__*/React.createElement(_Col, {\n      span: 24\n    }, stepsDom)), /*#__PURE__*/React.createElement(_Row, {\n      gutter: {\n        xs: 8,\n        sm: 16,\n        md: 24\n      }\n    }, /*#__PURE__*/React.createElement(_Col, {\n      span: 24\n    }, formDom)));\n  },\n  vertical: function vertical(_ref2) {\n    var stepsDom = _ref2.stepsDom,\n        formDom = _ref2.formDom;\n    return /*#__PURE__*/React.createElement(_Row, {\n      align: \"stretch\",\n      wrap: true,\n      gutter: {\n        xs: 8,\n        sm: 16,\n        md: 24\n      }\n    }, /*#__PURE__*/React.createElement(_Col, {\n      xxl: 4,\n      xl: 6,\n      lg: 7,\n      md: 8,\n      sm: 10,\n      xs: 12\n    }, /*#__PURE__*/React.cloneElement(stepsDom, {\n      style: {\n        height: '100%'\n      }\n    })), /*#__PURE__*/React.createElement(_Col, null, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        width: '100%',\n        height: '100%'\n      }\n    }, formDom)));\n  }\n};\n\nfunction StepsForm(props) {\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-steps-form');\n\n  var current = props.current,\n      onCurrentChange = props.onCurrentChange,\n      submitter = props.submitter,\n      stepsFormRender = props.stepsFormRender,\n      stepsRender = props.stepsRender,\n      stepFormRender = props.stepFormRender,\n      stepsProps = props.stepsProps,\n      onFinish = props.onFinish,\n      formProps = props.formProps,\n      containerStyle = props.containerStyle,\n      formRef = props.formRef,\n      propsFormMapRef = props.formMapRef,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var formDataRef = useRef(new Map());\n  var formMapRef = useRef(new Map());\n  var formArrayRef = useRef([]);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      formArray = _useState2[0],\n      setFormArray = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var intl = useIntl();\n  /**\n   * 受控的方式来操作表单\n   */\n\n  var _useMergedState = useMergedState(0, {\n    value: props.current,\n    onChange: props.onCurrentChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      step = _useMergedState2[0],\n      setStep = _useMergedState2[1];\n\n  var layoutRender = useMemo(function () {\n    return StepsLayoutStrategy[(stepsProps === null || stepsProps === void 0 ? void 0 : stepsProps.direction) || 'horizontal'];\n  }, [stepsProps === null || stepsProps === void 0 ? void 0 : stepsProps.direction]);\n  var lastStep = useMemo(function () {\n    return step === formArray.length - 1;\n  }, [formArray.length, step]);\n  /**\n   * 注册一个form进入，方便进行 props 的修改\n   */\n\n  var regForm = useCallback(function (name, childrenFormProps) {\n    if (!formMapRef.current.has(name)) {\n      setFormArray(function (oldFormArray) {\n        return [].concat(_toConsumableArray(oldFormArray), [name]);\n      });\n    }\n\n    formMapRef.current.set(name, childrenFormProps);\n  }, []);\n  /**\n   * 解除挂载掉这个 form，同时步数 -1\n   */\n\n  var unRegForm = useCallback(function (name) {\n    setFormArray(function (oldFormArray) {\n      return oldFormArray.filter(function (n) {\n        return n === name;\n      });\n    });\n    formMapRef.current.delete(name);\n    formDataRef.current.delete(name);\n  }, []);\n  useImperativeHandle(propsFormMapRef, function () {\n    return formArrayRef.current;\n  });\n  useImperativeHandle(formRef, function () {\n    var _formArrayRef$current;\n\n    return (_formArrayRef$current = formArrayRef.current[step || 0]) === null || _formArrayRef$current === void 0 ? void 0 : _formArrayRef$current.current;\n  }, [step]);\n  /**\n   * ProForm处理了一下 from 的数据，在其中做了一些操作 如果使用 Provider 自带的，自带的数据处理就无法生效了\n   */\n\n  var onFormFinish = useCallback( /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(name, formData) {\n      var values, success;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              formDataRef.current.set(name, formData); // 如果不是最后一步\n\n              if (!(!lastStep || !onFinish)) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 3:\n              setLoading(true);\n              values = merge.apply(void 0, [{}].concat(_toConsumableArray(Array.from(formDataRef.current.values()))));\n              _context.prev = 5;\n              _context.next = 8;\n              return onFinish(values);\n\n            case 8:\n              success = _context.sent;\n\n              if (success) {\n                setStep(0);\n                formArrayRef.current.forEach(function (form) {\n                  var _form$current;\n\n                  return (_form$current = form.current) === null || _form$current === void 0 ? void 0 : _form$current.resetFields();\n                });\n              }\n\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](5);\n              console.log(_context.t0);\n\n            case 15:\n              _context.prev = 15;\n              setLoading(false);\n              return _context.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 12, 15, 18]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }(), [lastStep, onFinish, setLoading, setStep]);\n  var stepsDom = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(prefixCls, \"-steps-container\"),\n      style: {\n        maxWidth: Math.min(formArray.length * 320, 1160)\n      }\n    }, /*#__PURE__*/React.createElement(_Steps, _extends({}, stepsProps, {\n      current: step,\n      onChange: undefined\n    }), formArray.map(function (item) {\n      var itemProps = formMapRef.current.get(item);\n      return /*#__PURE__*/React.createElement(_Steps.Step, _extends({\n        key: item,\n        title: itemProps === null || itemProps === void 0 ? void 0 : itemProps.title\n      }, itemProps === null || itemProps === void 0 ? void 0 : itemProps.stepProps));\n    })));\n  }, [formArray, prefixCls, step, stepsProps]);\n  var onSubmit = useRefFunction(function () {\n    var _from$current;\n\n    var from = formArrayRef.current[step];\n    (_from$current = from.current) === null || _from$current === void 0 ? void 0 : _from$current.submit();\n  });\n  /** 上一页功能 */\n\n  var prePage = useRefFunction(function () {\n    if (step < 1) return;\n    setStep(step - 1);\n  });\n  var next = useMemo(function () {\n    return submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n      key: \"next\",\n      type: \"primary\",\n      loading: loading\n    }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n      onClick: function onClick() {\n        var _submitter$onSubmit;\n\n        submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit = submitter.onSubmit) === null || _submitter$onSubmit === void 0 ? void 0 : _submitter$onSubmit.call(submitter);\n        onSubmit();\n      }\n    }), intl.getMessage('stepsForm.next', '下一步'));\n  }, [intl, loading, onSubmit, submitter]);\n  var pre = useMemo(function () {\n    return submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n      key: \"pre\"\n    }, submitter === null || submitter === void 0 ? void 0 : submitter.resetButtonProps, {\n      onClick: function onClick() {\n        var _submitter$onReset;\n\n        prePage();\n        submitter === null || submitter === void 0 ? void 0 : (_submitter$onReset = submitter.onReset) === null || _submitter$onReset === void 0 ? void 0 : _submitter$onReset.call(submitter);\n      }\n    }), intl.getMessage('stepsForm.prev', '上一步'));\n  }, [intl, prePage, submitter]);\n  var submit = useMemo(function () {\n    return submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n      key: \"submit\",\n      type: \"primary\",\n      loading: loading\n    }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n      onClick: function onClick() {\n        var _submitter$onSubmit2;\n\n        submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit2 = submitter.onSubmit) === null || _submitter$onSubmit2 === void 0 ? void 0 : _submitter$onSubmit2.call(submitter);\n        onSubmit();\n      }\n    }), intl.getMessage('stepsForm.submit', '提交'));\n  }, [intl, loading, onSubmit, submitter]);\n  var nextPage = useRefFunction(function () {\n    if (step > formArray.length - 2) return;\n    setStep(step + 1);\n  });\n  var submitterDom = useMemo(function () {\n    var buttons = [];\n    var index = step || 0;\n\n    if (index < 1) {\n      buttons.push(next);\n    } else if (index + 1 === formArray.length) {\n      buttons.push(pre, submit);\n    } else {\n      buttons.push(pre, next);\n    }\n\n    buttons = buttons.filter(React.isValidElement);\n\n    if (submitter && submitter.render) {\n      var _formArrayRef$current2;\n\n      var submitterProps = {\n        form: (_formArrayRef$current2 = formArrayRef.current[step]) === null || _formArrayRef$current2 === void 0 ? void 0 : _formArrayRef$current2.current,\n        onSubmit: onSubmit,\n        step: step,\n        onPre: prePage\n      };\n      return submitter.render(submitterProps, buttons);\n    }\n\n    if (submitter && (submitter === null || submitter === void 0 ? void 0 : submitter.render) === false) {\n      return null;\n    }\n\n    return buttons;\n  }, [formArray.length, next, onSubmit, pre, prePage, step, submit, submitter]);\n  var formDom = useMemo(function () {\n    return toArray(props.children).map(function (item, index) {\n      var itemProps = item.props;\n      var name = itemProps.name || \"\".concat(index);\n      /** 是否是当前的表单 */\n\n      var isShow = step === index;\n      var config = isShow ? {\n        contentRender: stepFormRender,\n        submitter: false\n      } : {};\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(\"\".concat(prefixCls, \"-step\"), _defineProperty({}, \"\".concat(prefixCls, \"-step-active\"), isShow)),\n        key: name\n      }, /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, config), formProps), itemProps), {}, {\n        name: name,\n        step: index,\n        key: name\n      })));\n    });\n  }, [formProps, prefixCls, props.children, step, stepFormRender]);\n  var finalStepsDom = useMemo(function () {\n    if (stepsRender) {\n      return stepsRender(formArray.map(function (item) {\n        var _formMapRef$current$g;\n\n        return {\n          key: item,\n          title: (_formMapRef$current$g = formMapRef.current.get(item)) === null || _formMapRef$current$g === void 0 ? void 0 : _formMapRef$current$g.title\n        };\n      }), stepsDom);\n    }\n\n    return stepsDom;\n  }, [formArray, stepsDom, stepsRender]);\n  var formContainer = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(prefixCls, \"-container\"),\n      style: containerStyle\n    }, formDom, stepsFormRender ? null : /*#__PURE__*/React.createElement(_Space, null, submitterDom));\n  }, [containerStyle, formDom, prefixCls, stepsFormRender, submitterDom]);\n  var stepsFormDom = useMemo(function () {\n    var doms = {\n      stepsDom: finalStepsDom,\n      formDom: formContainer\n    };\n\n    if (stepsFormRender) {\n      return stepsFormRender(layoutRender(doms), submitterDom);\n    }\n\n    return layoutRender(doms);\n  }, [finalStepsDom, formContainer, layoutRender, stepsFormRender, submitterDom]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: prefixCls\n  }, /*#__PURE__*/React.createElement(_Form.Provider, rest, /*#__PURE__*/React.createElement(StepsFormProvide.Provider, {\n    value: {\n      loading: loading,\n      setLoading: setLoading,\n      regForm: regForm,\n      keyArray: formArray,\n      next: nextPage,\n      formArrayRef: formArrayRef,\n      formMapRef: formMapRef,\n      lastStep: lastStep,\n      unRegForm: unRegForm,\n      onFormFinish: onFormFinish\n    }\n  }, stepsFormDom)));\n}\n\nexport { StepsFormWarp as StepsForm };\n\nfunction StepsFormWarp(props) {\n  return /*#__PURE__*/React.createElement(ConfigProviderWrap, null, /*#__PURE__*/React.createElement(StepsForm, props));\n}\n\nStepsFormWarp.StepForm = StepForm;\nStepsFormWarp.useForm = _Form.useForm;"]},"metadata":{},"sourceType":"module"}