{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/row/style\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/divider/style\";\nimport _Divider from \"antd/es/divider\";\nimport \"antd/es/col/style\";\nimport _Col from \"antd/es/col\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nvar _excluded = [\"collapsed\", \"layout\", \"defaultCollapsed\", \"defaultColsNumber\", \"span\", \"searchGutter\", \"searchText\", \"resetText\", \"optionRender\", \"collapseRender\", \"onReset\", \"onCollapse\", \"labelWidth\", \"style\", \"split\", \"preserve\", \"ignoreRules\", \"showHiddenNum\"];\n\nvar _document, _document$body;\n/* eslint-disable no-param-reassign */\n\n\nimport { useIntl } from '@ant-design/pro-provider';\nimport { isBrowser, useMountMergeState } from '@ant-design/pro-utils';\nimport classNames from 'classnames';\nimport RcResizeObserver from 'rc-resize-observer';\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport React, { useContext, useMemo } from 'react';\nimport { BaseForm } from '../../BaseForm';\nimport Actions from './Actions';\nvar CONFIG_SPAN_BREAKPOINTS = {\n  xs: 513,\n  sm: 513,\n  md: 785,\n  lg: 992,\n  xl: 1057,\n  xxl: Infinity\n};\n/** 配置表单列变化的容器宽度断点 */\n\nvar BREAKPOINTS = {\n  vertical: [// [breakpoint, cols, layout]\n  [513, 1, 'vertical'], [785, 2, 'vertical'], [1057, 3, 'vertical'], [Infinity, 4, 'vertical']],\n  default: [[513, 1, 'vertical'], [701, 2, 'vertical'], [1062, 3, 'horizontal'], [1352, 3, 'horizontal'], [Infinity, 4, 'horizontal']]\n};\n/**\n * 合并用户和默认的配置\n *\n * @param layout\n * @param width\n */\n\nvar getSpanConfig = function getSpanConfig(layout, width, span) {\n  if (span && typeof span === 'number') {\n    return {\n      span: span,\n      layout: layout\n    };\n  }\n\n  var spanConfig = span ? ['xs', 'sm', 'md', 'lg', 'xl', 'xxl'].map(function (key) {\n    return [CONFIG_SPAN_BREAKPOINTS[key], 24 / span[key], 'horizontal'];\n  }) : BREAKPOINTS[layout || 'default'];\n  var breakPoint = (spanConfig || BREAKPOINTS.default).find(function (item) {\n    return width < item[0] + 16;\n  });\n  return {\n    span: 24 / breakPoint[1],\n    layout: breakPoint[2]\n  };\n};\n\nvar flatMapItems = function flatMapItems(items, ignoreRules) {\n  return items.flatMap(function (item) {\n    var _item$props;\n\n    if ((item === null || item === void 0 ? void 0 : item.type.displayName) === 'ProForm-Group' && !((_item$props = item.props) === null || _item$props === void 0 ? void 0 : _item$props.title)) {\n      return item.props.children;\n    }\n\n    if (ignoreRules && /*#__PURE__*/React.isValidElement(item)) {\n      var _item$props2;\n\n      return /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread({}, item.props), {}, {\n        formItemProps: _objectSpread(_objectSpread({}, (_item$props2 = item.props) === null || _item$props2 === void 0 ? void 0 : _item$props2.formItemProps), {}, {\n          rules: []\n        })\n      }));\n    }\n\n    return item;\n  });\n};\n\nvar QueryFilterContent = function QueryFilterContent(props) {\n  var intl = useIntl();\n  var resetText = props.resetText || intl.getMessage('tableForm.reset', '重置');\n  var searchText = props.searchText || intl.getMessage('tableForm.search', '搜索');\n\n  var _useMergedState = useMergedState(function () {\n    return props.defaultCollapsed && !!props.submitter;\n  }, {\n    value: props.collapsed,\n    onChange: props.onCollapse\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      collapsed = _useMergedState2[0],\n      setCollapsed = _useMergedState2[1];\n\n  var optionRender = props.optionRender,\n      collapseRender = props.collapseRender,\n      split = props.split,\n      items = props.items,\n      spanSize = props.spanSize,\n      showLength = props.showLength,\n      searchGutter = props.searchGutter,\n      showHiddenNum = props.showHiddenNum;\n  var submitter = useMemo(function () {\n    if (!props.submitter || optionRender === false) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.cloneElement(props.submitter, _objectSpread({\n      searchConfig: {\n        resetText: resetText,\n        submitText: searchText\n      },\n      render: optionRender ? function (_, dom) {\n        return optionRender(_objectSpread(_objectSpread({}, props), {}, {\n          resetText: resetText,\n          searchText: searchText\n        }), props, dom);\n      } : optionRender\n    }, props.submitter.props));\n  }, [props, resetText, searchText, optionRender]); // totalSpan 统计控件占的位置，计算 offset 保证查询按钮在最后一列\n\n  var totalSpan = 0;\n  var itemLength = 0; //首个表单项是否占满第一行\n\n  var firstRowFull = false; // totalSize 统计控件占的份数\n\n  var totalSize = 0; // for split compute\n\n  var currentSpan = 0; // 处理过，包含是否需要隐藏的 数组\n\n  var processedList = flatMapItems(items, props.ignoreRules).map(function (item, index) {\n    var _item$props$colSize, _item$props3, _item$props5, _item$props6; // 如果 formItem 自己配置了 hidden，默认使用它自己的\n\n\n    var colSize = /*#__PURE__*/React.isValidElement(item) ? (_item$props$colSize = item === null || item === void 0 ? void 0 : (_item$props3 = item.props) === null || _item$props3 === void 0 ? void 0 : _item$props3.colSize) !== null && _item$props$colSize !== void 0 ? _item$props$colSize : 1 : 1;\n    var colSpan = Math.min(spanSize.span * (colSize || 1), 24); // 计算总的 totalSpan 长度\n\n    totalSpan += colSpan; // 计算总的 colSize 长度\n\n    totalSize += colSize;\n\n    if (index === 0) {\n      var _item$props4;\n\n      firstRowFull = colSpan === 24 && !(item === null || item === void 0 ? void 0 : (_item$props4 = item.props) === null || _item$props4 === void 0 ? void 0 : _item$props4.hidden);\n    }\n\n    var hidden = (item === null || item === void 0 ? void 0 : (_item$props5 = item.props) === null || _item$props5 === void 0 ? void 0 : _item$props5.hidden) || // 如果收起了\n    collapsed && (firstRowFull || // 如果 超过显示长度 且 总长度超过了 24\n    totalSize > showLength - 1) && !!index && totalSpan >= 24;\n    itemLength += 1;\n    var itemKey = /*#__PURE__*/React.isValidElement(item) && (item.key || \"\".concat((_item$props6 = item.props) === null || _item$props6 === void 0 ? void 0 : _item$props6.name)) || index;\n\n    if ( /*#__PURE__*/React.isValidElement(item) && hidden) {\n      if (!props.preserve) {\n        return {\n          itemDom: null,\n          colSpan: colSpan,\n          hidden: true\n        };\n      }\n\n      return {\n        itemDom: /*#__PURE__*/React.cloneElement(item, {\n          hidden: true,\n          key: itemKey || index\n        }),\n        hidden: true,\n        colSpan: colSpan\n      };\n    }\n\n    return {\n      itemDom: item,\n      colSpan: colSpan,\n      hidden: false\n    };\n  });\n  var doms = processedList.map(function (itemProps, index) {\n    var _itemDom$props, _itemDom$props2;\n\n    var itemDom = itemProps.itemDom,\n        colSpan = itemProps.colSpan;\n    var hidden = itemDom === null || itemDom === void 0 ? void 0 : (_itemDom$props = itemDom.props) === null || _itemDom$props === void 0 ? void 0 : _itemDom$props.hidden;\n    if (hidden) return itemDom; // 每一列的key, 一般是存在的\n\n    var itemKey = /*#__PURE__*/React.isValidElement(itemDom) && (itemDom.key || \"\".concat((_itemDom$props2 = itemDom.props) === null || _itemDom$props2 === void 0 ? void 0 : _itemDom$props2.name)) || index;\n\n    if (24 - currentSpan % 24 < colSpan) {\n      // 如果当前行空余位置放不下，那么折行\n      totalSpan += 24 - currentSpan % 24;\n      currentSpan += 24 - currentSpan % 24;\n    }\n\n    currentSpan += colSpan;\n    var colItem = /*#__PURE__*/React.createElement(_Col, {\n      key: itemKey,\n      span: colSpan\n    }, itemDom);\n\n    if (split && currentSpan % 24 === 0 && index < itemLength - 1) {\n      return [colItem, /*#__PURE__*/React.createElement(_Col, {\n        span: \"24\",\n        key: \"line\"\n      }, /*#__PURE__*/React.createElement(_Divider, {\n        style: {\n          marginTop: -8,\n          marginBottom: 16\n        },\n        dashed: true\n      }))];\n    }\n\n    return colItem;\n  });\n  var hiddenNum = showHiddenNum && processedList.filter(function (item) {\n    return item.hidden;\n  }).length;\n  /** 是否需要展示 collapseRender */\n\n  var needCollapseRender = useMemo(function () {\n    if (totalSpan < 24 || totalSize < showLength) {\n      return false;\n    }\n\n    return true;\n  }, [totalSize, showLength, totalSpan]);\n  var offset = useMemo(function () {\n    var offsetSpan = currentSpan % 24 + spanSize.span;\n    return 24 - offsetSpan;\n  }, [currentSpan, spanSize.span]);\n  return /*#__PURE__*/React.createElement(_Row, {\n    gutter: searchGutter,\n    justify: \"start\",\n    key: \"resize-observer-row\"\n  }, doms, submitter && /*#__PURE__*/React.createElement(_Col, {\n    key: \"submitter\",\n    span: spanSize.span,\n    offset: offset,\n    style: {\n      textAlign: 'right'\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    label: \" \",\n    colon: false,\n    className: \"pro-form-query-filter-actions\"\n  }, /*#__PURE__*/React.createElement(Actions, {\n    hiddenNum: hiddenNum,\n    key: \"pro-form-query-filter-actions\",\n    collapsed: collapsed,\n    collapseRender: needCollapseRender ? collapseRender : false,\n    submitter: submitter,\n    setCollapsed: setCollapsed\n  }))));\n};\n\nvar defaultWidth = isBrowser() ? (_document = document) === null || _document === void 0 ? void 0 : (_document$body = _document.body) === null || _document$body === void 0 ? void 0 : _document$body.clientWidth : 1024;\n\nfunction QueryFilter(props) {\n  var controlCollapsed = props.collapsed,\n      layout = props.layout,\n      _props$defaultCollaps = props.defaultCollapsed,\n      defaultCollapsed = _props$defaultCollaps === void 0 ? true : _props$defaultCollaps,\n      defaultColsNumber = props.defaultColsNumber,\n      span = props.span,\n      _props$searchGutter = props.searchGutter,\n      searchGutter = _props$searchGutter === void 0 ? 24 : _props$searchGutter,\n      searchText = props.searchText,\n      resetText = props.resetText,\n      optionRender = props.optionRender,\n      collapseRender = props.collapseRender,\n      onReset = props.onReset,\n      onCollapse = props.onCollapse,\n      _props$labelWidth = props.labelWidth,\n      labelWidth = _props$labelWidth === void 0 ? '80' : _props$labelWidth,\n      style = props.style,\n      split = props.split,\n      _props$preserve = props.preserve,\n      preserve = _props$preserve === void 0 ? true : _props$preserve,\n      ignoreRules = props.ignoreRules,\n      _props$showHiddenNum = props.showHiddenNum,\n      showHiddenNum = _props$showHiddenNum === void 0 ? false : _props$showHiddenNum,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var context = useContext(_ConfigProvider.ConfigContext);\n  var baseClassName = context.getPrefixCls('pro-form-query-filter');\n\n  var _useMountMergeState = useMountMergeState(function () {\n    return typeof (style === null || style === void 0 ? void 0 : style.width) === 'number' ? style === null || style === void 0 ? void 0 : style.width : defaultWidth;\n  }),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      width = _useMountMergeState2[0],\n      setWidth = _useMountMergeState2[1];\n\n  var spanSize = useMemo(function () {\n    return getSpanConfig(layout, width + 16, span);\n  }, [layout, width, span]);\n  var showLength = useMemo(function () {\n    if (defaultColsNumber !== undefined) {\n      return defaultColsNumber;\n    }\n\n    return Math.max(1, 24 / spanSize.span);\n  }, [defaultColsNumber, spanSize.span]);\n  /** 计算最大宽度防止溢出换行 */\n\n  var formItemFixStyle = useMemo(function () {\n    if (labelWidth && spanSize.layout !== 'vertical' && labelWidth !== 'auto') {\n      return {\n        labelCol: {\n          flex: \"0 0 \".concat(labelWidth, \"px\")\n        },\n        wrapperCol: {\n          style: {\n            maxWidth: \"calc(100% - \".concat(labelWidth, \"px)\")\n          }\n        },\n        style: {\n          flexWrap: 'nowrap'\n        }\n      };\n    }\n\n    return undefined;\n  }, [spanSize.layout, labelWidth]);\n  return /*#__PURE__*/React.createElement(RcResizeObserver, {\n    key: \"resize-observer\",\n    onResize: function onResize(offset) {\n      if (width !== offset.width && offset.width > 17) {\n        setWidth(offset.width);\n      }\n    }\n  }, /*#__PURE__*/React.createElement(BaseForm, _extends({\n    isKeyPressSubmit: true,\n    preserve: preserve\n  }, rest, {\n    className: classNames(baseClassName, rest.className),\n    onReset: onReset,\n    style: style,\n    layout: spanSize.layout,\n    fieldProps: {\n      style: {\n        width: '100%'\n      }\n    },\n    formItemProps: formItemFixStyle,\n    groupProps: {\n      titleStyle: {\n        display: 'inline-block',\n        marginRight: 16\n      }\n    },\n    contentRender: function contentRender(items, renderSubmitter, form) {\n      return /*#__PURE__*/React.createElement(QueryFilterContent, {\n        spanSize: spanSize,\n        collapsed: controlCollapsed,\n        form: form,\n        collapseRender: collapseRender,\n        defaultCollapsed: defaultCollapsed,\n        onCollapse: onCollapse,\n        optionRender: optionRender,\n        submitter: renderSubmitter,\n        items: items,\n        split: split,\n        resetText: props.resetText,\n        searchText: props.searchText,\n        searchGutter: searchGutter,\n        preserve: preserve,\n        ignoreRules: ignoreRules,\n        showLength: showLength,\n        showHiddenNum: showHiddenNum\n      });\n    }\n  })));\n}\n\nexport { QueryFilter };","map":{"version":3,"sources":["/Users/jameszow/Documents/RustWorkSpace/covid-ipfs/covid-ipfs-client/node_modules/@ant-design/pro-form/es/layouts/QueryFilter/index.js"],"names":["_extends","_ConfigProvider","_objectWithoutProperties","_Row","_Form","_Divider","_Col","_slicedToArray","_objectSpread","_excluded","_document","_document$body","useIntl","isBrowser","useMountMergeState","classNames","RcResizeObserver","useMergedState","React","useContext","useMemo","BaseForm","Actions","CONFIG_SPAN_BREAKPOINTS","xs","sm","md","lg","xl","xxl","Infinity","BREAKPOINTS","vertical","default","getSpanConfig","layout","width","span","spanConfig","map","key","breakPoint","find","item","flatMapItems","items","ignoreRules","flatMap","_item$props","type","displayName","props","title","children","isValidElement","_item$props2","cloneElement","formItemProps","rules","QueryFilterContent","intl","resetText","getMessage","searchText","_useMergedState","defaultCollapsed","submitter","value","collapsed","onChange","onCollapse","_useMergedState2","setCollapsed","optionRender","collapseRender","split","spanSize","showLength","searchGutter","showHiddenNum","searchConfig","submitText","render","_","dom","totalSpan","itemLength","firstRowFull","totalSize","currentSpan","processedList","index","_item$props$colSize","_item$props3","_item$props5","_item$props6","colSize","colSpan","Math","min","_item$props4","hidden","itemKey","concat","name","preserve","itemDom","doms","itemProps","_itemDom$props","_itemDom$props2","colItem","createElement","style","marginTop","marginBottom","dashed","hiddenNum","filter","length","needCollapseRender","offset","offsetSpan","gutter","justify","textAlign","Item","label","colon","className","defaultWidth","document","body","clientWidth","QueryFilter","controlCollapsed","_props$defaultCollaps","defaultColsNumber","_props$searchGutter","onReset","_props$labelWidth","labelWidth","_props$preserve","_props$showHiddenNum","rest","context","ConfigContext","baseClassName","getPrefixCls","_useMountMergeState","_useMountMergeState2","setWidth","undefined","max","formItemFixStyle","labelCol","flex","wrapperCol","maxWidth","flexWrap","onResize","isKeyPressSubmit","fieldProps","groupProps","titleStyle","display","marginRight","contentRender","renderSubmitter","form"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/row/style\";\nimport _Row from \"antd/es/row\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/divider/style\";\nimport _Divider from \"antd/es/divider\";\nimport \"antd/es/col/style\";\nimport _Col from \"antd/es/col\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nvar _excluded = [\"collapsed\", \"layout\", \"defaultCollapsed\", \"defaultColsNumber\", \"span\", \"searchGutter\", \"searchText\", \"resetText\", \"optionRender\", \"collapseRender\", \"onReset\", \"onCollapse\", \"labelWidth\", \"style\", \"split\", \"preserve\", \"ignoreRules\", \"showHiddenNum\"];\n\nvar _document, _document$body;\n\n/* eslint-disable no-param-reassign */\nimport { useIntl } from '@ant-design/pro-provider';\nimport { isBrowser, useMountMergeState } from '@ant-design/pro-utils';\nimport classNames from 'classnames';\nimport RcResizeObserver from 'rc-resize-observer';\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport React, { useContext, useMemo } from 'react';\nimport { BaseForm } from '../../BaseForm';\nimport Actions from './Actions';\nvar CONFIG_SPAN_BREAKPOINTS = {\n  xs: 513,\n  sm: 513,\n  md: 785,\n  lg: 992,\n  xl: 1057,\n  xxl: Infinity\n};\n/** 配置表单列变化的容器宽度断点 */\n\nvar BREAKPOINTS = {\n  vertical: [// [breakpoint, cols, layout]\n  [513, 1, 'vertical'], [785, 2, 'vertical'], [1057, 3, 'vertical'], [Infinity, 4, 'vertical']],\n  default: [[513, 1, 'vertical'], [701, 2, 'vertical'], [1062, 3, 'horizontal'], [1352, 3, 'horizontal'], [Infinity, 4, 'horizontal']]\n};\n/**\n * 合并用户和默认的配置\n *\n * @param layout\n * @param width\n */\n\nvar getSpanConfig = function getSpanConfig(layout, width, span) {\n  if (span && typeof span === 'number') {\n    return {\n      span: span,\n      layout: layout\n    };\n  }\n\n  var spanConfig = span ? ['xs', 'sm', 'md', 'lg', 'xl', 'xxl'].map(function (key) {\n    return [CONFIG_SPAN_BREAKPOINTS[key], 24 / span[key], 'horizontal'];\n  }) : BREAKPOINTS[layout || 'default'];\n  var breakPoint = (spanConfig || BREAKPOINTS.default).find(function (item) {\n    return width < item[0] + 16;\n  });\n  return {\n    span: 24 / breakPoint[1],\n    layout: breakPoint[2]\n  };\n};\n\nvar flatMapItems = function flatMapItems(items, ignoreRules) {\n  return items.flatMap(function (item) {\n    var _item$props;\n\n    if ((item === null || item === void 0 ? void 0 : item.type.displayName) === 'ProForm-Group' && !((_item$props = item.props) === null || _item$props === void 0 ? void 0 : _item$props.title)) {\n      return item.props.children;\n    }\n\n    if (ignoreRules && /*#__PURE__*/React.isValidElement(item)) {\n      var _item$props2;\n\n      return /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread({}, item.props), {}, {\n        formItemProps: _objectSpread(_objectSpread({}, (_item$props2 = item.props) === null || _item$props2 === void 0 ? void 0 : _item$props2.formItemProps), {}, {\n          rules: []\n        })\n      }));\n    }\n\n    return item;\n  });\n};\n\nvar QueryFilterContent = function QueryFilterContent(props) {\n  var intl = useIntl();\n  var resetText = props.resetText || intl.getMessage('tableForm.reset', '重置');\n  var searchText = props.searchText || intl.getMessage('tableForm.search', '搜索');\n\n  var _useMergedState = useMergedState(function () {\n    return props.defaultCollapsed && !!props.submitter;\n  }, {\n    value: props.collapsed,\n    onChange: props.onCollapse\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      collapsed = _useMergedState2[0],\n      setCollapsed = _useMergedState2[1];\n\n  var optionRender = props.optionRender,\n      collapseRender = props.collapseRender,\n      split = props.split,\n      items = props.items,\n      spanSize = props.spanSize,\n      showLength = props.showLength,\n      searchGutter = props.searchGutter,\n      showHiddenNum = props.showHiddenNum;\n  var submitter = useMemo(function () {\n    if (!props.submitter || optionRender === false) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.cloneElement(props.submitter, _objectSpread({\n      searchConfig: {\n        resetText: resetText,\n        submitText: searchText\n      },\n      render: optionRender ? function (_, dom) {\n        return optionRender(_objectSpread(_objectSpread({}, props), {}, {\n          resetText: resetText,\n          searchText: searchText\n        }), props, dom);\n      } : optionRender\n    }, props.submitter.props));\n  }, [props, resetText, searchText, optionRender]); // totalSpan 统计控件占的位置，计算 offset 保证查询按钮在最后一列\n\n  var totalSpan = 0;\n  var itemLength = 0; //首个表单项是否占满第一行\n\n  var firstRowFull = false; // totalSize 统计控件占的份数\n\n  var totalSize = 0; // for split compute\n\n  var currentSpan = 0; // 处理过，包含是否需要隐藏的 数组\n\n  var processedList = flatMapItems(items, props.ignoreRules).map(function (item, index) {\n    var _item$props$colSize, _item$props3, _item$props5, _item$props6;\n\n    // 如果 formItem 自己配置了 hidden，默认使用它自己的\n    var colSize = /*#__PURE__*/React.isValidElement(item) ? (_item$props$colSize = item === null || item === void 0 ? void 0 : (_item$props3 = item.props) === null || _item$props3 === void 0 ? void 0 : _item$props3.colSize) !== null && _item$props$colSize !== void 0 ? _item$props$colSize : 1 : 1;\n    var colSpan = Math.min(spanSize.span * (colSize || 1), 24); // 计算总的 totalSpan 长度\n\n    totalSpan += colSpan; // 计算总的 colSize 长度\n\n    totalSize += colSize;\n\n    if (index === 0) {\n      var _item$props4;\n\n      firstRowFull = colSpan === 24 && !(item === null || item === void 0 ? void 0 : (_item$props4 = item.props) === null || _item$props4 === void 0 ? void 0 : _item$props4.hidden);\n    }\n\n    var hidden = (item === null || item === void 0 ? void 0 : (_item$props5 = item.props) === null || _item$props5 === void 0 ? void 0 : _item$props5.hidden) || // 如果收起了\n    collapsed && (firstRowFull || // 如果 超过显示长度 且 总长度超过了 24\n    totalSize > showLength - 1) && !!index && totalSpan >= 24;\n    itemLength += 1;\n    var itemKey = /*#__PURE__*/React.isValidElement(item) && (item.key || \"\".concat((_item$props6 = item.props) === null || _item$props6 === void 0 ? void 0 : _item$props6.name)) || index;\n\n    if ( /*#__PURE__*/React.isValidElement(item) && hidden) {\n      if (!props.preserve) {\n        return {\n          itemDom: null,\n          colSpan: colSpan,\n          hidden: true\n        };\n      }\n\n      return {\n        itemDom: /*#__PURE__*/React.cloneElement(item, {\n          hidden: true,\n          key: itemKey || index\n        }),\n        hidden: true,\n        colSpan: colSpan\n      };\n    }\n\n    return {\n      itemDom: item,\n      colSpan: colSpan,\n      hidden: false\n    };\n  });\n  var doms = processedList.map(function (itemProps, index) {\n    var _itemDom$props, _itemDom$props2;\n\n    var itemDom = itemProps.itemDom,\n        colSpan = itemProps.colSpan;\n    var hidden = itemDom === null || itemDom === void 0 ? void 0 : (_itemDom$props = itemDom.props) === null || _itemDom$props === void 0 ? void 0 : _itemDom$props.hidden;\n    if (hidden) return itemDom; // 每一列的key, 一般是存在的\n\n    var itemKey = /*#__PURE__*/React.isValidElement(itemDom) && (itemDom.key || \"\".concat((_itemDom$props2 = itemDom.props) === null || _itemDom$props2 === void 0 ? void 0 : _itemDom$props2.name)) || index;\n\n    if (24 - currentSpan % 24 < colSpan) {\n      // 如果当前行空余位置放不下，那么折行\n      totalSpan += 24 - currentSpan % 24;\n      currentSpan += 24 - currentSpan % 24;\n    }\n\n    currentSpan += colSpan;\n    var colItem = /*#__PURE__*/React.createElement(_Col, {\n      key: itemKey,\n      span: colSpan\n    }, itemDom);\n\n    if (split && currentSpan % 24 === 0 && index < itemLength - 1) {\n      return [colItem, /*#__PURE__*/React.createElement(_Col, {\n        span: \"24\",\n        key: \"line\"\n      }, /*#__PURE__*/React.createElement(_Divider, {\n        style: {\n          marginTop: -8,\n          marginBottom: 16\n        },\n        dashed: true\n      }))];\n    }\n\n    return colItem;\n  });\n  var hiddenNum = showHiddenNum && processedList.filter(function (item) {\n    return item.hidden;\n  }).length;\n  /** 是否需要展示 collapseRender */\n\n  var needCollapseRender = useMemo(function () {\n    if (totalSpan < 24 || totalSize < showLength) {\n      return false;\n    }\n\n    return true;\n  }, [totalSize, showLength, totalSpan]);\n  var offset = useMemo(function () {\n    var offsetSpan = currentSpan % 24 + spanSize.span;\n    return 24 - offsetSpan;\n  }, [currentSpan, spanSize.span]);\n  return /*#__PURE__*/React.createElement(_Row, {\n    gutter: searchGutter,\n    justify: \"start\",\n    key: \"resize-observer-row\"\n  }, doms, submitter && /*#__PURE__*/React.createElement(_Col, {\n    key: \"submitter\",\n    span: spanSize.span,\n    offset: offset,\n    style: {\n      textAlign: 'right'\n    }\n  }, /*#__PURE__*/React.createElement(_Form.Item, {\n    label: \" \",\n    colon: false,\n    className: \"pro-form-query-filter-actions\"\n  }, /*#__PURE__*/React.createElement(Actions, {\n    hiddenNum: hiddenNum,\n    key: \"pro-form-query-filter-actions\",\n    collapsed: collapsed,\n    collapseRender: needCollapseRender ? collapseRender : false,\n    submitter: submitter,\n    setCollapsed: setCollapsed\n  }))));\n};\n\nvar defaultWidth = isBrowser() ? (_document = document) === null || _document === void 0 ? void 0 : (_document$body = _document.body) === null || _document$body === void 0 ? void 0 : _document$body.clientWidth : 1024;\n\nfunction QueryFilter(props) {\n  var controlCollapsed = props.collapsed,\n      layout = props.layout,\n      _props$defaultCollaps = props.defaultCollapsed,\n      defaultCollapsed = _props$defaultCollaps === void 0 ? true : _props$defaultCollaps,\n      defaultColsNumber = props.defaultColsNumber,\n      span = props.span,\n      _props$searchGutter = props.searchGutter,\n      searchGutter = _props$searchGutter === void 0 ? 24 : _props$searchGutter,\n      searchText = props.searchText,\n      resetText = props.resetText,\n      optionRender = props.optionRender,\n      collapseRender = props.collapseRender,\n      onReset = props.onReset,\n      onCollapse = props.onCollapse,\n      _props$labelWidth = props.labelWidth,\n      labelWidth = _props$labelWidth === void 0 ? '80' : _props$labelWidth,\n      style = props.style,\n      split = props.split,\n      _props$preserve = props.preserve,\n      preserve = _props$preserve === void 0 ? true : _props$preserve,\n      ignoreRules = props.ignoreRules,\n      _props$showHiddenNum = props.showHiddenNum,\n      showHiddenNum = _props$showHiddenNum === void 0 ? false : _props$showHiddenNum,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var context = useContext(_ConfigProvider.ConfigContext);\n  var baseClassName = context.getPrefixCls('pro-form-query-filter');\n\n  var _useMountMergeState = useMountMergeState(function () {\n    return typeof (style === null || style === void 0 ? void 0 : style.width) === 'number' ? style === null || style === void 0 ? void 0 : style.width : defaultWidth;\n  }),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      width = _useMountMergeState2[0],\n      setWidth = _useMountMergeState2[1];\n\n  var spanSize = useMemo(function () {\n    return getSpanConfig(layout, width + 16, span);\n  }, [layout, width, span]);\n  var showLength = useMemo(function () {\n    if (defaultColsNumber !== undefined) {\n      return defaultColsNumber;\n    }\n\n    return Math.max(1, 24 / spanSize.span);\n  }, [defaultColsNumber, spanSize.span]);\n  /** 计算最大宽度防止溢出换行 */\n\n  var formItemFixStyle = useMemo(function () {\n    if (labelWidth && spanSize.layout !== 'vertical' && labelWidth !== 'auto') {\n      return {\n        labelCol: {\n          flex: \"0 0 \".concat(labelWidth, \"px\")\n        },\n        wrapperCol: {\n          style: {\n            maxWidth: \"calc(100% - \".concat(labelWidth, \"px)\")\n          }\n        },\n        style: {\n          flexWrap: 'nowrap'\n        }\n      };\n    }\n\n    return undefined;\n  }, [spanSize.layout, labelWidth]);\n  return /*#__PURE__*/React.createElement(RcResizeObserver, {\n    key: \"resize-observer\",\n    onResize: function onResize(offset) {\n      if (width !== offset.width && offset.width > 17) {\n        setWidth(offset.width);\n      }\n    }\n  }, /*#__PURE__*/React.createElement(BaseForm, _extends({\n    isKeyPressSubmit: true,\n    preserve: preserve\n  }, rest, {\n    className: classNames(baseClassName, rest.className),\n    onReset: onReset,\n    style: style,\n    layout: spanSize.layout,\n    fieldProps: {\n      style: {\n        width: '100%'\n      }\n    },\n    formItemProps: formItemFixStyle,\n    groupProps: {\n      titleStyle: {\n        display: 'inline-block',\n        marginRight: 16\n      }\n    },\n    contentRender: function contentRender(items, renderSubmitter, form) {\n      return /*#__PURE__*/React.createElement(QueryFilterContent, {\n        spanSize: spanSize,\n        collapsed: controlCollapsed,\n        form: form,\n        collapseRender: collapseRender,\n        defaultCollapsed: defaultCollapsed,\n        onCollapse: onCollapse,\n        optionRender: optionRender,\n        submitter: renderSubmitter,\n        items: items,\n        split: split,\n        resetText: props.resetText,\n        searchText: props.searchText,\n        searchGutter: searchGutter,\n        preserve: preserve,\n        ignoreRules: ignoreRules,\n        showLength: showLength,\n        showHiddenNum: showHiddenNum\n      });\n    }\n  })));\n}\n\nexport { QueryFilter };"]},"metadata":{},"sourceType":"module"}