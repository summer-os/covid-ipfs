{"ast":null,"code":"/**\n * Dark Reader v4.9.45\n * https://darkreader.org/\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.DarkReader = {}));\n})(this, function (exports) {\n  'use strict';\n  /*! *****************************************************************************\r\n  Copyright (c) Microsoft Corporation.\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n  purpose with or without fee is hereby granted.\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n  PERFORMANCE OF THIS SOFTWARE.\r\n  ***************************************************************************** */\n\n  var _assign = function __assign() {\n    _assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) {\n          if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n      }\n\n      return t;\n    };\n\n    return _assign.apply(this, arguments);\n  };\n\n  function __awaiter(thisArg, _arguments, P, generator) {\n    function adopt(value) {\n      return value instanceof P ? value : new P(function (resolve) {\n        resolve(value);\n      });\n    }\n\n    return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) {\n        try {\n          step(generator.next(value));\n        } catch (e) {\n          reject(e);\n        }\n      }\n\n      function rejected(value) {\n        try {\n          step(generator[\"throw\"](value));\n        } catch (e) {\n          reject(e);\n        }\n      }\n\n      function step(result) {\n        result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n      }\n\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n  }\n\n  function __generator(thisArg, body) {\n    var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n        f,\n        y,\n        t,\n        g;\n    return g = {\n      next: verb(0),\n      \"throw\": verb(1),\n      \"return\": verb(2)\n    }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n      return this;\n    }), g;\n\n    function verb(n) {\n      return function (v) {\n        return step([n, v]);\n      };\n    }\n\n    function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n\n      while (_) {\n        try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n      }\n\n      if (op[0] & 5) throw op[1];\n      return {\n        value: op[0] ? op[1] : void 0,\n        done: true\n      };\n    }\n  }\n\n  function __values(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator,\n        m = s && o[s],\n        i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n      next: function next() {\n        if (o && i >= o.length) o = void 0;\n        return {\n          value: o && o[i++],\n          done: !o\n        };\n      }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n  }\n\n  function __read(o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o),\n        r,\n        ar = [],\n        e;\n\n    try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n        ar.push(r.value);\n      }\n    } catch (error) {\n      e = {\n        error: error\n      };\n    } finally {\n      try {\n        if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      } finally {\n        if (e) throw e.error;\n      }\n    }\n\n    return ar;\n  }\n\n  function __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n        if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n        ar[i] = from[i];\n      }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n  }\n\n  var MessageType = {\n    UI_GET_DATA: 'ui-get-data',\n    UI_GET_ACTIVE_TAB_INFO: 'ui-get-active-tab-info',\n    UI_SUBSCRIBE_TO_CHANGES: 'ui-subscribe-to-changes',\n    UI_UNSUBSCRIBE_FROM_CHANGES: 'ui-unsubscribe-from-changes',\n    UI_CHANGE_SETTINGS: 'ui-change-settings',\n    UI_SET_THEME: 'ui-set-theme',\n    UI_SET_SHORTCUT: 'ui-set-shortcut',\n    UI_TOGGLE_URL: 'ui-toggle-url',\n    UI_MARK_NEWS_AS_READ: 'ui-mark-news-as-read',\n    UI_LOAD_CONFIG: 'ui-load-config',\n    UI_APPLY_DEV_DYNAMIC_THEME_FIXES: 'ui-apply-dev-dynamic-theme-fixes',\n    UI_RESET_DEV_DYNAMIC_THEME_FIXES: 'ui-reset-dev-dynamic-theme-fixes',\n    UI_APPLY_DEV_INVERSION_FIXES: 'ui-apply-dev-inversion-fixes',\n    UI_RESET_DEV_INVERSION_FIXES: 'ui-reset-dev-inversion-fixes',\n    UI_APPLY_DEV_STATIC_THEMES: 'ui-apply-dev-static-themes',\n    UI_RESET_DEV_STATIC_THEMES: 'ui-reset-dev-static-themes',\n    UI_SAVE_FILE: 'ui-save-file',\n    UI_REQUEST_EXPORT_CSS: 'ui-request-export-css',\n    BG_CHANGES: 'bg-changes',\n    BG_ADD_CSS_FILTER: 'bg-add-css-filter',\n    BG_ADD_STATIC_THEME: 'bg-add-static-theme',\n    BG_ADD_SVG_FILTER: 'bg-add-svg-filter',\n    BG_ADD_DYNAMIC_THEME: 'bg-add-dynamic-theme',\n    BG_EXPORT_CSS: 'bg-export-css',\n    BG_UNSUPPORTED_SENDER: 'bg-unsupported-sender',\n    BG_CLEAN_UP: 'bg-clean-up',\n    BG_RELOAD: 'bg-reload',\n    BG_FETCH_RESPONSE: 'bg-fetch-response',\n    BG_UI_UPDATE: 'bg-ui-update',\n    BG_CSS_UPDATE: 'bg-css-update',\n    CS_COLOR_SCHEME_CHANGE: 'cs-color-scheme-change',\n    CS_FRAME_CONNECT: 'cs-frame-connect',\n    CS_FRAME_FORGET: 'cs-frame-forget',\n    CS_FRAME_FREEZE: 'cs-frame-freeze',\n    CS_FRAME_RESUME: 'cs-frame-resume',\n    CS_EXPORT_CSS_RESPONSE: 'cs-export-css-response',\n    CS_FETCH: 'cs-fetch'\n  };\n  var userAgent = typeof navigator === 'undefined' ? 'some useragent' : navigator.userAgent.toLowerCase();\n  var platform = typeof navigator === 'undefined' ? 'some platform' : navigator.platform.toLowerCase();\n  var isChromium = userAgent.includes('chrome') || userAgent.includes('chromium');\n  var isThunderbird = userAgent.includes('thunderbird');\n  var isFirefox = userAgent.includes('firefox') || userAgent.includes('librewolf') || isThunderbird;\n  userAgent.includes('vivaldi');\n  userAgent.includes('yabrowser');\n  userAgent.includes('opr') || userAgent.includes('opera');\n  userAgent.includes('edg');\n  var isSafari = userAgent.includes('safari') && !isChromium;\n  var isWindows = platform.startsWith('win');\n  var isMacOS = platform.startsWith('mac');\n  userAgent.includes('mobile');\n  var isShadowDomSupported = typeof ShadowRoot === 'function';\n  var isMatchMediaChangeEventListenerSupported = typeof MediaQueryList === 'function' && typeof MediaQueryList.prototype.addEventListener === 'function';\n\n  (function () {\n    var m = userAgent.match(/chrom[e|ium]\\/([^ ]+)/);\n\n    if (m && m[1]) {\n      return m[1];\n    }\n\n    return '';\n  })();\n\n  var isDefinedSelectorSupported = function () {\n    try {\n      document.querySelector(':defined');\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }();\n\n  typeof globalThis !== 'undefined' && globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.getManifest && globalThis.chrome.runtime.getManifest().manifest_version === 3;\n\n  function getOKResponse(url, mimeType, origin) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, fetch(url, {\n              cache: 'force-cache',\n              credentials: 'omit',\n              referrer: origin\n            })];\n\n          case 1:\n            response = _a.sent();\n\n            if (isFirefox && mimeType === 'text/css' && url.startsWith('moz-extension://') && url.endsWith('.css')) {\n              return [2, response];\n            }\n\n            if (mimeType && !response.headers.get('Content-Type').startsWith(mimeType)) {\n              throw new Error(\"Mime type mismatch when loading \" + url);\n            }\n\n            if (!response.ok) {\n              throw new Error(\"Unable to load \" + url + \" \" + response.status + \" \" + response.statusText);\n            }\n\n            return [2, response];\n        }\n      });\n    });\n  }\n\n  function loadAsDataURL(url, mimeType) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, getOKResponse(url, mimeType)];\n\n          case 1:\n            response = _a.sent();\n            return [4, readResponseAsDataURL(response)];\n\n          case 2:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function readResponseAsDataURL(response) {\n    return __awaiter(this, void 0, void 0, function () {\n      var blob, dataURL;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, response.blob()];\n\n          case 1:\n            blob = _a.sent();\n            return [4, new Promise(function (resolve) {\n              var reader = new FileReader();\n\n              reader.onloadend = function () {\n                return resolve(reader.result);\n              };\n\n              reader.readAsDataURL(blob);\n            })];\n\n          case 2:\n            dataURL = _a.sent();\n            return [2, dataURL];\n        }\n      });\n    });\n  }\n\n  var throwCORSError = function throwCORSError(url) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, Promise.reject(new Error(['Embedded Dark Reader cannot access a cross-origin resource', url, 'Overview your URLs and CORS policies or use', '`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.', 'See if using `DarkReader.setFetchMethod(window.fetch)`', 'before `DarkReader.enable()` works.'].join(' ')))];\n      });\n    });\n  };\n\n  var fetcher = throwCORSError;\n\n  function setFetchMethod$1(fetch) {\n    if (fetch) {\n      fetcher = fetch;\n    } else {\n      fetcher = throwCORSError;\n    }\n  }\n\n  function callFetchMethod(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, fetcher(url)];\n\n          case 1:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function initChrome() {\n    if (typeof chrome === 'undefined') return;\n\n    if (typeof window !== 'undefined' && !window.chrome) {\n      window.chrome = {};\n    }\n\n    if (typeof chrome !== 'undefined' && !chrome.runtime) {\n      chrome.runtime = {};\n    }\n\n    var messageListeners = new Set();\n\n    function sendMessage() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return __awaiter(this, void 0, void 0, function () {\n        var id_1, _a, url, responseType, response, text_1, error_1;\n\n        return __generator(this, function (_b) {\n          switch (_b.label) {\n            case 0:\n              if (!(args[0] && args[0].type === MessageType.CS_FETCH)) return [3, 8];\n              id_1 = args[0].id;\n              _b.label = 1;\n\n            case 1:\n              _b.trys.push([1, 7,, 8]);\n\n              _a = args[0].data, url = _a.url, responseType = _a.responseType;\n              return [4, callFetchMethod(url)];\n\n            case 2:\n              response = _b.sent();\n              if (!(responseType === 'data-url')) return [3, 4];\n              return [4, readResponseAsDataURL(response)];\n\n            case 3:\n              text_1 = _b.sent();\n              return [3, 6];\n\n            case 4:\n              return [4, response.text()];\n\n            case 5:\n              text_1 = _b.sent();\n              _b.label = 6;\n\n            case 6:\n              messageListeners.forEach(function (cb) {\n                return cb({\n                  type: MessageType.BG_FETCH_RESPONSE,\n                  data: text_1,\n                  error: null,\n                  id: id_1\n                });\n              });\n              return [3, 8];\n\n            case 7:\n              error_1 = _b.sent();\n              console.error(error_1);\n              messageListeners.forEach(function (cb) {\n                return cb({\n                  type: MessageType.BG_FETCH_RESPONSE,\n                  data: null,\n                  error: error_1,\n                  id: id_1\n                });\n              });\n              return [3, 8];\n\n            case 8:\n              return [2];\n          }\n        });\n      });\n    }\n\n    function addMessageListener(callback) {\n      messageListeners.add(callback);\n    }\n\n    if (typeof chrome.runtime.sendMessage === 'function') {\n      var nativeSendMessage_1 = chrome.runtime.sendMessage;\n\n      chrome.runtime.sendMessage = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        sendMessage.apply(void 0, __spreadArray([], __read(args), false));\n        nativeSendMessage_1.apply(chrome.runtime, args);\n      };\n    } else {\n      chrome.runtime.sendMessage = sendMessage;\n    }\n\n    if (!chrome.runtime.onMessage) {\n      chrome.runtime.onMessage = {};\n    }\n\n    if (typeof chrome.runtime.onMessage.addListener === 'function') {\n      var nativeAddListener_1 = chrome.runtime.onMessage.addListener;\n\n      chrome.runtime.onMessage.addListener = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        addMessageListener(args[0]);\n        nativeAddListener_1.apply(chrome.runtime.onMessage, args);\n      };\n    } else {\n      chrome.runtime.onMessage.addListener = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return addMessageListener(args[0]);\n      };\n    }\n  }\n\n  initChrome();\n  var ThemeEngines = {\n    cssFilter: 'cssFilter',\n    svgFilter: 'svgFilter',\n    staticTheme: 'staticTheme',\n    dynamicTheme: 'dynamicTheme'\n  };\n  var DEFAULT_COLORS = {\n    darkScheme: {\n      background: '#181a1b',\n      text: '#e8e6e3'\n    },\n    lightScheme: {\n      background: '#dcdad7',\n      text: '#181a1b'\n    }\n  };\n  var DEFAULT_THEME = {\n    mode: 1,\n    brightness: 100,\n    contrast: 100,\n    grayscale: 0,\n    sepia: 0,\n    useFont: false,\n    fontFamily: isMacOS ? 'Helvetica Neue' : isWindows ? 'Segoe UI' : 'Open Sans',\n    textStroke: 0,\n    engine: ThemeEngines.dynamicTheme,\n    stylesheet: '',\n    darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\n    darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\n    lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\n    lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\n    scrollbarColor: isMacOS ? '' : 'auto',\n    selectionColor: 'auto',\n    styleSystemControls: true,\n    lightColorScheme: 'Default',\n    darkColorScheme: 'Default'\n  };\n\n  function isArrayLike(items) {\n    return items.length != null;\n  }\n\n  function forEach(items, iterator) {\n    var e_1, _a;\n\n    if (isArrayLike(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        iterator(items[i]);\n      }\n    } else {\n      try {\n        for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n          var item = items_1_1.value;\n          iterator(item);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n  }\n\n  function push(array, addition) {\n    forEach(addition, function (a) {\n      return array.push(a);\n    });\n  }\n\n  function toArray(items) {\n    var results = [];\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      results.push(items[i]);\n    }\n\n    return results;\n  }\n\n  function logInfo() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n  }\n\n  function logWarn() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n  }\n\n  function throttle(callback) {\n    var pending = false;\n    var frameId = null;\n    var lastArgs;\n\n    var throttled = function throttled() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      lastArgs = args;\n\n      if (frameId) {\n        pending = true;\n      } else {\n        callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\n        frameId = requestAnimationFrame(function () {\n          frameId = null;\n\n          if (pending) {\n            callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\n            pending = false;\n          }\n        });\n      }\n    };\n\n    var cancel = function cancel() {\n      cancelAnimationFrame(frameId);\n      pending = false;\n      frameId = null;\n    };\n\n    return Object.assign(throttled, {\n      cancel: cancel\n    });\n  }\n\n  function createAsyncTasksQueue() {\n    var tasks = [];\n    var frameId = null;\n\n    function runTasks() {\n      var task;\n\n      while (task = tasks.shift()) {\n        task();\n      }\n\n      frameId = null;\n    }\n\n    function add(task) {\n      tasks.push(task);\n\n      if (!frameId) {\n        frameId = requestAnimationFrame(runTasks);\n      }\n    }\n\n    function cancel() {\n      tasks.splice(0);\n      cancelAnimationFrame(frameId);\n      frameId = null;\n    }\n\n    return {\n      add: add,\n      cancel: cancel\n    };\n  }\n\n  function getDuration(time) {\n    var duration = 0;\n\n    if (time.seconds) {\n      duration += time.seconds * 1000;\n    }\n\n    if (time.minutes) {\n      duration += time.minutes * 60 * 1000;\n    }\n\n    if (time.hours) {\n      duration += time.hours * 60 * 60 * 1000;\n    }\n\n    if (time.days) {\n      duration += time.days * 24 * 60 * 60 * 1000;\n    }\n\n    return duration;\n  }\n\n  function removeNode(node) {\n    node && node.parentNode && node.parentNode.removeChild(node);\n  }\n\n  function watchForNodePosition(node, mode, onRestore) {\n    if (onRestore === void 0) {\n      onRestore = Function.prototype;\n    }\n\n    var MAX_ATTEMPTS_COUNT = 10;\n    var RETRY_TIMEOUT = getDuration({\n      seconds: 2\n    });\n    var ATTEMPTS_INTERVAL = getDuration({\n      seconds: 10\n    });\n    var prevSibling = node.previousSibling;\n    var parent = node.parentNode;\n\n    if (!parent) {\n      throw new Error('Unable to watch for node position: parent element not found');\n    }\n\n    if (mode === 'prev-sibling' && !prevSibling) {\n      throw new Error('Unable to watch for node position: there is no previous sibling');\n    }\n\n    var attempts = 0;\n    var start = null;\n    var timeoutId = null;\n    var restore = throttle(function () {\n      if (timeoutId) {\n        return;\n      }\n\n      attempts++;\n      var now = Date.now();\n\n      if (start == null) {\n        start = now;\n      } else if (attempts >= MAX_ATTEMPTS_COUNT) {\n        if (now - start < ATTEMPTS_INTERVAL) {\n          logWarn(\"Node position watcher paused: retry in \" + RETRY_TIMEOUT + \"ms\", node, prevSibling);\n          timeoutId = setTimeout(function () {\n            start = null;\n            attempts = 0;\n            timeoutId = null;\n            restore();\n          }, RETRY_TIMEOUT);\n          return;\n        }\n\n        start = now;\n        attempts = 1;\n      }\n\n      if (mode === 'parent') {\n        if (prevSibling && prevSibling.parentNode !== parent) {\n          logWarn('Unable to restore node position: sibling parent changed', node, prevSibling, parent);\n          stop();\n          return;\n        }\n      }\n\n      if (mode === 'prev-sibling') {\n        if (prevSibling.parentNode == null) {\n          logWarn('Unable to restore node position: sibling was removed', node, prevSibling, parent);\n          stop();\n          return;\n        }\n\n        if (prevSibling.parentNode !== parent) {\n          logWarn('Style was moved to another parent', node, prevSibling, parent);\n          updateParent(prevSibling.parentNode);\n        }\n      }\n\n      logWarn('Restoring node position', node, prevSibling, parent);\n      parent.insertBefore(node, prevSibling ? prevSibling.nextSibling : parent.firstChild);\n      observer.takeRecords();\n      onRestore && onRestore();\n    });\n    var observer = new MutationObserver(function () {\n      if (mode === 'parent' && node.parentNode !== parent || mode === 'prev-sibling' && node.previousSibling !== prevSibling) {\n        restore();\n      }\n    });\n\n    var run = function run() {\n      observer.observe(parent, {\n        childList: true\n      });\n    };\n\n    var stop = function stop() {\n      clearTimeout(timeoutId);\n      observer.disconnect();\n      restore.cancel();\n    };\n\n    var skip = function skip() {\n      observer.takeRecords();\n    };\n\n    var updateParent = function updateParent(parentNode) {\n      parent = parentNode;\n      stop();\n      run();\n    };\n\n    run();\n    return {\n      run: run,\n      stop: stop,\n      skip: skip\n    };\n  }\n\n  function iterateShadowHosts(root, iterator) {\n    if (root == null) {\n      return;\n    }\n\n    var walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {\n      acceptNode: function acceptNode(node) {\n        return node.shadowRoot == null ? NodeFilter.FILTER_SKIP : NodeFilter.FILTER_ACCEPT;\n      }\n    });\n\n    for (var node = root.shadowRoot ? walker.currentNode : walker.nextNode(); node != null; node = walker.nextNode()) {\n      iterator(node);\n      iterateShadowHosts(node.shadowRoot, iterator);\n    }\n  }\n\n  function isDOMReady() {\n    if (typeof document === 'undefined') return false;\n    return document.readyState === 'complete' || document.readyState === 'interactive';\n  }\n\n  var readyStateListeners = new Set();\n\n  function addDOMReadyListener(listener) {\n    readyStateListeners.add(listener);\n  }\n\n  function removeDOMReadyListener(listener) {\n    readyStateListeners.delete(listener);\n  }\n\n  function isReadyStateComplete() {\n    return document.readyState === 'complete';\n  }\n\n  var readyStateCompleteListeners = new Set();\n\n  function addReadyStateCompleteListener(listener) {\n    readyStateCompleteListeners.add(listener);\n  }\n\n  function cleanReadyStateCompleteListeners() {\n    readyStateCompleteListeners.clear();\n  }\n\n  if (!isDOMReady()) {\n    var onReadyStateChange_1 = function onReadyStateChange_1() {\n      if (isDOMReady()) {\n        readyStateListeners.forEach(function (listener) {\n          return listener();\n        });\n        readyStateListeners.clear();\n\n        if (isReadyStateComplete()) {\n          document.removeEventListener('readystatechange', onReadyStateChange_1);\n          readyStateCompleteListeners.forEach(function (listener) {\n            return listener();\n          });\n          readyStateCompleteListeners.clear();\n        }\n      }\n    };\n\n    if (typeof document !== 'undefined') {\n      document.addEventListener('readystatechange', onReadyStateChange_1);\n    }\n  }\n\n  var HUGE_MUTATIONS_COUNT = 1000;\n\n  function isHugeMutation(mutations) {\n    if (mutations.length > HUGE_MUTATIONS_COUNT) {\n      return true;\n    }\n\n    var addedNodesCount = 0;\n\n    for (var i = 0; i < mutations.length; i++) {\n      addedNodesCount += mutations[i].addedNodes.length;\n\n      if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function getElementsTreeOperations(mutations) {\n    var additions = new Set();\n    var deletions = new Set();\n    var moves = new Set();\n    mutations.forEach(function (m) {\n      forEach(m.addedNodes, function (n) {\n        if (n instanceof Element && n.isConnected) {\n          additions.add(n);\n        }\n      });\n      forEach(m.removedNodes, function (n) {\n        if (n instanceof Element) {\n          if (n.isConnected) {\n            moves.add(n);\n            additions.delete(n);\n          } else {\n            deletions.add(n);\n          }\n        }\n      });\n    });\n    var duplicateAdditions = [];\n    var duplicateDeletions = [];\n    additions.forEach(function (node) {\n      if (additions.has(node.parentElement)) {\n        duplicateAdditions.push(node);\n      }\n    });\n    deletions.forEach(function (node) {\n      if (deletions.has(node.parentElement)) {\n        duplicateDeletions.push(node);\n      }\n    });\n    duplicateAdditions.forEach(function (node) {\n      return additions.delete(node);\n    });\n    duplicateDeletions.forEach(function (node) {\n      return deletions.delete(node);\n    });\n    return {\n      additions: additions,\n      moves: moves,\n      deletions: deletions\n    };\n  }\n\n  var optimizedTreeObservers = new Map();\n  var optimizedTreeCallbacks = new WeakMap();\n\n  function createOptimizedTreeObserver(root, callbacks) {\n    var observer;\n    var observerCallbacks;\n    var domReadyListener;\n\n    if (optimizedTreeObservers.has(root)) {\n      observer = optimizedTreeObservers.get(root);\n      observerCallbacks = optimizedTreeCallbacks.get(observer);\n    } else {\n      var hadHugeMutationsBefore_1 = false;\n      var subscribedForReadyState_1 = false;\n      observer = new MutationObserver(function (mutations) {\n        if (isHugeMutation(mutations)) {\n          if (!hadHugeMutationsBefore_1 || isDOMReady()) {\n            observerCallbacks.forEach(function (_a) {\n              var onHugeMutations = _a.onHugeMutations;\n              return onHugeMutations(root);\n            });\n          } else if (!subscribedForReadyState_1) {\n            domReadyListener = function domReadyListener() {\n              return observerCallbacks.forEach(function (_a) {\n                var onHugeMutations = _a.onHugeMutations;\n                return onHugeMutations(root);\n              });\n            };\n\n            addDOMReadyListener(domReadyListener);\n            subscribedForReadyState_1 = true;\n          }\n\n          hadHugeMutationsBefore_1 = true;\n        } else {\n          var elementsOperations_1 = getElementsTreeOperations(mutations);\n          observerCallbacks.forEach(function (_a) {\n            var onMinorMutations = _a.onMinorMutations;\n            return onMinorMutations(elementsOperations_1);\n          });\n        }\n      });\n      observer.observe(root, {\n        childList: true,\n        subtree: true\n      });\n      optimizedTreeObservers.set(root, observer);\n      observerCallbacks = new Set();\n      optimizedTreeCallbacks.set(observer, observerCallbacks);\n    }\n\n    observerCallbacks.add(callbacks);\n    return {\n      disconnect: function disconnect() {\n        observerCallbacks.delete(callbacks);\n\n        if (domReadyListener) {\n          removeDOMReadyListener(domReadyListener);\n        }\n\n        if (observerCallbacks.size === 0) {\n          observer.disconnect();\n          optimizedTreeCallbacks.delete(observer);\n          optimizedTreeObservers.delete(root);\n        }\n      }\n    };\n  }\n\n  var anchor;\n  var parsedURLCache = new Map();\n\n  function fixBaseURL($url) {\n    if (!anchor) {\n      anchor = document.createElement('a');\n    }\n\n    anchor.href = $url;\n    return anchor.href;\n  }\n\n  function parseURL($url, $base) {\n    if ($base === void 0) {\n      $base = null;\n    }\n\n    var key = \"\" + $url + ($base ? \";\" + $base : '');\n\n    if (parsedURLCache.has(key)) {\n      return parsedURLCache.get(key);\n    }\n\n    if ($base) {\n      var parsedURL_1 = new URL($url, fixBaseURL($base));\n      parsedURLCache.set(key, parsedURL_1);\n      return parsedURL_1;\n    }\n\n    var parsedURL = new URL(fixBaseURL($url));\n    parsedURLCache.set($url, parsedURL);\n    return parsedURL;\n  }\n\n  function getAbsoluteURL($base, $relative) {\n    if ($relative.match(/^data\\\\?\\:/)) {\n      return $relative;\n    }\n\n    if (/^\\/\\//.test($relative)) {\n      return \"\" + location.protocol + $relative;\n    }\n\n    var b = parseURL($base);\n    var a = parseURL($relative, b.href);\n    return a.href;\n  }\n\n  function isRelativeHrefOnAbsolutePath(href) {\n    if (href.startsWith('data:')) {\n      return true;\n    }\n\n    var url = parseURL(href);\n\n    if (url.protocol !== location.protocol) {\n      return false;\n    }\n\n    if (url.hostname !== location.hostname) {\n      return false;\n    }\n\n    if (url.port !== location.port) {\n      return false;\n    }\n\n    return url.pathname === location.pathname;\n  }\n\n  function iterateCSSRules(rules, iterate, onMediaRuleError) {\n    forEach(rules, function (rule) {\n      if (rule.selectorText) {\n        iterate(rule);\n      } else if (rule.href) {\n        try {\n          iterateCSSRules(rule.styleSheet.cssRules, iterate, onMediaRuleError);\n        } catch (err) {\n          logInfo(\"Found a non-loaded link.\");\n          onMediaRuleError && onMediaRuleError();\n        }\n      } else if (rule.media) {\n        var media = Array.from(rule.media);\n        var isScreenOrAllOrQuery = media.some(function (m) {\n          return m.startsWith('screen') || m.startsWith('all') || m.startsWith('(');\n        });\n        var isPrintOrSpeech = media.some(function (m) {\n          return m.startsWith('print') || m.startsWith('speech');\n        });\n\n        if (isScreenOrAllOrQuery || !isPrintOrSpeech) {\n          iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\n        }\n      } else if (rule.conditionText) {\n        if (CSS.supports(rule.conditionText)) {\n          iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\n        }\n      } else {\n        logWarn(\"CSSRule type not supported\", rule);\n      }\n    });\n  }\n\n  var shorthandVarDependantProperties = ['background', 'border', 'border-color', 'border-bottom', 'border-left', 'border-right', 'border-top', 'outline', 'outline-color'];\n  var shorthandVarDepPropRegexps = isSafari ? shorthandVarDependantProperties.map(function (prop) {\n    var regexp = new RegExp(prop + \":\\\\s*(.*?)\\\\s*;\");\n    return [prop, regexp];\n  }) : null;\n\n  function iterateCSSDeclarations(style, iterate) {\n    forEach(style, function (property) {\n      var value = style.getPropertyValue(property).trim();\n\n      if (!value) {\n        return;\n      }\n\n      iterate(property, value);\n    });\n    var cssText = style.cssText;\n\n    if (cssText.includes('var(')) {\n      if (isSafari) {\n        shorthandVarDepPropRegexps.forEach(function (_a) {\n          var _b = __read(_a, 2),\n              prop = _b[0],\n              regexp = _b[1];\n\n          var match = cssText.match(regexp);\n\n          if (match && match[1]) {\n            var val = match[1].trim();\n            iterate(prop, val);\n          }\n        });\n      } else {\n        shorthandVarDependantProperties.forEach(function (prop) {\n          var val = style.getPropertyValue(prop);\n\n          if (val && val.includes('var(')) {\n            iterate(prop, val);\n          }\n        });\n      }\n    }\n  }\n\n  var cssURLRegex = /url\\((('.+?')|(\".+?\")|([^\\)]*?))\\)/g;\n  var cssImportRegex = /@import\\s*(url\\()?(('.+?')|(\".+?\")|([^\\)]*?))\\)? ?(screen)?;?/g;\n\n  function getCSSURLValue(cssURL) {\n    return cssURL.replace(/^url\\((.*)\\)$/, '$1').trim().replace(/^\"(.*)\"$/, '$1').replace(/^'(.*)'$/, '$1');\n  }\n\n  function getCSSBaseBath(url) {\n    var cssURL = parseURL(url);\n    return \"\" + cssURL.origin + cssURL.pathname.replace(/\\?.*$/, '').replace(/(\\/)([^\\/]+)$/i, '$1');\n  }\n\n  function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\n    return $css.replace(cssURLRegex, function (match) {\n      var pathValue = getCSSURLValue(match);\n\n      try {\n        return \"url(\\\"\" + getAbsoluteURL(cssBasePath, pathValue) + \"\\\")\";\n      } catch (err) {\n        logWarn('Not able to replace relative URL with Absolute URL, skipping');\n        return match;\n      }\n    });\n  }\n\n  var cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\n\n  function removeCSSComments($css) {\n    return $css.replace(cssCommentsRegex, '');\n  }\n\n  var fontFaceRegex = /@font-face\\s*{[^}]*}/g;\n\n  function replaceCSSFontFace($css) {\n    return $css.replace(fontFaceRegex, '');\n  }\n\n  function hslToRGB(_a) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        _b = _a.a,\n        a = _b === void 0 ? 1 : _b;\n\n    if (s === 0) {\n      var _c = __read([l, l, l].map(function (x) {\n        return Math.round(x * 255);\n      }), 3),\n          r_1 = _c[0],\n          b_1 = _c[1],\n          g_1 = _c[2];\n\n      return {\n        r: r_1,\n        g: g_1,\n        b: b_1,\n        a: a\n      };\n    }\n\n    var c = (1 - Math.abs(2 * l - 1)) * s;\n    var x = c * (1 - Math.abs(h / 60 % 2 - 1));\n    var m = l - c / 2;\n\n    var _d = __read((h < 60 ? [c, x, 0] : h < 120 ? [x, c, 0] : h < 180 ? [0, c, x] : h < 240 ? [0, x, c] : h < 300 ? [x, 0, c] : [c, 0, x]).map(function (n) {\n      return Math.round((n + m) * 255);\n    }), 3),\n        r = _d[0],\n        g = _d[1],\n        b = _d[2];\n\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a\n    };\n  }\n\n  function rgbToHSL(_a) {\n    var r255 = _a.r,\n        g255 = _a.g,\n        b255 = _a.b,\n        _b = _a.a,\n        a = _b === void 0 ? 1 : _b;\n    var r = r255 / 255;\n    var g = g255 / 255;\n    var b = b255 / 255;\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var c = max - min;\n    var l = (max + min) / 2;\n\n    if (c === 0) {\n      return {\n        h: 0,\n        s: 0,\n        l: l,\n        a: a\n      };\n    }\n\n    var h = (max === r ? (g - b) / c % 6 : max === g ? (b - r) / c + 2 : (r - g) / c + 4) * 60;\n\n    if (h < 0) {\n      h += 360;\n    }\n\n    var s = c / (1 - Math.abs(2 * l - 1));\n    return {\n      h: h,\n      s: s,\n      l: l,\n      a: a\n    };\n  }\n\n  function toFixed(n, digits) {\n    if (digits === void 0) {\n      digits = 0;\n    }\n\n    var fixed = n.toFixed(digits);\n\n    if (digits === 0) {\n      return fixed;\n    }\n\n    var dot = fixed.indexOf('.');\n\n    if (dot >= 0) {\n      var zerosMatch = fixed.match(/0+$/);\n\n      if (zerosMatch) {\n        if (zerosMatch.index === dot + 1) {\n          return fixed.substring(0, dot);\n        }\n\n        return fixed.substring(0, zerosMatch.index);\n      }\n    }\n\n    return fixed;\n  }\n\n  function rgbToString(rgb) {\n    var r = rgb.r,\n        g = rgb.g,\n        b = rgb.b,\n        a = rgb.a;\n\n    if (a != null && a < 1) {\n      return \"rgba(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \", \" + toFixed(a, 2) + \")\";\n    }\n\n    return \"rgb(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \")\";\n  }\n\n  function rgbToHexString(_a) {\n    var r = _a.r,\n        g = _a.g,\n        b = _a.b,\n        a = _a.a;\n    return \"#\" + (a != null && a < 1 ? [r, g, b, Math.round(a * 255)] : [r, g, b]).map(function (x) {\n      return \"\" + (x < 16 ? '0' : '') + x.toString(16);\n    }).join('');\n  }\n\n  function hslToString(hsl) {\n    var h = hsl.h,\n        s = hsl.s,\n        l = hsl.l,\n        a = hsl.a;\n\n    if (a != null && a < 1) {\n      return \"hsla(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%, \" + toFixed(a, 2) + \")\";\n    }\n\n    return \"hsl(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%)\";\n  }\n\n  var rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\n  var hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\n  var hexMatch = /^#[0-9a-f]+$/i;\n\n  function parse($color) {\n    var c = $color.trim().toLowerCase();\n\n    if (c.match(rgbMatch)) {\n      return parseRGB(c);\n    }\n\n    if (c.match(hslMatch)) {\n      return parseHSL(c);\n    }\n\n    if (c.match(hexMatch)) {\n      return parseHex(c);\n    }\n\n    if (knownColors.has(c)) {\n      return getColorByName(c);\n    }\n\n    if (systemColors.has(c)) {\n      return getSystemColor(c);\n    }\n\n    if ($color === 'transparent') {\n      return {\n        r: 0,\n        g: 0,\n        b: 0,\n        a: 0\n      };\n    }\n\n    throw new Error(\"Unable to parse \" + $color);\n  }\n\n  function getNumbers($color) {\n    var numbers = [];\n    var prevPos = 0;\n    var isMining = false;\n    var startIndex = $color.indexOf('(');\n    $color = $color.substring(startIndex + 1, $color.length - 1);\n\n    for (var i = 0; i < $color.length; i++) {\n      var c = $color[i];\n\n      if (c >= '0' && c <= '9' || c === '.' || c === '+' || c === '-') {\n        isMining = true;\n      } else if (isMining && (c === ' ' || c === ',')) {\n        numbers.push($color.substring(prevPos, i));\n        isMining = false;\n        prevPos = i + 1;\n      } else if (!isMining) {\n        prevPos = i + 1;\n      }\n    }\n\n    if (isMining) {\n      numbers.push($color.substring(prevPos, $color.length));\n    }\n\n    return numbers;\n  }\n\n  function getNumbersFromString(str, range, units) {\n    var raw = getNumbers(str);\n    var unitsList = Object.entries(units);\n    var numbers = raw.map(function (r) {\n      return r.trim();\n    }).map(function (r, i) {\n      var n;\n      var unit = unitsList.find(function (_a) {\n        var _b = __read(_a, 1),\n            u = _b[0];\n\n        return r.endsWith(u);\n      });\n\n      if (unit) {\n        n = parseFloat(r.substring(0, r.length - unit[0].length)) / unit[1] * range[i];\n      } else {\n        n = parseFloat(r);\n      }\n\n      if (range[i] > 1) {\n        return Math.round(n);\n      }\n\n      return n;\n    });\n    return numbers;\n  }\n\n  var rgbRange = [255, 255, 255, 1];\n  var rgbUnits = {\n    '%': 100\n  };\n\n  function parseRGB($rgb) {\n    var _a = __read(getNumbersFromString($rgb, rgbRange, rgbUnits), 4),\n        r = _a[0],\n        g = _a[1],\n        b = _a[2],\n        _b = _a[3],\n        a = _b === void 0 ? 1 : _b;\n\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a\n    };\n  }\n\n  var hslRange = [360, 1, 1, 1];\n  var hslUnits = {\n    '%': 100,\n    'deg': 360,\n    'rad': 2 * Math.PI,\n    'turn': 1\n  };\n\n  function parseHSL($hsl) {\n    var _a = __read(getNumbersFromString($hsl, hslRange, hslUnits), 4),\n        h = _a[0],\n        s = _a[1],\n        l = _a[2],\n        _b = _a[3],\n        a = _b === void 0 ? 1 : _b;\n\n    return hslToRGB({\n      h: h,\n      s: s,\n      l: l,\n      a: a\n    });\n  }\n\n  function parseHex($hex) {\n    var h = $hex.substring(1);\n\n    switch (h.length) {\n      case 3:\n      case 4:\n        {\n          var _a = __read([0, 1, 2].map(function (i) {\n            return parseInt(\"\" + h[i] + h[i], 16);\n          }), 3),\n              r = _a[0],\n              g = _a[1],\n              b = _a[2];\n\n          var a = h.length === 3 ? 1 : parseInt(\"\" + h[3] + h[3], 16) / 255;\n          return {\n            r: r,\n            g: g,\n            b: b,\n            a: a\n          };\n        }\n\n      case 6:\n      case 8:\n        {\n          var _b = __read([0, 2, 4].map(function (i) {\n            return parseInt(h.substring(i, i + 2), 16);\n          }), 3),\n              r = _b[0],\n              g = _b[1],\n              b = _b[2];\n\n          var a = h.length === 6 ? 1 : parseInt(h.substring(6, 8), 16) / 255;\n          return {\n            r: r,\n            g: g,\n            b: b,\n            a: a\n          };\n        }\n    }\n\n    throw new Error(\"Unable to parse \" + $hex);\n  }\n\n  function getColorByName($color) {\n    var n = knownColors.get($color);\n    return {\n      r: n >> 16 & 255,\n      g: n >> 8 & 255,\n      b: n >> 0 & 255,\n      a: 1\n    };\n  }\n\n  function getSystemColor($color) {\n    var n = systemColors.get($color);\n    return {\n      r: n >> 16 & 255,\n      g: n >> 8 & 255,\n      b: n >> 0 & 255,\n      a: 1\n    };\n  }\n\n  var isCharDigit = function isCharDigit(char) {\n    return char >= '0' && char <= '9';\n  };\n\n  var getAmountOfDigits = function getAmountOfDigits(number) {\n    return Math.floor(Math.log10(number)) + 1;\n  };\n\n  function lowerCalcExpression(color) {\n    var searchIndex = 0;\n\n    var replaceBetweenIndices = function replaceBetweenIndices(start, end, replacement) {\n      color = color.substring(0, start) + replacement + color.substring(end);\n    };\n\n    var getNumber = function getNumber() {\n      var resultNumber = 0;\n\n      for (var i = 1; i < 4; i++) {\n        var char = color[searchIndex + i];\n\n        if (char === ' ') {\n          break;\n        }\n\n        if (isCharDigit(char)) {\n          resultNumber *= 10;\n          resultNumber += Number(char);\n        } else {\n          break;\n        }\n      }\n\n      var lenDigits = getAmountOfDigits(resultNumber);\n      searchIndex += lenDigits;\n      var possibleType = color[searchIndex + 1];\n\n      if (possibleType !== '%') {\n        return;\n      }\n\n      searchIndex++;\n      return resultNumber;\n    };\n\n    while ((searchIndex = color.indexOf('calc(')) !== 0) {\n      var startIndex = searchIndex;\n      searchIndex += 4;\n      var firstNumber = getNumber();\n\n      if (!firstNumber) {\n        break;\n      }\n\n      if (color[searchIndex + 1] !== ' ') {\n        break;\n      }\n\n      searchIndex++;\n      var operation = color[searchIndex + 1];\n\n      if (operation !== '+' && operation !== '-') {\n        break;\n      }\n\n      searchIndex++;\n\n      if (color[searchIndex + 1] !== ' ') {\n        break;\n      }\n\n      searchIndex++;\n      var secondNumber = getNumber();\n\n      if (!secondNumber) {\n        break;\n      }\n\n      var replacement = void 0;\n\n      if (operation === '+') {\n        replacement = firstNumber + secondNumber + \"%\";\n      } else {\n        replacement = firstNumber - secondNumber + \"%\";\n      }\n\n      replaceBetweenIndices(startIndex, searchIndex + 2, replacement);\n    }\n\n    return color;\n  }\n\n  var knownColors = new Map(Object.entries({\n    aliceblue: 0xf0f8ff,\n    antiquewhite: 0xfaebd7,\n    aqua: 0x00ffff,\n    aquamarine: 0x7fffd4,\n    azure: 0xf0ffff,\n    beige: 0xf5f5dc,\n    bisque: 0xffe4c4,\n    black: 0x000000,\n    blanchedalmond: 0xffebcd,\n    blue: 0x0000ff,\n    blueviolet: 0x8a2be2,\n    brown: 0xa52a2a,\n    burlywood: 0xdeb887,\n    cadetblue: 0x5f9ea0,\n    chartreuse: 0x7fff00,\n    chocolate: 0xd2691e,\n    coral: 0xff7f50,\n    cornflowerblue: 0x6495ed,\n    cornsilk: 0xfff8dc,\n    crimson: 0xdc143c,\n    cyan: 0x00ffff,\n    darkblue: 0x00008b,\n    darkcyan: 0x008b8b,\n    darkgoldenrod: 0xb8860b,\n    darkgray: 0xa9a9a9,\n    darkgrey: 0xa9a9a9,\n    darkgreen: 0x006400,\n    darkkhaki: 0xbdb76b,\n    darkmagenta: 0x8b008b,\n    darkolivegreen: 0x556b2f,\n    darkorange: 0xff8c00,\n    darkorchid: 0x9932cc,\n    darkred: 0x8b0000,\n    darksalmon: 0xe9967a,\n    darkseagreen: 0x8fbc8f,\n    darkslateblue: 0x483d8b,\n    darkslategray: 0x2f4f4f,\n    darkslategrey: 0x2f4f4f,\n    darkturquoise: 0x00ced1,\n    darkviolet: 0x9400d3,\n    deeppink: 0xff1493,\n    deepskyblue: 0x00bfff,\n    dimgray: 0x696969,\n    dimgrey: 0x696969,\n    dodgerblue: 0x1e90ff,\n    firebrick: 0xb22222,\n    floralwhite: 0xfffaf0,\n    forestgreen: 0x228b22,\n    fuchsia: 0xff00ff,\n    gainsboro: 0xdcdcdc,\n    ghostwhite: 0xf8f8ff,\n    gold: 0xffd700,\n    goldenrod: 0xdaa520,\n    gray: 0x808080,\n    grey: 0x808080,\n    green: 0x008000,\n    greenyellow: 0xadff2f,\n    honeydew: 0xf0fff0,\n    hotpink: 0xff69b4,\n    indianred: 0xcd5c5c,\n    indigo: 0x4b0082,\n    ivory: 0xfffff0,\n    khaki: 0xf0e68c,\n    lavender: 0xe6e6fa,\n    lavenderblush: 0xfff0f5,\n    lawngreen: 0x7cfc00,\n    lemonchiffon: 0xfffacd,\n    lightblue: 0xadd8e6,\n    lightcoral: 0xf08080,\n    lightcyan: 0xe0ffff,\n    lightgoldenrodyellow: 0xfafad2,\n    lightgray: 0xd3d3d3,\n    lightgrey: 0xd3d3d3,\n    lightgreen: 0x90ee90,\n    lightpink: 0xffb6c1,\n    lightsalmon: 0xffa07a,\n    lightseagreen: 0x20b2aa,\n    lightskyblue: 0x87cefa,\n    lightslategray: 0x778899,\n    lightslategrey: 0x778899,\n    lightsteelblue: 0xb0c4de,\n    lightyellow: 0xffffe0,\n    lime: 0x00ff00,\n    limegreen: 0x32cd32,\n    linen: 0xfaf0e6,\n    magenta: 0xff00ff,\n    maroon: 0x800000,\n    mediumaquamarine: 0x66cdaa,\n    mediumblue: 0x0000cd,\n    mediumorchid: 0xba55d3,\n    mediumpurple: 0x9370db,\n    mediumseagreen: 0x3cb371,\n    mediumslateblue: 0x7b68ee,\n    mediumspringgreen: 0x00fa9a,\n    mediumturquoise: 0x48d1cc,\n    mediumvioletred: 0xc71585,\n    midnightblue: 0x191970,\n    mintcream: 0xf5fffa,\n    mistyrose: 0xffe4e1,\n    moccasin: 0xffe4b5,\n    navajowhite: 0xffdead,\n    navy: 0x000080,\n    oldlace: 0xfdf5e6,\n    olive: 0x808000,\n    olivedrab: 0x6b8e23,\n    orange: 0xffa500,\n    orangered: 0xff4500,\n    orchid: 0xda70d6,\n    palegoldenrod: 0xeee8aa,\n    palegreen: 0x98fb98,\n    paleturquoise: 0xafeeee,\n    palevioletred: 0xdb7093,\n    papayawhip: 0xffefd5,\n    peachpuff: 0xffdab9,\n    peru: 0xcd853f,\n    pink: 0xffc0cb,\n    plum: 0xdda0dd,\n    powderblue: 0xb0e0e6,\n    purple: 0x800080,\n    rebeccapurple: 0x663399,\n    red: 0xff0000,\n    rosybrown: 0xbc8f8f,\n    royalblue: 0x4169e1,\n    saddlebrown: 0x8b4513,\n    salmon: 0xfa8072,\n    sandybrown: 0xf4a460,\n    seagreen: 0x2e8b57,\n    seashell: 0xfff5ee,\n    sienna: 0xa0522d,\n    silver: 0xc0c0c0,\n    skyblue: 0x87ceeb,\n    slateblue: 0x6a5acd,\n    slategray: 0x708090,\n    slategrey: 0x708090,\n    snow: 0xfffafa,\n    springgreen: 0x00ff7f,\n    steelblue: 0x4682b4,\n    tan: 0xd2b48c,\n    teal: 0x008080,\n    thistle: 0xd8bfd8,\n    tomato: 0xff6347,\n    turquoise: 0x40e0d0,\n    violet: 0xee82ee,\n    wheat: 0xf5deb3,\n    white: 0xffffff,\n    whitesmoke: 0xf5f5f5,\n    yellow: 0xffff00,\n    yellowgreen: 0x9acd32\n  }));\n  var systemColors = new Map(Object.entries({\n    ActiveBorder: 0x3b99fc,\n    ActiveCaption: 0x000000,\n    AppWorkspace: 0xaaaaaa,\n    Background: 0x6363ce,\n    ButtonFace: 0xffffff,\n    ButtonHighlight: 0xe9e9e9,\n    ButtonShadow: 0x9fa09f,\n    ButtonText: 0x000000,\n    CaptionText: 0x000000,\n    GrayText: 0x7f7f7f,\n    Highlight: 0xb2d7ff,\n    HighlightText: 0x000000,\n    InactiveBorder: 0xffffff,\n    InactiveCaption: 0xffffff,\n    InactiveCaptionText: 0x000000,\n    InfoBackground: 0xfbfcc5,\n    InfoText: 0x000000,\n    Menu: 0xf6f6f6,\n    MenuText: 0xffffff,\n    Scrollbar: 0xaaaaaa,\n    ThreeDDarkShadow: 0x000000,\n    ThreeDFace: 0xc0c0c0,\n    ThreeDHighlight: 0xffffff,\n    ThreeDLightShadow: 0xffffff,\n    ThreeDShadow: 0x000000,\n    Window: 0xececec,\n    WindowFrame: 0xaaaaaa,\n    WindowText: 0x000000,\n    '-webkit-focus-ring-color': 0xe59700\n  }).map(function (_a) {\n    var _b = __read(_a, 2),\n        key = _b[0],\n        value = _b[1];\n\n    return [key.toLowerCase(), value];\n  }));\n\n  function scale(x, inLow, inHigh, outLow, outHigh) {\n    return (x - inLow) * (outHigh - outLow) / (inHigh - inLow) + outLow;\n  }\n\n  function clamp(x, min, max) {\n    return Math.min(max, Math.max(min, x));\n  }\n\n  function multiplyMatrices(m1, m2) {\n    var result = [];\n\n    for (var i = 0, len = m1.length; i < len; i++) {\n      result[i] = [];\n\n      for (var j = 0, len2 = m2[0].length; j < len2; j++) {\n        var sum = 0;\n\n        for (var k = 0, len3 = m1[0].length; k < len3; k++) {\n          sum += m1[i][k] * m2[k][j];\n        }\n\n        result[i][j] = sum;\n      }\n    }\n\n    return result;\n  }\n\n  function getMatches(regex, input, group) {\n    if (group === void 0) {\n      group = 0;\n    }\n\n    var matches = [];\n    var m;\n\n    while (m = regex.exec(input)) {\n      matches.push(m[group]);\n    }\n\n    return matches;\n  }\n\n  function formatCSS(text) {\n    function trimLeft(text) {\n      return text.replace(/^\\s+/, '');\n    }\n\n    function getIndent(depth) {\n      if (depth === 0) {\n        return '';\n      }\n\n      return ' '.repeat(4 * depth);\n    }\n\n    if (text.length < 50000) {\n      var emptyRuleRegexp = /[^{}]+{\\s*}/;\n\n      while (emptyRuleRegexp.test(text)) {\n        text = text.replace(emptyRuleRegexp, '');\n      }\n    }\n\n    var css = text.replace(/\\s{2,}/g, ' ').replace(/\\{/g, '{\\n').replace(/\\}/g, '\\n}\\n').replace(/\\;(?![^\\(|\\\"]*(\\)|\\\"))/g, ';\\n').replace(/\\,(?![^\\(|\\\"]*(\\)|\\\"))/g, ',\\n').replace(/\\n\\s*\\n/g, '\\n').split('\\n');\n    var depth = 0;\n    var formatted = [];\n\n    for (var x = 0, len = css.length; x < len; x++) {\n      var line = css[x] + \"\\n\";\n\n      if (line.includes('{')) {\n        formatted.push(getIndent(depth++) + trimLeft(line));\n      } else if (line.includes('\\}')) {\n        formatted.push(getIndent(--depth) + trimLeft(line));\n      } else {\n        formatted.push(getIndent(depth) + trimLeft(line));\n      }\n    }\n\n    return formatted.join('').trim();\n  }\n\n  function getParenthesesRange(input, searchStartIndex) {\n    if (searchStartIndex === void 0) {\n      searchStartIndex = 0;\n    }\n\n    var length = input.length;\n    var depth = 0;\n    var firstOpenIndex = -1;\n\n    for (var i = searchStartIndex; i < length; i++) {\n      if (depth === 0) {\n        var openIndex = input.indexOf('(', i);\n\n        if (openIndex < 0) {\n          break;\n        }\n\n        firstOpenIndex = openIndex;\n        depth++;\n        i = openIndex;\n      } else {\n        var closingIndex = input.indexOf(')', i);\n\n        if (closingIndex < 0) {\n          break;\n        }\n\n        var openIndex = input.indexOf('(', i);\n\n        if (openIndex < 0 || closingIndex < openIndex) {\n          depth--;\n\n          if (depth === 0) {\n            return {\n              start: firstOpenIndex,\n              end: closingIndex + 1\n            };\n          }\n\n          i = closingIndex;\n        } else {\n          depth++;\n          i = openIndex;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  function createFilterMatrix(config) {\n    var m = Matrix.identity();\n\n    if (config.sepia !== 0) {\n      m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\n    }\n\n    if (config.grayscale !== 0) {\n      m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\n    }\n\n    if (config.contrast !== 100) {\n      m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\n    }\n\n    if (config.brightness !== 100) {\n      m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\n    }\n\n    if (config.mode === 1) {\n      m = multiplyMatrices(m, Matrix.invertNHue());\n    }\n\n    return m;\n  }\n\n  function applyColorMatrix(_a, matrix) {\n    var _b = __read(_a, 3),\n        r = _b[0],\n        g = _b[1],\n        b = _b[2];\n\n    var rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\n    var result = multiplyMatrices(matrix, rgb);\n    return [0, 1, 2].map(function (i) {\n      return clamp(Math.round(result[i][0] * 255), 0, 255);\n    });\n  }\n\n  var Matrix = {\n    identity: function identity() {\n      return [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    invertNHue: function invertNHue() {\n      return [[0.333, -0.667, -0.667, 0, 1], [-0.667, 0.333, -0.667, 0, 1], [-0.667, -0.667, 0.333, 0, 1], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    brightness: function brightness(v) {\n      return [[v, 0, 0, 0, 0], [0, v, 0, 0, 0], [0, 0, v, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    contrast: function contrast(v) {\n      var t = (1 - v) / 2;\n      return [[v, 0, 0, 0, t], [0, v, 0, 0, t], [0, 0, v, 0, t], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    sepia: function sepia(v) {\n      return [[0.393 + 0.607 * (1 - v), 0.769 - 0.769 * (1 - v), 0.189 - 0.189 * (1 - v), 0, 0], [0.349 - 0.349 * (1 - v), 0.686 + 0.314 * (1 - v), 0.168 - 0.168 * (1 - v), 0, 0], [0.272 - 0.272 * (1 - v), 0.534 - 0.534 * (1 - v), 0.131 + 0.869 * (1 - v), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    grayscale: function grayscale(v) {\n      return [[0.2126 + 0.7874 * (1 - v), 0.7152 - 0.7152 * (1 - v), 0.0722 - 0.0722 * (1 - v), 0, 0], [0.2126 - 0.2126 * (1 - v), 0.7152 + 0.2848 * (1 - v), 0.0722 - 0.0722 * (1 - v), 0, 0], [0.2126 - 0.2126 * (1 - v), 0.7152 - 0.7152 * (1 - v), 0.0722 + 0.9278 * (1 - v), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    }\n  };\n\n  function getBgPole(theme) {\n    var isDarkScheme = theme.mode === 1;\n    var prop = isDarkScheme ? 'darkSchemeBackgroundColor' : 'lightSchemeBackgroundColor';\n    return theme[prop];\n  }\n\n  function getFgPole(theme) {\n    var isDarkScheme = theme.mode === 1;\n    var prop = isDarkScheme ? 'darkSchemeTextColor' : 'lightSchemeTextColor';\n    return theme[prop];\n  }\n\n  var colorModificationCache = new Map();\n  var colorParseCache$1 = new Map();\n\n  function parseToHSLWithCache(color) {\n    if (colorParseCache$1.has(color)) {\n      return colorParseCache$1.get(color);\n    }\n\n    var rgb = parse(color);\n    var hsl = rgbToHSL(rgb);\n    colorParseCache$1.set(color, hsl);\n    return hsl;\n  }\n\n  function clearColorModificationCache() {\n    colorModificationCache.clear();\n    colorParseCache$1.clear();\n  }\n\n  var rgbCacheKeys = ['r', 'g', 'b', 'a'];\n  var themeCacheKeys$1 = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\n\n  function getCacheId(rgb, theme) {\n    var resultId = '';\n    rgbCacheKeys.forEach(function (key) {\n      resultId += rgb[key] + \";\";\n    });\n    themeCacheKeys$1.forEach(function (key) {\n      resultId += theme[key] + \";\";\n    });\n    return resultId;\n  }\n\n  function modifyColorWithCache(rgb, theme, modifyHSL, poleColor, anotherPoleColor) {\n    var fnCache;\n\n    if (colorModificationCache.has(modifyHSL)) {\n      fnCache = colorModificationCache.get(modifyHSL);\n    } else {\n      fnCache = new Map();\n      colorModificationCache.set(modifyHSL, fnCache);\n    }\n\n    var id = getCacheId(rgb, theme);\n\n    if (fnCache.has(id)) {\n      return fnCache.get(id);\n    }\n\n    var hsl = rgbToHSL(rgb);\n    var pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\n    var anotherPole = anotherPoleColor == null ? null : parseToHSLWithCache(anotherPoleColor);\n    var modified = modifyHSL(hsl, pole, anotherPole);\n\n    var _a = hslToRGB(modified),\n        r = _a.r,\n        g = _a.g,\n        b = _a.b,\n        a = _a.a;\n\n    var matrix = createFilterMatrix(theme);\n\n    var _b = __read(applyColorMatrix([r, g, b], matrix), 3),\n        rf = _b[0],\n        gf = _b[1],\n        bf = _b[2];\n\n    var color = a === 1 ? rgbToHexString({\n      r: rf,\n      g: gf,\n      b: bf\n    }) : rgbToString({\n      r: rf,\n      g: gf,\n      b: bf,\n      a: a\n    });\n    fnCache.set(id, color);\n    return color;\n  }\n\n  function noopHSL(hsl) {\n    return hsl;\n  }\n\n  function modifyColor(rgb, theme) {\n    return modifyColorWithCache(rgb, theme, noopHSL);\n  }\n\n  function modifyLightSchemeColor(rgb, theme) {\n    var poleBg = getBgPole(theme);\n    var poleFg = getFgPole(theme);\n    return modifyColorWithCache(rgb, theme, modifyLightModeHSL, poleFg, poleBg);\n  }\n\n  function modifyLightModeHSL(_a, poleFg, poleBg) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isNeutral;\n\n    if (isDark) {\n      isNeutral = l < 0.2 || s < 0.12;\n    } else {\n      var isBlue = h > 200 && h < 280;\n      isNeutral = s < 0.24 || l > 0.8 && isBlue;\n    }\n\n    var hx = h;\n    var sx = l;\n\n    if (isNeutral) {\n      if (isDark) {\n        hx = poleFg.h;\n        sx = poleFg.s;\n      } else {\n        hx = poleBg.h;\n        sx = poleBg.s;\n      }\n    }\n\n    var lx = scale(l, 0, 1, poleFg.l, poleBg.l);\n    return {\n      h: hx,\n      s: sx,\n      l: lx,\n      a: a\n    };\n  }\n\n  var MAX_BG_LIGHTNESS = 0.4;\n\n  function modifyBgHSL(_a, pole) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isBlue = h > 200 && h < 280;\n    var isNeutral = s < 0.12 || l > 0.8 && isBlue;\n\n    if (isDark) {\n      var lx_1 = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\n\n      if (isNeutral) {\n        var hx_1 = pole.h;\n        var sx = pole.s;\n        return {\n          h: hx_1,\n          s: sx,\n          l: lx_1,\n          a: a\n        };\n      }\n\n      return {\n        h: h,\n        s: s,\n        l: lx_1,\n        a: a\n      };\n    }\n\n    var lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\n\n    if (isNeutral) {\n      var hx_2 = pole.h;\n      var sx = pole.s;\n      return {\n        h: hx_2,\n        s: sx,\n        l: lx,\n        a: a\n      };\n    }\n\n    var hx = h;\n    var isYellow = h > 60 && h < 180;\n\n    if (isYellow) {\n      var isCloserToGreen = h > 120;\n\n      if (isCloserToGreen) {\n        hx = scale(h, 120, 180, 135, 180);\n      } else {\n        hx = scale(h, 60, 120, 60, 105);\n      }\n    }\n\n    return {\n      h: hx,\n      s: s,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyBackgroundColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var pole = getBgPole(theme);\n    return modifyColorWithCache(rgb, _assign(_assign({}, theme), {\n      mode: 0\n    }), modifyBgHSL, pole);\n  }\n\n  var MIN_FG_LIGHTNESS = 0.55;\n\n  function modifyBlueFgHue(hue) {\n    return scale(hue, 205, 245, 205, 220);\n  }\n\n  function modifyFgHSL(_a, pole) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isLight = l > 0.5;\n    var isNeutral = l < 0.2 || s < 0.24;\n    var isBlue = !isNeutral && h > 205 && h < 245;\n\n    if (isLight) {\n      var lx_2 = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\n\n      if (isNeutral) {\n        var hx_3 = pole.h;\n        var sx = pole.s;\n        return {\n          h: hx_3,\n          s: sx,\n          l: lx_2,\n          a: a\n        };\n      }\n\n      var hx_4 = h;\n\n      if (isBlue) {\n        hx_4 = modifyBlueFgHue(h);\n      }\n\n      return {\n        h: hx_4,\n        s: s,\n        l: lx_2,\n        a: a\n      };\n    }\n\n    if (isNeutral) {\n      var hx_5 = pole.h;\n      var sx = pole.s;\n      var lx_3 = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\n      return {\n        h: hx_5,\n        s: sx,\n        l: lx_3,\n        a: a\n      };\n    }\n\n    var hx = h;\n    var lx;\n\n    if (isBlue) {\n      hx = modifyBlueFgHue(h);\n      lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\n    } else {\n      lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\n    }\n\n    return {\n      h: hx,\n      s: s,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyForegroundColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var pole = getFgPole(theme);\n    return modifyColorWithCache(rgb, _assign(_assign({}, theme), {\n      mode: 0\n    }), modifyFgHSL, pole);\n  }\n\n  function modifyBorderHSL(_a, poleFg, poleBg) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isNeutral = l < 0.2 || s < 0.24;\n    var hx = h;\n    var sx = s;\n\n    if (isNeutral) {\n      if (isDark) {\n        hx = poleFg.h;\n        sx = poleFg.s;\n      } else {\n        hx = poleBg.h;\n        sx = poleBg.s;\n      }\n    }\n\n    var lx = scale(l, 0, 1, 0.5, 0.2);\n    return {\n      h: hx,\n      s: sx,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyBorderColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var poleFg = getFgPole(theme);\n    var poleBg = getBgPole(theme);\n    return modifyColorWithCache(rgb, _assign(_assign({}, theme), {\n      mode: 0\n    }), modifyBorderHSL, poleFg, poleBg);\n  }\n\n  function modifyShadowColor(rgb, filter) {\n    return modifyBackgroundColor(rgb, filter);\n  }\n\n  function modifyGradientColor(rgb, filter) {\n    return modifyBackgroundColor(rgb, filter);\n  }\n\n  function createTextStyle(config) {\n    var lines = [];\n    lines.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*=\"vjs-\"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*=\"mu-\"], .glyphicon, .icon) {');\n\n    if (config.useFont && config.fontFamily) {\n      lines.push(\"  font-family: \" + config.fontFamily + \" !important;\");\n    }\n\n    if (config.textStroke > 0) {\n      lines.push(\"  -webkit-text-stroke: \" + config.textStroke + \"px !important;\");\n      lines.push(\"  text-stroke: \" + config.textStroke + \"px !important;\");\n    }\n\n    lines.push('}');\n    return lines.join('\\n');\n  }\n\n  var FilterMode;\n\n  (function (FilterMode) {\n    FilterMode[FilterMode[\"light\"] = 0] = \"light\";\n    FilterMode[FilterMode[\"dark\"] = 1] = \"dark\";\n  })(FilterMode || (FilterMode = {}));\n\n  function getCSSFilterValue(config) {\n    var filters = [];\n\n    if (config.mode === FilterMode.dark) {\n      filters.push('invert(100%) hue-rotate(180deg)');\n    }\n\n    if (config.brightness !== 100) {\n      filters.push(\"brightness(\" + config.brightness + \"%)\");\n    }\n\n    if (config.contrast !== 100) {\n      filters.push(\"contrast(\" + config.contrast + \"%)\");\n    }\n\n    if (config.grayscale !== 0) {\n      filters.push(\"grayscale(\" + config.grayscale + \"%)\");\n    }\n\n    if (config.sepia !== 0) {\n      filters.push(\"sepia(\" + config.sepia + \"%)\");\n    }\n\n    if (filters.length === 0) {\n      return null;\n    }\n\n    return filters.join(' ');\n  }\n\n  function toSVGMatrix(matrix) {\n    return matrix.slice(0, 4).map(function (m) {\n      return m.map(function (m) {\n        return m.toFixed(3);\n      }).join(' ');\n    }).join(' ');\n  }\n\n  function getSVGFilterMatrixValue(config) {\n    return toSVGMatrix(createFilterMatrix(config));\n  }\n\n  var counter = 0;\n  var resolvers$1 = new Map();\n  var rejectors = new Map();\n\n  function bgFetch(request) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var id = ++counter;\n          resolvers$1.set(id, resolve);\n          rejectors.set(id, reject);\n\n          if (typeof chrome !== 'undefined') {\n            chrome.runtime.sendMessage({\n              type: MessageType.CS_FETCH,\n              data: request,\n              id: id\n            });\n          }\n        })];\n      });\n    });\n  }\n\n  if (typeof chrome !== 'undefined') {\n    chrome.runtime.onMessage.addListener(function (_a) {\n      var type = _a.type,\n          data = _a.data,\n          error = _a.error,\n          id = _a.id;\n\n      if (type === MessageType.BG_FETCH_RESPONSE) {\n        var resolve = resolvers$1.get(id);\n        var reject = rejectors.get(id);\n        resolvers$1.delete(id);\n        rejectors.delete(id);\n\n        if (error) {\n          reject && reject(error);\n        } else {\n          resolve && resolve(data);\n        }\n      }\n    });\n  }\n\n  var AsyncQueue = function () {\n    function AsyncQueue() {\n      this.queue = [];\n      this.timerId = null;\n      this.frameDuration = 1000 / 60;\n    }\n\n    AsyncQueue.prototype.addToQueue = function (entry) {\n      this.queue.push(entry);\n      this.startQueue();\n    };\n\n    AsyncQueue.prototype.stopQueue = function () {\n      if (this.timerId !== null) {\n        cancelAnimationFrame(this.timerId);\n        this.timerId = null;\n      }\n\n      this.queue = [];\n    };\n\n    AsyncQueue.prototype.startQueue = function () {\n      var _this = this;\n\n      if (this.timerId) {\n        return;\n      }\n\n      this.timerId = requestAnimationFrame(function () {\n        _this.timerId = null;\n        var start = Date.now();\n        var cb;\n\n        while (cb = _this.queue.shift()) {\n          cb();\n\n          if (Date.now() - start >= _this.frameDuration) {\n            _this.startQueue();\n\n            break;\n          }\n        }\n      });\n    };\n\n    return AsyncQueue;\n  }();\n\n  var imageManager = new AsyncQueue();\n\n  function getImageDetails(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var dataURL, error_1, image_1, error_2;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  if (!url.startsWith('data:')) return [3, 1];\n                  dataURL = url;\n                  return [3, 4];\n\n                case 1:\n                  _a.trys.push([1, 3,, 4]);\n\n                  return [4, getImageDataURL(url)];\n\n                case 2:\n                  dataURL = _a.sent();\n                  return [3, 4];\n\n                case 3:\n                  error_1 = _a.sent();\n                  reject(error_1);\n                  return [2];\n\n                case 4:\n                  _a.trys.push([4, 6,, 7]);\n\n                  return [4, urlToImage(dataURL)];\n\n                case 5:\n                  image_1 = _a.sent();\n                  imageManager.addToQueue(function () {\n                    resolve(_assign({\n                      src: url,\n                      dataURL: dataURL,\n                      width: image_1.naturalWidth,\n                      height: image_1.naturalHeight\n                    }, analyzeImage(image_1)));\n                  });\n                  return [3, 7];\n\n                case 6:\n                  error_2 = _a.sent();\n                  reject(error_2);\n                  return [3, 7];\n\n                case 7:\n                  return [2];\n              }\n            });\n          });\n        })];\n      });\n    });\n  }\n\n  function getImageDataURL(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      var parsedURL;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            parsedURL = new URL(url);\n            if (!(parsedURL.origin === location.origin)) return [3, 2];\n            return [4, loadAsDataURL(url)];\n\n          case 1:\n            return [2, _a.sent()];\n\n          case 2:\n            return [4, bgFetch({\n              url: url,\n              responseType: 'data-url'\n            })];\n\n          case 3:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function urlToImage(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var image = new Image();\n\n          image.onload = function () {\n            return resolve(image);\n          };\n\n          image.onerror = function () {\n            return reject(\"Unable to load image \" + url);\n          };\n\n          image.src = url;\n        })];\n      });\n    });\n  }\n\n  var MAX_ANALIZE_PIXELS_COUNT = 32 * 32;\n  var canvas;\n  var context;\n\n  function createCanvas() {\n    var maxWidth = MAX_ANALIZE_PIXELS_COUNT;\n    var maxHeight = MAX_ANALIZE_PIXELS_COUNT;\n    canvas = document.createElement('canvas');\n    canvas.width = maxWidth;\n    canvas.height = maxHeight;\n    context = canvas.getContext('2d');\n    context.imageSmoothingEnabled = false;\n  }\n\n  function removeCanvas() {\n    canvas = null;\n    context = null;\n  }\n\n  var MAX_IMAGE_SIZE = 5 * 1024 * 1024;\n\n  function analyzeImage(image) {\n    if (!canvas) {\n      createCanvas();\n    }\n\n    var naturalWidth = image.naturalWidth,\n        naturalHeight = image.naturalHeight;\n\n    if (naturalHeight === 0 || naturalWidth === 0) {\n      logWarn(\"logWarn(Image is empty \" + image.currentSrc + \")\");\n      return null;\n    }\n\n    var size = naturalWidth * naturalHeight * 4;\n\n    if (size > MAX_IMAGE_SIZE) {\n      logInfo('Skipped large image analyzing(Larger than 5mb in memory)');\n      return {\n        isDark: false,\n        isLight: false,\n        isTransparent: false,\n        isLarge: false,\n        isTooLarge: true\n      };\n    }\n\n    var naturalPixelsCount = naturalWidth * naturalHeight;\n    var k = Math.min(1, Math.sqrt(MAX_ANALIZE_PIXELS_COUNT / naturalPixelsCount));\n    var width = Math.ceil(naturalWidth * k);\n    var height = Math.ceil(naturalHeight * k);\n    context.clearRect(0, 0, width, height);\n    context.drawImage(image, 0, 0, naturalWidth, naturalHeight, 0, 0, width, height);\n    var imageData = context.getImageData(0, 0, width, height);\n    var d = imageData.data;\n    var TRANSPARENT_ALPHA_THRESHOLD = 0.05;\n    var DARK_LIGHTNESS_THRESHOLD = 0.4;\n    var LIGHT_LIGHTNESS_THRESHOLD = 0.7;\n    var transparentPixelsCount = 0;\n    var darkPixelsCount = 0;\n    var lightPixelsCount = 0;\n    var i, x, y;\n    var r, g, b, a;\n    var l;\n\n    for (y = 0; y < height; y++) {\n      for (x = 0; x < width; x++) {\n        i = 4 * (y * width + x);\n        r = d[i + 0] / 255;\n        g = d[i + 1] / 255;\n        b = d[i + 2] / 255;\n        a = d[i + 3] / 255;\n\n        if (a < TRANSPARENT_ALPHA_THRESHOLD) {\n          transparentPixelsCount++;\n        } else {\n          l = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n\n          if (l < DARK_LIGHTNESS_THRESHOLD) {\n            darkPixelsCount++;\n          }\n\n          if (l > LIGHT_LIGHTNESS_THRESHOLD) {\n            lightPixelsCount++;\n          }\n        }\n      }\n    }\n\n    var totalPixelsCount = width * height;\n    var opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\n    var DARK_IMAGE_THRESHOLD = 0.7;\n    var LIGHT_IMAGE_THRESHOLD = 0.7;\n    var TRANSPARENT_IMAGE_THRESHOLD = 0.1;\n    var LARGE_IMAGE_PIXELS_COUNT = 800 * 600;\n    return {\n      isDark: darkPixelsCount / opaquePixelsCount >= DARK_IMAGE_THRESHOLD,\n      isLight: lightPixelsCount / opaquePixelsCount >= LIGHT_IMAGE_THRESHOLD,\n      isTransparent: transparentPixelsCount / totalPixelsCount >= TRANSPARENT_IMAGE_THRESHOLD,\n      isLarge: naturalPixelsCount >= LARGE_IMAGE_PIXELS_COUNT,\n      isTooLarge: false\n    };\n  }\n\n  function getFilteredImageDataURL(_a, theme) {\n    var dataURL = _a.dataURL,\n        width = _a.width,\n        height = _a.height;\n    var matrix = getSVGFilterMatrixValue(theme);\n    var svg = [\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\">\", '<defs>', '<filter id=\"darkreader-image-filter\">', \"<feColorMatrix type=\\\"matrix\\\" values=\\\"\" + matrix + \"\\\" />\", '</filter>', '</defs>', \"<image width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\" filter=\\\"url(#darkreader-image-filter)\\\" xlink:href=\\\"\" + dataURL + \"\\\" />\", '</svg>'].join('');\n    return \"data:image/svg+xml;base64,\" + btoa(svg);\n  }\n\n  function cleanImageProcessingCache() {\n    imageManager && imageManager.stopQueue();\n    removeCanvas();\n  }\n\n  function getPriority(ruleStyle, property) {\n    return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\n  }\n\n  function getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageSelectors, isCancelled) {\n    if (property.startsWith('--')) {\n      var modifier = getVariableModifier(variablesStore, property, value, rule, ignoreImageSelectors, isCancelled);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (value.includes('var(')) {\n      var modifier = getVariableDependantModifier(variablesStore, property, value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property.includes('color') && property !== '-webkit-print-color-adjust' || property === 'fill' || property === 'stroke' || property === 'stop-color') {\n      var modifier = getColorModifier(property, value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property === 'background-image' || property === 'list-style-image') {\n      var modifier = getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property.includes('shadow')) {\n      var modifier = getShadowModifier(value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    }\n\n    return null;\n  }\n\n  function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\n    var lines = [];\n\n    if (!isIFrame) {\n      lines.push('html {');\n      lines.push(\"    background-color: \" + modifyBackgroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, theme) + \" !important;\");\n      lines.push('}');\n    }\n\n    lines.push(\"\" + (isIFrame ? '' : 'html, body, ') + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 255,\n      g: 255,\n      b: 255\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push(\"html, body, \" + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 76,\n      g: 76,\n      b: 76\n    }, theme) + \";\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('a {');\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 64,\n      b: 255\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('table {');\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 128,\n      g: 128,\n      b: 128\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('::placeholder {');\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 169,\n      g: 169,\n      b: 169\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('input:-webkit-autofill,');\n    lines.push('textarea:-webkit-autofill,');\n    lines.push('select:-webkit-autofill {');\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 250,\n      g: 255,\n      b: 189\n    }, theme) + \" !important;\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, theme) + \" !important;\");\n    lines.push('}');\n\n    if (theme.scrollbarColor) {\n      lines.push(getModifiedScrollbarStyle(theme));\n    }\n\n    if (theme.selectionColor) {\n      lines.push(getModifiedSelectionStyle(theme));\n    }\n\n    return lines.join('\\n');\n  }\n\n  function getSelectionColor(theme) {\n    var backgroundColorSelection;\n    var foregroundColorSelection;\n\n    if (theme.selectionColor === 'auto') {\n      backgroundColorSelection = modifyBackgroundColor({\n        r: 0,\n        g: 96,\n        b: 212\n      }, _assign(_assign({}, theme), {\n        grayscale: 0\n      }));\n      foregroundColorSelection = modifyForegroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, _assign(_assign({}, theme), {\n        grayscale: 0\n      }));\n    } else {\n      var rgb = parse(theme.selectionColor);\n      var hsl = rgbToHSL(rgb);\n      backgroundColorSelection = theme.selectionColor;\n\n      if (hsl.l < 0.5) {\n        foregroundColorSelection = '#FFF';\n      } else {\n        foregroundColorSelection = '#000';\n      }\n    }\n\n    return {\n      backgroundColorSelection: backgroundColorSelection,\n      foregroundColorSelection: foregroundColorSelection\n    };\n  }\n\n  function getModifiedSelectionStyle(theme) {\n    var lines = [];\n    var modifiedSelectionColor = getSelectionColor(theme);\n    var backgroundColorSelection = modifiedSelectionColor.backgroundColorSelection;\n    var foregroundColorSelection = modifiedSelectionColor.foregroundColorSelection;\n    ['::selection', '::-moz-selection'].forEach(function (selection) {\n      lines.push(selection + \" {\");\n      lines.push(\"    background-color: \" + backgroundColorSelection + \" !important;\");\n      lines.push(\"    color: \" + foregroundColorSelection + \" !important;\");\n      lines.push('}');\n    });\n    return lines.join('\\n');\n  }\n\n  function getModifiedScrollbarStyle(theme) {\n    var lines = [];\n    var colorTrack;\n    var colorIcons;\n    var colorThumb;\n    var colorThumbHover;\n    var colorThumbActive;\n    var colorCorner;\n\n    if (theme.scrollbarColor === 'auto') {\n      colorTrack = modifyBackgroundColor({\n        r: 241,\n        g: 241,\n        b: 241\n      }, theme);\n      colorIcons = modifyForegroundColor({\n        r: 96,\n        g: 96,\n        b: 96\n      }, theme);\n      colorThumb = modifyBackgroundColor({\n        r: 176,\n        g: 176,\n        b: 176\n      }, theme);\n      colorThumbHover = modifyBackgroundColor({\n        r: 144,\n        g: 144,\n        b: 144\n      }, theme);\n      colorThumbActive = modifyBackgroundColor({\n        r: 96,\n        g: 96,\n        b: 96\n      }, theme);\n      colorCorner = modifyBackgroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, theme);\n    } else {\n      var rgb = parse(theme.scrollbarColor);\n      var hsl_1 = rgbToHSL(rgb);\n      var isLight = hsl_1.l > 0.5;\n\n      var lighten = function lighten(lighter) {\n        return _assign(_assign({}, hsl_1), {\n          l: clamp(hsl_1.l + lighter, 0, 1)\n        });\n      };\n\n      var darken = function darken(darker) {\n        return _assign(_assign({}, hsl_1), {\n          l: clamp(hsl_1.l - darker, 0, 1)\n        });\n      };\n\n      colorTrack = hslToString(darken(0.4));\n      colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\n      colorThumb = hslToString(hsl_1);\n      colorThumbHover = hslToString(lighten(0.1));\n      colorThumbActive = hslToString(lighten(0.2));\n    }\n\n    lines.push('::-webkit-scrollbar {');\n    lines.push(\"    background-color: \" + colorTrack + \";\");\n    lines.push(\"    color: \" + colorIcons + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb {');\n    lines.push(\"    background-color: \" + colorThumb + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb:hover {');\n    lines.push(\"    background-color: \" + colorThumbHover + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb:active {');\n    lines.push(\"    background-color: \" + colorThumbActive + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-corner {');\n    lines.push(\"    background-color: \" + colorCorner + \";\");\n    lines.push('}');\n\n    if (isFirefox) {\n      lines.push('* {');\n      lines.push(\"    scrollbar-color: \" + colorThumb + \" \" + colorTrack + \";\");\n      lines.push('}');\n    }\n\n    return lines.join('\\n');\n  }\n\n  function getModifiedFallbackStyle(filter, _a) {\n    var strict = _a.strict;\n    var lines = [];\n    var isMicrosoft = location.hostname.endsWith('microsoft.com');\n    lines.push(\"html, body, \" + (strict ? \"body :not(iframe)\" + (isMicrosoft ? ':not(div[style^=\"position:absolute;top:0;left:-\"]' : '') : 'body > :not(iframe)') + \" {\");\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 255,\n      g: 255,\n      b: 255\n    }, filter) + \" !important;\");\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 64,\n      g: 64,\n      b: 64\n    }, filter) + \" !important;\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, filter) + \" !important;\");\n    lines.push('}');\n    return lines.join('\\n');\n  }\n\n  var unparsableColors = new Set(['inherit', 'transparent', 'initial', 'currentcolor', 'none', 'unset']);\n  var colorParseCache = new Map();\n\n  function parseColorWithCache($color) {\n    $color = $color.trim();\n\n    if (colorParseCache.has($color)) {\n      return colorParseCache.get($color);\n    }\n\n    if ($color.includes('calc(')) {\n      $color = lowerCalcExpression($color);\n    }\n\n    var color = parse($color);\n    colorParseCache.set($color, color);\n    return color;\n  }\n\n  function tryParseColor($color) {\n    try {\n      return parseColorWithCache($color);\n    } catch (err) {\n      return null;\n    }\n  }\n\n  function getColorModifier(prop, value) {\n    if (unparsableColors.has(value.toLowerCase())) {\n      return value;\n    }\n\n    try {\n      var rgb_1 = parseColorWithCache(value);\n\n      if (prop.includes('background')) {\n        return function (filter) {\n          return modifyBackgroundColor(rgb_1, filter);\n        };\n      }\n\n      if (prop.includes('border') || prop.includes('outline')) {\n        return function (filter) {\n          return modifyBorderColor(rgb_1, filter);\n        };\n      }\n\n      return function (filter) {\n        return modifyForegroundColor(rgb_1, filter);\n      };\n    } catch (err) {\n      logWarn('Color parse error', err);\n      return null;\n    }\n  }\n\n  var gradientRegex = /[\\-a-z]+gradient\\(([^\\(\\)]*(\\(([^\\(\\)]*(\\(.*?\\)))*[^\\(\\)]*\\))){0,15}[^\\(\\)]*\\)/g;\n  var imageDetailsCache = new Map();\n  var awaitingForImageLoading = new Map();\n\n  function shouldIgnoreImage(selectorText, selectors) {\n    if (!selectorText || selectors.length === 0) {\n      return false;\n    }\n\n    if (selectors.some(function (s) {\n      return s === '*';\n    })) {\n      return true;\n    }\n\n    var ruleSelectors = selectorText.split(/,\\s*/g);\n\n    var _loop_1 = function _loop_1(i) {\n      var ignoredSelector = selectors[i];\n\n      if (ruleSelectors.some(function (s) {\n        return s === ignoredSelector;\n      })) {\n        return {\n          value: true\n        };\n      }\n    };\n\n    for (var i = 0; i < selectors.length; i++) {\n      var state_1 = _loop_1(i);\n\n      if (typeof state_1 === \"object\") return state_1.value;\n    }\n\n    return false;\n  }\n\n  function getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled) {\n    var _this = this;\n\n    try {\n      var gradients = getMatches(gradientRegex, value);\n      var urls = getMatches(cssURLRegex, value);\n\n      if (urls.length === 0 && gradients.length === 0) {\n        return value;\n      }\n\n      var getIndices = function getIndices(matches) {\n        var index = 0;\n        return matches.map(function (match) {\n          var valueIndex = value.indexOf(match, index);\n          index = valueIndex + match.length;\n          return {\n            match: match,\n            index: valueIndex\n          };\n        });\n      };\n\n      var matches_1 = getIndices(urls).map(function (i) {\n        return _assign({\n          type: 'url'\n        }, i);\n      }).concat(getIndices(gradients).map(function (i) {\n        return _assign({\n          type: 'gradient'\n        }, i);\n      })).sort(function (a, b) {\n        return a.index - b.index;\n      });\n\n      var getGradientModifier_1 = function getGradientModifier_1(gradient) {\n        var match = gradient.match(/^(.*-gradient)\\((.*)\\)$/);\n        var type = match[1];\n        var content = match[2];\n        var partsRegex = /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?[^\\(\\),]*),?/g;\n        var colorStopRegex = /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\n        var parts = getMatches(partsRegex, content, 1).map(function (part) {\n          part = part.trim();\n          var rgb = tryParseColor(part);\n\n          if (rgb) {\n            return function (filter) {\n              return modifyGradientColor(rgb, filter);\n            };\n          }\n\n          var space = part.lastIndexOf(' ');\n          rgb = tryParseColor(part.substring(0, space));\n\n          if (rgb) {\n            return function (filter) {\n              return modifyGradientColor(rgb, filter) + \" \" + part.substring(space + 1);\n            };\n          }\n\n          var colorStopMatch = part.match(colorStopRegex);\n\n          if (colorStopMatch) {\n            rgb = tryParseColor(colorStopMatch[3]);\n\n            if (rgb) {\n              return function (filter) {\n                return colorStopMatch[1] + \"(\" + (colorStopMatch[2] ? colorStopMatch[2] + \", \" : '') + modifyGradientColor(rgb, filter) + \")\";\n              };\n            }\n          }\n\n          return function () {\n            return part;\n          };\n        });\n        return function (filter) {\n          return type + \"(\" + parts.map(function (modify) {\n            return modify(filter);\n          }).join(', ') + \")\";\n        };\n      };\n\n      var getURLModifier_1 = function getURLModifier_1(urlValue) {\n        var _a;\n\n        if (shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)) {\n          return null;\n        }\n\n        var url = getCSSURLValue(urlValue);\n        var parentStyleSheet = rule.parentStyleSheet;\n        var baseURL = parentStyleSheet && parentStyleSheet.href ? getCSSBaseBath(parentStyleSheet.href) : ((_a = parentStyleSheet.ownerNode) === null || _a === void 0 ? void 0 : _a.baseURI) || location.origin;\n        url = getAbsoluteURL(baseURL, url);\n        var absoluteValue = \"url(\\\"\" + url + \"\\\")\";\n        return function (filter) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var imageDetails, awaiters_1, err_1, bgImageValue;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  if (!imageDetailsCache.has(url)) return [3, 1];\n                  imageDetails = imageDetailsCache.get(url);\n                  return [3, 7];\n\n                case 1:\n                  _a.trys.push([1, 6,, 7]);\n\n                  if (!awaitingForImageLoading.has(url)) return [3, 3];\n                  awaiters_1 = awaitingForImageLoading.get(url);\n                  return [4, new Promise(function (resolve) {\n                    return awaiters_1.push(resolve);\n                  })];\n\n                case 2:\n                  imageDetails = _a.sent();\n\n                  if (!imageDetails) {\n                    return [2, null];\n                  }\n\n                  return [3, 5];\n\n                case 3:\n                  awaitingForImageLoading.set(url, []);\n                  return [4, getImageDetails(url)];\n\n                case 4:\n                  imageDetails = _a.sent();\n                  imageDetailsCache.set(url, imageDetails);\n                  awaitingForImageLoading.get(url).forEach(function (resolve) {\n                    return resolve(imageDetails);\n                  });\n                  awaitingForImageLoading.delete(url);\n                  _a.label = 5;\n\n                case 5:\n                  if (isCancelled()) {\n                    return [2, null];\n                  }\n\n                  return [3, 7];\n\n                case 6:\n                  err_1 = _a.sent();\n                  logWarn(err_1);\n\n                  if (awaitingForImageLoading.has(url)) {\n                    awaitingForImageLoading.get(url).forEach(function (resolve) {\n                      return resolve(null);\n                    });\n                    awaitingForImageLoading.delete(url);\n                  }\n\n                  return [2, absoluteValue];\n\n                case 7:\n                  bgImageValue = getBgImageValue_1(imageDetails, filter) || absoluteValue;\n                  return [2, bgImageValue];\n              }\n            });\n          });\n        };\n      };\n\n      var getBgImageValue_1 = function getBgImageValue_1(imageDetails, filter) {\n        var isDark = imageDetails.isDark,\n            isLight = imageDetails.isLight,\n            isTransparent = imageDetails.isTransparent,\n            isLarge = imageDetails.isLarge,\n            isTooLarge = imageDetails.isTooLarge,\n            width = imageDetails.width;\n        var result;\n\n        if (isTooLarge) {\n          result = \"url(\\\"\" + imageDetails.src + \"\\\")\";\n        } else if (isDark && isTransparent && filter.mode === 1 && !isLarge && width > 2) {\n          logInfo(\"Inverting dark image \" + imageDetails.src);\n          var inverted = getFilteredImageDataURL(imageDetails, _assign(_assign({}, filter), {\n            sepia: clamp(filter.sepia + 10, 0, 100)\n          }));\n          result = \"url(\\\"\" + inverted + \"\\\")\";\n        } else if (isLight && !isTransparent && filter.mode === 1) {\n          if (isLarge) {\n            result = 'none';\n          } else {\n            logInfo(\"Dimming light image \" + imageDetails.src);\n            var dimmed = getFilteredImageDataURL(imageDetails, filter);\n            result = \"url(\\\"\" + dimmed + \"\\\")\";\n          }\n        } else if (filter.mode === 0 && isLight && !isLarge) {\n          logInfo(\"Applying filter to image \" + imageDetails.src);\n          var filtered = getFilteredImageDataURL(imageDetails, _assign(_assign({}, filter), {\n            brightness: clamp(filter.brightness - 10, 5, 200),\n            sepia: clamp(filter.sepia + 10, 0, 100)\n          }));\n          result = \"url(\\\"\" + filtered + \"\\\")\";\n        } else {\n          result = null;\n        }\n\n        return result;\n      };\n\n      var modifiers_1 = [];\n      var index_1 = 0;\n      matches_1.forEach(function (_a, i) {\n        var match = _a.match,\n            type = _a.type,\n            matchStart = _a.index;\n        var prefixStart = index_1;\n        var matchEnd = matchStart + match.length;\n        index_1 = matchEnd;\n        modifiers_1.push(function () {\n          return value.substring(prefixStart, matchStart);\n        });\n        modifiers_1.push(type === 'url' ? getURLModifier_1(match) : getGradientModifier_1(match));\n\n        if (i === matches_1.length - 1) {\n          modifiers_1.push(function () {\n            return value.substring(matchEnd);\n          });\n        }\n      });\n      return function (filter) {\n        var results = modifiers_1.filter(Boolean).map(function (modify) {\n          return modify(filter);\n        });\n\n        if (results.some(function (r) {\n          return r instanceof Promise;\n        })) {\n          return Promise.all(results).then(function (asyncResults) {\n            return asyncResults.join('');\n          });\n        }\n\n        return results.join('');\n      };\n    } catch (err) {\n      logWarn(\"Unable to parse gradient \" + value, err);\n      return null;\n    }\n  }\n\n  function getShadowModifierWithInfo(value) {\n    try {\n      var index_2 = 0;\n      var colorMatches_1 = getMatches(/(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/ig, value, 2);\n      var notParsed_1 = 0;\n      var modifiers_2 = colorMatches_1.map(function (match, i) {\n        var prefixIndex = index_2;\n        var matchIndex = value.indexOf(match, index_2);\n        var matchEnd = matchIndex + match.length;\n        index_2 = matchEnd;\n        var rgb = tryParseColor(match);\n\n        if (!rgb) {\n          notParsed_1++;\n          return function () {\n            return value.substring(prefixIndex, matchEnd);\n          };\n        }\n\n        return function (filter) {\n          return \"\" + value.substring(prefixIndex, matchIndex) + modifyShadowColor(rgb, filter) + (i === colorMatches_1.length - 1 ? value.substring(matchEnd) : '');\n        };\n      });\n      return function (filter) {\n        var modified = modifiers_2.map(function (modify) {\n          return modify(filter);\n        }).join('');\n        return {\n          matchesLength: colorMatches_1.length,\n          unparseableMatchesLength: notParsed_1,\n          result: modified\n        };\n      };\n    } catch (err) {\n      logWarn(\"Unable to parse shadow \" + value, err);\n      return null;\n    }\n  }\n\n  function getShadowModifier(value) {\n    var shadowModifier = getShadowModifierWithInfo(value);\n\n    if (!shadowModifier) {\n      return null;\n    }\n\n    return function (theme) {\n      return shadowModifier(theme).result;\n    };\n  }\n\n  function getVariableModifier(variablesStore, prop, value, rule, ignoredImgSelectors, isCancelled) {\n    return variablesStore.getModifierForVariable({\n      varName: prop,\n      sourceValue: value,\n      rule: rule,\n      ignoredImgSelectors: ignoredImgSelectors,\n      isCancelled: isCancelled\n    });\n  }\n\n  function getVariableDependantModifier(variablesStore, prop, value) {\n    return variablesStore.getModifierForVarDependant(prop, value);\n  }\n\n  function cleanModificationCache() {\n    colorParseCache.clear();\n    clearColorModificationCache();\n    imageDetailsCache.clear();\n    cleanImageProcessingCache();\n    awaitingForImageLoading.clear();\n  }\n\n  var VAR_TYPE_BGCOLOR = 1 << 0;\n  var VAR_TYPE_TEXTCOLOR = 1 << 1;\n  var VAR_TYPE_BORDERCOLOR = 1 << 2;\n  var VAR_TYPE_BGIMG = 1 << 3;\n\n  var VariablesStore = function () {\n    function VariablesStore() {\n      this.varTypes = new Map();\n      this.rulesQueue = [];\n      this.definedVars = new Set();\n      this.varRefs = new Map();\n      this.unknownColorVars = new Set();\n      this.unknownBgVars = new Set();\n      this.undefinedVars = new Set();\n      this.initialVarTypes = new Map();\n      this.changedTypeVars = new Set();\n      this.typeChangeSubscriptions = new Map();\n      this.unstableVarValues = new Map();\n    }\n\n    VariablesStore.prototype.clear = function () {\n      this.varTypes.clear();\n      this.rulesQueue.splice(0);\n      this.definedVars.clear();\n      this.varRefs.clear();\n      this.unknownColorVars.clear();\n      this.unknownBgVars.clear();\n      this.undefinedVars.clear();\n      this.initialVarTypes.clear();\n      this.changedTypeVars.clear();\n      this.typeChangeSubscriptions.clear();\n      this.unstableVarValues.clear();\n    };\n\n    VariablesStore.prototype.isVarType = function (varName, typeNum) {\n      return this.varTypes.has(varName) && (this.varTypes.get(varName) & typeNum) > 0;\n    };\n\n    VariablesStore.prototype.addRulesForMatching = function (rules) {\n      this.rulesQueue.push(rules);\n    };\n\n    VariablesStore.prototype.matchVariablesAndDependants = function () {\n      var _this = this;\n\n      this.changedTypeVars.clear();\n      this.initialVarTypes = new Map(this.varTypes);\n      this.collectRootVariables();\n      this.collectVariablesAndVarDep(this.rulesQueue);\n      this.rulesQueue.splice(0);\n      this.collectRootVarDependants();\n      this.varRefs.forEach(function (refs, v) {\n        refs.forEach(function (r) {\n          if (_this.varTypes.has(v)) {\n            _this.resolveVariableType(r, _this.varTypes.get(v));\n          }\n        });\n      });\n      this.unknownColorVars.forEach(function (v) {\n        if (_this.unknownBgVars.has(v)) {\n          _this.unknownColorVars.delete(v);\n\n          _this.unknownBgVars.delete(v);\n\n          _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\n        } else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR)) {\n          _this.unknownColorVars.delete(v);\n        } else {\n          _this.undefinedVars.add(v);\n        }\n      });\n      this.unknownBgVars.forEach(function (v) {\n        var hasColor = _this.findVarRef(v, function (ref) {\n          return _this.unknownColorVars.has(ref) || _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR);\n        }) != null;\n\n        if (hasColor) {\n          _this.itarateVarRefs(v, function (ref) {\n            _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\n          });\n        } else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\n          _this.unknownBgVars.delete(v);\n        } else {\n          _this.undefinedVars.add(v);\n        }\n      });\n      this.changedTypeVars.forEach(function (varName) {\n        if (_this.typeChangeSubscriptions.has(varName)) {\n          _this.typeChangeSubscriptions.get(varName).forEach(function (callback) {\n            callback();\n          });\n        }\n      });\n      this.changedTypeVars.clear();\n    };\n\n    VariablesStore.prototype.getModifierForVariable = function (options) {\n      var _this = this;\n\n      return function (theme) {\n        var varName = options.varName,\n            sourceValue = options.sourceValue,\n            rule = options.rule,\n            ignoredImgSelectors = options.ignoredImgSelectors,\n            isCancelled = options.isCancelled;\n\n        var getDeclarations = function getDeclarations() {\n          var declarations = [];\n\n          var addModifiedValue = function addModifiedValue(typeNum, varNameWrapper, colorModifier) {\n            if (!_this.isVarType(varName, typeNum)) {\n              return;\n            }\n\n            var property = varNameWrapper(varName);\n            var modifiedValue;\n\n            if (isVarDependant(sourceValue)) {\n              if (isConstructedColorVar(sourceValue)) {\n                var value = insertVarValues(sourceValue, _this.unstableVarValues);\n\n                if (!value) {\n                  value = typeNum === VAR_TYPE_BGCOLOR ? '#ffffff' : '#000000';\n                }\n\n                modifiedValue = colorModifier(value, theme);\n              } else {\n                modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) {\n                  return varNameWrapper(v);\n                }, function (fallback) {\n                  return colorModifier(fallback, theme);\n                });\n              }\n            } else {\n              modifiedValue = colorModifier(sourceValue, theme);\n            }\n\n            declarations.push({\n              property: property,\n              value: modifiedValue\n            });\n          };\n\n          addModifiedValue(VAR_TYPE_BGCOLOR, wrapBgColorVariableName, tryModifyBgColor);\n          addModifiedValue(VAR_TYPE_TEXTCOLOR, wrapTextColorVariableName, tryModifyTextColor);\n          addModifiedValue(VAR_TYPE_BORDERCOLOR, wrapBorderColorVariableName, tryModifyBorderColor);\n\n          if (_this.isVarType(varName, VAR_TYPE_BGIMG)) {\n            var property = wrapBgImgVariableName(varName);\n            var modifiedValue = sourceValue;\n\n            if (isVarDependant(sourceValue)) {\n              modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) {\n                return wrapBgColorVariableName(v);\n              }, function (fallback) {\n                return tryModifyBgColor(fallback, theme);\n              });\n            }\n\n            var bgModifier = getBgImageModifier(modifiedValue, rule, ignoredImgSelectors, isCancelled);\n            modifiedValue = typeof bgModifier === 'function' ? bgModifier(theme) : bgModifier;\n            declarations.push({\n              property: property,\n              value: modifiedValue\n            });\n          }\n\n          return declarations;\n        };\n\n        var callbacks = new Set();\n\n        var addListener = function addListener(onTypeChange) {\n          var callback = function callback() {\n            var decs = getDeclarations();\n            onTypeChange(decs);\n          };\n\n          callbacks.add(callback);\n\n          _this.subscribeForVarTypeChange(varName, callback);\n        };\n\n        var removeListeners = function removeListeners() {\n          callbacks.forEach(function (callback) {\n            _this.unsubscribeFromVariableTypeChanges(varName, callback);\n          });\n        };\n\n        return {\n          declarations: getDeclarations(),\n          onTypeChange: {\n            addListener: addListener,\n            removeListeners: removeListeners\n          }\n        };\n      };\n    };\n\n    VariablesStore.prototype.getModifierForVarDependant = function (property, sourceValue) {\n      var _this = this;\n\n      if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\n        var isBg_1 = property.startsWith('background');\n        var isText_1 = property === 'color' || property === 'caret-color';\n        return function (theme) {\n          var value = insertVarValues(sourceValue, _this.unstableVarValues);\n\n          if (!value) {\n            value = isBg_1 ? '#ffffff' : '#000000';\n          }\n\n          var modifier = isBg_1 ? tryModifyBgColor : isText_1 ? tryModifyTextColor : tryModifyBorderColor;\n          return modifier(value, theme);\n        };\n      }\n\n      if (property === 'background-color') {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapBgColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyBgColor(fallback, theme);\n          });\n        };\n      }\n\n      if (property === 'color' || property === 'caret-color') {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapTextColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyTextColor(fallback, theme);\n          });\n        };\n      }\n\n      if (property === 'background' || property === 'background-image' || property === 'box-shadow') {\n        return function (theme) {\n          var unknownVars = new Set();\n\n          var modify = function modify() {\n            var variableReplaced = replaceCSSVariablesNames(sourceValue, function (v) {\n              if (_this.isVarType(v, VAR_TYPE_BGCOLOR)) {\n                return wrapBgColorVariableName(v);\n              }\n\n              if (_this.isVarType(v, VAR_TYPE_BGIMG)) {\n                return wrapBgImgVariableName(v);\n              }\n\n              unknownVars.add(v);\n              return v;\n            }, function (fallback) {\n              return tryModifyBgColor(fallback, theme);\n            });\n\n            if (property === 'box-shadow') {\n              var shadowModifier = getShadowModifierWithInfo(variableReplaced);\n              var modifiedShadow = shadowModifier(theme);\n\n              if (modifiedShadow.unparseableMatchesLength !== modifiedShadow.matchesLength) {\n                return modifiedShadow.result;\n              }\n            }\n\n            return variableReplaced;\n          };\n\n          var modified = modify();\n\n          if (unknownVars.size > 0) {\n            return new Promise(function (resolve) {\n              var firstUnknownVar = unknownVars.values().next().value;\n\n              var callback = function callback() {\n                _this.unsubscribeFromVariableTypeChanges(firstUnknownVar, callback);\n\n                var newValue = modify();\n                resolve(newValue);\n              };\n\n              _this.subscribeForVarTypeChange(firstUnknownVar, callback);\n            });\n          }\n\n          return modified;\n        };\n      }\n\n      if (property.startsWith('border') || property.startsWith('outline')) {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapBorderColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyBorderColor(fallback, theme);\n          });\n        };\n      }\n\n      return null;\n    };\n\n    VariablesStore.prototype.subscribeForVarTypeChange = function (varName, callback) {\n      if (!this.typeChangeSubscriptions.has(varName)) {\n        this.typeChangeSubscriptions.set(varName, new Set());\n      }\n\n      var rootStore = this.typeChangeSubscriptions.get(varName);\n\n      if (!rootStore.has(callback)) {\n        rootStore.add(callback);\n      }\n    };\n\n    VariablesStore.prototype.unsubscribeFromVariableTypeChanges = function (varName, callback) {\n      if (this.typeChangeSubscriptions.has(varName)) {\n        this.typeChangeSubscriptions.get(varName).delete(callback);\n      }\n    };\n\n    VariablesStore.prototype.collectVariablesAndVarDep = function (ruleList) {\n      var _this = this;\n\n      ruleList.forEach(function (rules) {\n        iterateCSSRules(rules, function (rule) {\n          rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\n            if (isVariable(property)) {\n              _this.inspectVariable(property, value);\n            }\n\n            if (isVarDependant(value)) {\n              _this.inspectVarDependant(property, value);\n            }\n          });\n        });\n      });\n    };\n\n    VariablesStore.prototype.collectRootVariables = function () {\n      var _this = this;\n\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVariable(property)) {\n          _this.inspectVariable(property, value);\n        }\n      });\n    };\n\n    VariablesStore.prototype.inspectVariable = function (varName, value) {\n      this.unstableVarValues.set(varName, value);\n\n      if (isVarDependant(value) && isConstructedColorVar(value)) {\n        this.unknownColorVars.add(varName);\n        this.definedVars.add(varName);\n      }\n\n      if (this.definedVars.has(varName)) {\n        return;\n      }\n\n      this.definedVars.add(varName);\n      var color = tryParseColor(value);\n\n      if (color) {\n        this.unknownColorVars.add(varName);\n      } else if (value.includes('url(') || value.includes('linear-gradient(') || value.includes('radial-gradient(')) {\n        this.resolveVariableType(varName, VAR_TYPE_BGIMG);\n      }\n    };\n\n    VariablesStore.prototype.resolveVariableType = function (varName, typeNum) {\n      var initialType = this.initialVarTypes.get(varName) || 0;\n      var currentType = this.varTypes.get(varName) || 0;\n      var newType = currentType | typeNum;\n      this.varTypes.set(varName, newType);\n\n      if (newType !== initialType || this.undefinedVars.has(varName)) {\n        this.changedTypeVars.add(varName);\n        this.undefinedVars.delete(varName);\n      }\n\n      this.unknownColorVars.delete(varName);\n      this.unknownBgVars.delete(varName);\n    };\n\n    VariablesStore.prototype.collectRootVarDependants = function () {\n      var _this = this;\n\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVarDependant(value)) {\n          _this.inspectVarDependant(property, value);\n        }\n      });\n    };\n\n    VariablesStore.prototype.inspectVarDependant = function (property, value) {\n      var _this = this;\n\n      if (isVariable(property)) {\n        this.iterateVarDeps(value, function (ref) {\n          if (!_this.varRefs.has(property)) {\n            _this.varRefs.set(property, new Set());\n          }\n\n          _this.varRefs.get(property).add(ref);\n        });\n      } else if (property === 'background-color' || property === 'box-shadow') {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\n        });\n      } else if (property === 'color' || property === 'caret-color') {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR);\n        });\n      } else if (property.startsWith('border') || property.startsWith('outline')) {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR);\n        });\n      } else if (property === 'background' || property === 'background-image') {\n        this.iterateVarDeps(value, function (v) {\n          if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\n            return;\n          }\n\n          var isBgColor = _this.findVarRef(v, function (ref) {\n            return _this.unknownColorVars.has(ref) || _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR);\n          }) != null;\n\n          _this.itarateVarRefs(v, function (ref) {\n            if (isBgColor) {\n              _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\n            } else {\n              _this.unknownBgVars.add(ref);\n            }\n          });\n        });\n      }\n    };\n\n    VariablesStore.prototype.iterateVarDeps = function (value, iterator) {\n      var varDeps = new Set();\n      iterateVarDependencies(value, function (v) {\n        return varDeps.add(v);\n      });\n      varDeps.forEach(function (v) {\n        return iterator(v);\n      });\n    };\n\n    VariablesStore.prototype.findVarRef = function (varName, iterator, stack) {\n      var e_1, _a;\n\n      if (stack === void 0) {\n        stack = new Set();\n      }\n\n      if (stack.has(varName)) {\n        return null;\n      }\n\n      stack.add(varName);\n      var result = iterator(varName);\n\n      if (result) {\n        return varName;\n      }\n\n      var refs = this.varRefs.get(varName);\n\n      if (!refs || refs.size === 0) {\n        return null;\n      }\n\n      try {\n        for (var refs_1 = __values(refs), refs_1_1 = refs_1.next(); !refs_1_1.done; refs_1_1 = refs_1.next()) {\n          var ref = refs_1_1.value;\n          var found = this.findVarRef(ref, iterator, stack);\n\n          if (found) {\n            return found;\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (refs_1_1 && !refs_1_1.done && (_a = refs_1.return)) _a.call(refs_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return null;\n    };\n\n    VariablesStore.prototype.itarateVarRefs = function (varName, iterator) {\n      this.findVarRef(varName, function (ref) {\n        iterator(ref);\n        return false;\n      });\n    };\n\n    VariablesStore.prototype.setOnRootVariableChange = function (callback) {\n      this.onRootVariableDefined = callback;\n    };\n\n    VariablesStore.prototype.putRootVars = function (styleElement, theme) {\n      var e_2, _a;\n\n      var _this = this;\n\n      var sheet = styleElement.sheet;\n\n      if (sheet.cssRules.length > 0) {\n        sheet.deleteRule(0);\n      }\n\n      var declarations = new Map();\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVariable(property)) {\n          if (_this.isVarType(property, VAR_TYPE_BGCOLOR)) {\n            declarations.set(wrapBgColorVariableName(property), tryModifyBgColor(value, theme));\n          }\n\n          if (_this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\n            declarations.set(wrapTextColorVariableName(property), tryModifyTextColor(value, theme));\n          }\n\n          if (_this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\n            declarations.set(wrapBorderColorVariableName(property), tryModifyBorderColor(value, theme));\n          }\n\n          _this.subscribeForVarTypeChange(property, _this.onRootVariableDefined);\n        }\n      });\n      var cssLines = [];\n      cssLines.push(':root {');\n\n      try {\n        for (var declarations_1 = __values(declarations), declarations_1_1 = declarations_1.next(); !declarations_1_1.done; declarations_1_1 = declarations_1.next()) {\n          var _b = __read(declarations_1_1.value, 2),\n              property = _b[0],\n              value = _b[1];\n\n          cssLines.push(\"    \" + property + \": \" + value + \";\");\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (declarations_1_1 && !declarations_1_1.done && (_a = declarations_1.return)) _a.call(declarations_1);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      cssLines.push('}');\n      var cssText = cssLines.join('\\n');\n      sheet.insertRule(cssText);\n    };\n\n    return VariablesStore;\n  }();\n\n  var variablesStore = new VariablesStore();\n\n  function getVariableRange(input, searchStart) {\n    if (searchStart === void 0) {\n      searchStart = 0;\n    }\n\n    var start = input.indexOf('var(', searchStart);\n\n    if (start >= 0) {\n      var range = getParenthesesRange(input, start + 3);\n\n      if (range) {\n        return {\n          start: start,\n          end: range.end\n        };\n      }\n\n      return null;\n    }\n  }\n\n  function getVariablesMatches(input) {\n    var ranges = [];\n    var i = 0;\n    var range;\n\n    while (range = getVariableRange(input, i)) {\n      var start = range.start,\n          end = range.end;\n      ranges.push({\n        start: start,\n        end: end,\n        value: input.substring(start, end)\n      });\n      i = range.end + 1;\n    }\n\n    return ranges;\n  }\n\n  function replaceVariablesMatches(input, replacer) {\n    var matches = getVariablesMatches(input);\n    var matchesCount = matches.length;\n\n    if (matchesCount === 0) {\n      return input;\n    }\n\n    var inputLength = input.length;\n    var replacements = matches.map(function (m) {\n      return replacer(m.value);\n    });\n    var parts = [];\n    parts.push(input.substring(0, matches[0].start));\n\n    for (var i = 0; i < matchesCount; i++) {\n      parts.push(replacements[i]);\n      var start = matches[i].end;\n      var end = i < matchesCount - 1 ? matches[i + 1].start : inputLength;\n      parts.push(input.substring(start, end));\n    }\n\n    return parts.join('');\n  }\n\n  function getVariableNameAndFallback(match) {\n    var commaIndex = match.indexOf(',');\n    var name;\n    var fallback;\n\n    if (commaIndex >= 0) {\n      name = match.substring(4, commaIndex).trim();\n      fallback = match.substring(commaIndex + 1, match.length - 1).trim();\n    } else {\n      name = match.substring(4, match.length - 1).trim();\n      fallback = '';\n    }\n\n    return {\n      name: name,\n      fallback: fallback\n    };\n  }\n\n  function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\n    var matchReplacer = function matchReplacer(match) {\n      var _a = getVariableNameAndFallback(match),\n          name = _a.name,\n          fallback = _a.fallback;\n\n      var newName = nameReplacer(name);\n\n      if (!fallback) {\n        return \"var(\" + newName + \")\";\n      }\n\n      var newFallback;\n\n      if (isVarDependant(fallback)) {\n        newFallback = replaceCSSVariablesNames(fallback, nameReplacer, fallbackReplacer);\n      } else if (fallbackReplacer) {\n        newFallback = fallbackReplacer(fallback);\n      } else {\n        newFallback = fallback;\n      }\n\n      return \"var(\" + newName + \", \" + newFallback + \")\";\n    };\n\n    return replaceVariablesMatches(value, matchReplacer);\n  }\n\n  function iterateVarDependencies(value, iterator) {\n    replaceCSSVariablesNames(value, function (varName) {\n      iterator(varName);\n      return varName;\n    });\n  }\n\n  function wrapBgColorVariableName(name) {\n    return \"--darkreader-bg\" + name;\n  }\n\n  function wrapTextColorVariableName(name) {\n    return \"--darkreader-text\" + name;\n  }\n\n  function wrapBorderColorVariableName(name) {\n    return \"--darkreader-border\" + name;\n  }\n\n  function wrapBgImgVariableName(name) {\n    return \"--darkreader-bgimg\" + name;\n  }\n\n  function isVariable(property) {\n    return property.startsWith('--');\n  }\n\n  function isVarDependant(value) {\n    return value.includes('var(');\n  }\n\n  function isConstructedColorVar(value) {\n    return value.match(/^\\s*(rgb|hsl)a?\\(/);\n  }\n\n  var rawValueRegex = /^\\d{1,3}, ?\\d{1,3}, ?\\d{1,3}$/;\n\n  function parseRawValue(color) {\n    if (rawValueRegex.test(color)) {\n      var splitted = color.split(',');\n      var resultInRGB_1 = 'rgb(';\n      splitted.forEach(function (number) {\n        resultInRGB_1 += number.trim() + \", \";\n      });\n      resultInRGB_1 = resultInRGB_1.substr(0, resultInRGB_1.length - 2);\n      resultInRGB_1 += ')';\n      return {\n        isRaw: true,\n        color: resultInRGB_1\n      };\n    }\n\n    return {\n      isRaw: false,\n      color: color\n    };\n  }\n\n  function handleRawValue(color, theme, modifyFunction) {\n    var _a = parseRawValue(color),\n        isRaw = _a.isRaw,\n        newColor = _a.color;\n\n    var rgb = tryParseColor(newColor);\n\n    if (rgb) {\n      var outputColor = modifyFunction(rgb, theme);\n\n      if (isRaw) {\n        var outputInRGB = tryParseColor(outputColor);\n        return outputInRGB ? outputInRGB.r + \", \" + outputInRGB.g + \", \" + outputInRGB.b : outputColor;\n      }\n\n      return outputColor;\n    }\n\n    return newColor;\n  }\n\n  function tryModifyBgColor(color, theme) {\n    return handleRawValue(color, theme, modifyBackgroundColor);\n  }\n\n  function tryModifyTextColor(color, theme) {\n    return handleRawValue(color, theme, modifyForegroundColor);\n  }\n\n  function tryModifyBorderColor(color, theme) {\n    return handleRawValue(color, theme, modifyBorderColor);\n  }\n\n  function insertVarValues(source, varValues, stack) {\n    if (stack === void 0) {\n      stack = new Set();\n    }\n\n    var containsUnresolvedVar = false;\n\n    var matchReplacer = function matchReplacer(match) {\n      var _a = getVariableNameAndFallback(match),\n          name = _a.name,\n          fallback = _a.fallback;\n\n      if (stack.has(name)) {\n        containsUnresolvedVar = true;\n        return null;\n      }\n\n      stack.add(name);\n      var varValue = varValues.get(name) || fallback;\n      var inserted = null;\n\n      if (varValue) {\n        if (isVarDependant(varValue)) {\n          inserted = insertVarValues(varValue, varValues, stack);\n        } else {\n          inserted = varValue;\n        }\n      }\n\n      if (!inserted) {\n        containsUnresolvedVar = true;\n        return null;\n      }\n\n      return inserted;\n    };\n\n    var replaced = replaceVariablesMatches(source, matchReplacer);\n\n    if (containsUnresolvedVar) {\n      return null;\n    }\n\n    return replaced;\n  }\n\n  var overrides = {\n    'background-color': {\n      customProp: '--darkreader-inline-bgcolor',\n      cssProp: 'background-color',\n      dataAttr: 'data-darkreader-inline-bgcolor'\n    },\n    'background-image': {\n      customProp: '--darkreader-inline-bgimage',\n      cssProp: 'background-image',\n      dataAttr: 'data-darkreader-inline-bgimage'\n    },\n    'border-color': {\n      customProp: '--darkreader-inline-border',\n      cssProp: 'border-color',\n      dataAttr: 'data-darkreader-inline-border'\n    },\n    'border-bottom-color': {\n      customProp: '--darkreader-inline-border-bottom',\n      cssProp: 'border-bottom-color',\n      dataAttr: 'data-darkreader-inline-border-bottom'\n    },\n    'border-left-color': {\n      customProp: '--darkreader-inline-border-left',\n      cssProp: 'border-left-color',\n      dataAttr: 'data-darkreader-inline-border-left'\n    },\n    'border-right-color': {\n      customProp: '--darkreader-inline-border-right',\n      cssProp: 'border-right-color',\n      dataAttr: 'data-darkreader-inline-border-right'\n    },\n    'border-top-color': {\n      customProp: '--darkreader-inline-border-top',\n      cssProp: 'border-top-color',\n      dataAttr: 'data-darkreader-inline-border-top'\n    },\n    'box-shadow': {\n      customProp: '--darkreader-inline-boxshadow',\n      cssProp: 'box-shadow',\n      dataAttr: 'data-darkreader-inline-boxshadow'\n    },\n    'color': {\n      customProp: '--darkreader-inline-color',\n      cssProp: 'color',\n      dataAttr: 'data-darkreader-inline-color'\n    },\n    'fill': {\n      customProp: '--darkreader-inline-fill',\n      cssProp: 'fill',\n      dataAttr: 'data-darkreader-inline-fill'\n    },\n    'stroke': {\n      customProp: '--darkreader-inline-stroke',\n      cssProp: 'stroke',\n      dataAttr: 'data-darkreader-inline-stroke'\n    },\n    'outline-color': {\n      customProp: '--darkreader-inline-outline',\n      cssProp: 'outline-color',\n      dataAttr: 'data-darkreader-inline-outline'\n    },\n    'stop-color': {\n      customProp: '--darkreader-inline-stopcolor',\n      cssProp: 'stop-color',\n      dataAttr: 'data-darkreader-inline-stopcolor'\n    }\n  };\n  var overridesList = Object.values(overrides);\n  var normalizedPropList = {};\n  overridesList.forEach(function (_a) {\n    var cssProp = _a.cssProp,\n        customProp = _a.customProp;\n    return normalizedPropList[customProp] = cssProp;\n  });\n  var INLINE_STYLE_ATTRS = ['style', 'fill', 'stop-color', 'stroke', 'bgcolor', 'color'];\n  var INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(function (attr) {\n    return \"[\" + attr + \"]\";\n  }).join(', ');\n\n  function getInlineOverrideStyle() {\n    return overridesList.map(function (_a) {\n      var dataAttr = _a.dataAttr,\n          customProp = _a.customProp,\n          cssProp = _a.cssProp;\n      return [\"[\" + dataAttr + \"] {\", \"  \" + cssProp + \": var(\" + customProp + \") !important;\", '}'].join('\\n');\n    }).join('\\n');\n  }\n\n  function getInlineStyleElements(root) {\n    var results = [];\n\n    if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\n      results.push(root);\n    }\n\n    if (root instanceof Element || isShadowDomSupported && root instanceof ShadowRoot || root instanceof Document) {\n      push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\n    }\n\n    return results;\n  }\n\n  var treeObservers = new Map();\n  var attrObservers = new Map();\n\n  function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\n    deepWatchForInlineStyles(document, elementStyleDidChange, shadowRootDiscovered);\n    iterateShadowHosts(document.documentElement, function (host) {\n      deepWatchForInlineStyles(host.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\n    });\n  }\n\n  function deepWatchForInlineStyles(root, elementStyleDidChange, shadowRootDiscovered) {\n    if (treeObservers.has(root)) {\n      treeObservers.get(root).disconnect();\n      attrObservers.get(root).disconnect();\n    }\n\n    var discoveredNodes = new WeakSet();\n\n    function discoverNodes(node) {\n      getInlineStyleElements(node).forEach(function (el) {\n        if (discoveredNodes.has(el)) {\n          return;\n        }\n\n        discoveredNodes.add(el);\n        elementStyleDidChange(el);\n      });\n      iterateShadowHosts(node, function (n) {\n        if (discoveredNodes.has(node)) {\n          return;\n        }\n\n        discoveredNodes.add(node);\n        shadowRootDiscovered(n.shadowRoot);\n        deepWatchForInlineStyles(n.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\n      });\n    }\n\n    var treeObserver = createOptimizedTreeObserver(root, {\n      onMinorMutations: function onMinorMutations(_a) {\n        var additions = _a.additions;\n        additions.forEach(function (added) {\n          return discoverNodes(added);\n        });\n      },\n      onHugeMutations: function onHugeMutations() {\n        discoverNodes(root);\n      }\n    });\n    treeObservers.set(root, treeObserver);\n    var attemptCount = 0;\n    var start = null;\n    var ATTEMPTS_INTERVAL = getDuration({\n      seconds: 10\n    });\n    var RETRY_TIMEOUT = getDuration({\n      seconds: 2\n    });\n    var MAX_ATTEMPTS_COUNT = 50;\n    var cache = [];\n    var timeoutId = null;\n    var handleAttributeMutations = throttle(function (mutations) {\n      mutations.forEach(function (m) {\n        if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\n          elementStyleDidChange(m.target);\n        }\n      });\n    });\n    var attrObserver = new MutationObserver(function (mutations) {\n      if (timeoutId) {\n        cache.push.apply(cache, __spreadArray([], __read(mutations), false));\n        return;\n      }\n\n      attemptCount++;\n      var now = Date.now();\n\n      if (start == null) {\n        start = now;\n      } else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\n        if (now - start < ATTEMPTS_INTERVAL) {\n          timeoutId = setTimeout(function () {\n            start = null;\n            attemptCount = 0;\n            timeoutId = null;\n            var attributeCache = cache;\n            cache = [];\n            handleAttributeMutations(attributeCache);\n          }, RETRY_TIMEOUT);\n          cache.push.apply(cache, __spreadArray([], __read(mutations), false));\n          return;\n        }\n\n        start = now;\n        attemptCount = 1;\n      }\n\n      handleAttributeMutations(mutations);\n    });\n    attrObserver.observe(root, {\n      attributes: true,\n      attributeFilter: INLINE_STYLE_ATTRS.concat(overridesList.map(function (_a) {\n        var dataAttr = _a.dataAttr;\n        return dataAttr;\n      })),\n      subtree: true\n    });\n    attrObservers.set(root, attrObserver);\n  }\n\n  function stopWatchingForInlineStyles() {\n    treeObservers.forEach(function (o) {\n      return o.disconnect();\n    });\n    attrObservers.forEach(function (o) {\n      return o.disconnect();\n    });\n    treeObservers.clear();\n    attrObservers.clear();\n  }\n\n  var inlineStyleCache = new WeakMap();\n  var filterProps = ['brightness', 'contrast', 'grayscale', 'sepia', 'mode'];\n\n  function getInlineStyleCacheKey(el, theme) {\n    return INLINE_STYLE_ATTRS.map(function (attr) {\n      return attr + \"=\\\"\" + el.getAttribute(attr) + \"\\\"\";\n    }).concat(filterProps.map(function (prop) {\n      return prop + \"=\\\"\" + theme[prop] + \"\\\"\";\n    })).join(' ');\n  }\n\n  function shouldIgnoreInlineStyle(element, selectors) {\n    for (var i = 0, len = selectors.length; i < len; i++) {\n      var ingnoredSelector = selectors[i];\n\n      if (element.matches(ingnoredSelector)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function overrideInlineStyle(element, theme, ignoreInlineSelectors, ignoreImageSelectors) {\n    var cacheKey = getInlineStyleCacheKey(element, theme);\n\n    if (cacheKey === inlineStyleCache.get(element)) {\n      return;\n    }\n\n    var unsetProps = new Set(Object.keys(overrides));\n\n    function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\n      var _a = overrides[targetCSSProp],\n          customProp = _a.customProp,\n          dataAttr = _a.dataAttr;\n      var mod = getModifiableCSSDeclaration(modifierCSSProp, cssVal, {}, variablesStore, ignoreImageSelectors, null);\n\n      if (!mod) {\n        return;\n      }\n\n      var value = mod.value;\n\n      if (typeof value === 'function') {\n        value = value(theme);\n      }\n\n      element.style.setProperty(customProp, value);\n\n      if (!element.hasAttribute(dataAttr)) {\n        element.setAttribute(dataAttr, '');\n      }\n\n      unsetProps.delete(targetCSSProp);\n    }\n\n    if (ignoreInlineSelectors.length > 0) {\n      if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\n        unsetProps.forEach(function (cssProp) {\n          element.removeAttribute(overrides[cssProp].dataAttr);\n        });\n        return;\n      }\n    }\n\n    if (element.hasAttribute('bgcolor')) {\n      var value = element.getAttribute('bgcolor');\n\n      if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\n        value = \"#\" + value;\n      }\n\n      setCustomProp('background-color', 'background-color', value);\n    }\n\n    if (element.hasAttribute('color') && element.rel !== 'mask-icon') {\n      var value = element.getAttribute('color');\n\n      if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\n        value = \"#\" + value;\n      }\n\n      setCustomProp('color', 'color', value);\n    }\n\n    if (element instanceof SVGElement) {\n      if (element.hasAttribute('fill')) {\n        var SMALL_SVG_LIMIT_1 = 32;\n        var value_1 = element.getAttribute('fill');\n\n        if (value_1 !== 'none') {\n          if (!(element instanceof SVGTextElement)) {\n            var handleSVGElement = function handleSVGElement() {\n              var _a = element.getBoundingClientRect(),\n                  width = _a.width,\n                  height = _a.height;\n\n              var isBg = width > SMALL_SVG_LIMIT_1 || height > SMALL_SVG_LIMIT_1;\n              setCustomProp('fill', isBg ? 'background-color' : 'color', value_1);\n            };\n\n            if (isReadyStateComplete()) {\n              handleSVGElement();\n            } else {\n              addReadyStateCompleteListener(handleSVGElement);\n            }\n          } else {\n            setCustomProp('fill', 'color', value_1);\n          }\n        }\n      }\n\n      if (element.hasAttribute('stop-color')) {\n        setCustomProp('stop-color', 'background-color', element.getAttribute('stop-color'));\n      }\n    }\n\n    if (element.hasAttribute('stroke')) {\n      var value = element.getAttribute('stroke');\n      setCustomProp('stroke', element instanceof SVGLineElement || element instanceof SVGTextElement ? 'border-color' : 'color', value);\n    }\n\n    element.style && iterateCSSDeclarations(element.style, function (property, value) {\n      if (property === 'background-image' && value.includes('url')) {\n        return;\n      }\n\n      if (overrides.hasOwnProperty(property)) {\n        setCustomProp(property, property, value);\n      } else {\n        var overridenProp = normalizedPropList[property];\n\n        if (overridenProp && !element.style.getPropertyValue(overridenProp) && !element.hasAttribute(overridenProp)) {\n          if (overridenProp === 'background-color' && element.hasAttribute('bgcolor')) {\n            return;\n          }\n\n          element.style.setProperty(property, '');\n        }\n      }\n    });\n\n    if (element.style && element instanceof SVGTextElement && element.style.fill) {\n      setCustomProp('fill', 'color', element.style.getPropertyValue('fill'));\n    }\n\n    forEach(unsetProps, function (cssProp) {\n      element.removeAttribute(overrides[cssProp].dataAttr);\n    });\n    inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\n  }\n\n  var metaThemeColorName = 'theme-color';\n  var metaThemeColorSelector = \"meta[name=\\\"\" + metaThemeColorName + \"\\\"]\";\n  var srcMetaThemeColor = null;\n  var observer = null;\n\n  function changeMetaThemeColor(meta, theme) {\n    srcMetaThemeColor = srcMetaThemeColor || meta.content;\n\n    try {\n      var color = parse(srcMetaThemeColor);\n      meta.content = modifyBackgroundColor(color, theme);\n    } catch (err) {\n      logWarn(err);\n    }\n  }\n\n  function changeMetaThemeColorWhenAvailable(theme) {\n    var meta = document.querySelector(metaThemeColorSelector);\n\n    if (meta) {\n      changeMetaThemeColor(meta, theme);\n    } else {\n      if (observer) {\n        observer.disconnect();\n      }\n\n      observer = new MutationObserver(function (mutations) {\n        loop: for (var i = 0; i < mutations.length; i++) {\n          var addedNodes = mutations[i].addedNodes;\n\n          for (var j = 0; j < addedNodes.length; j++) {\n            var node = addedNodes[j];\n\n            if (node instanceof HTMLMetaElement && node.name === metaThemeColorName) {\n              observer.disconnect();\n              observer = null;\n              changeMetaThemeColor(node, theme);\n              break loop;\n            }\n          }\n        }\n      });\n      observer.observe(document.head, {\n        childList: true\n      });\n    }\n  }\n\n  function restoreMetaThemeColor() {\n    if (observer) {\n      observer.disconnect();\n      observer = null;\n    }\n\n    var meta = document.querySelector(metaThemeColorSelector);\n\n    if (meta && srcMetaThemeColor) {\n      meta.content = srcMetaThemeColor;\n    }\n  }\n\n  var themeCacheKeys = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\n\n  function getThemeKey(theme) {\n    return themeCacheKeys.map(function (p) {\n      return p + \":\" + theme[p];\n    }).join(';');\n  }\n\n  var asyncQueue = createAsyncTasksQueue();\n\n  function createStyleSheetModifier() {\n    var renderId = 0;\n    var rulesTextCache = new Set();\n    var rulesModCache = new Map();\n    var varTypeChangeCleaners = new Set();\n    var prevFilterKey = null;\n    var hasNonLoadedLink = false;\n    var wasRebuilt = false;\n\n    function shouldRebuildStyle() {\n      return hasNonLoadedLink && !wasRebuilt;\n    }\n\n    function modifySheet(options) {\n      var rules = options.sourceCSSRules;\n      var theme = options.theme,\n          ignoreImageAnalysis = options.ignoreImageAnalysis,\n          force = options.force,\n          prepareSheet = options.prepareSheet,\n          isAsyncCancelled = options.isAsyncCancelled;\n      var rulesChanged = rulesModCache.size === 0;\n      var notFoundCacheKeys = new Set(rulesModCache.keys());\n      var themeKey = getThemeKey(theme);\n      var themeChanged = themeKey !== prevFilterKey;\n\n      if (hasNonLoadedLink) {\n        wasRebuilt = true;\n      }\n\n      var modRules = [];\n      iterateCSSRules(rules, function (rule) {\n        var cssText = rule.cssText;\n        var textDiffersFromPrev = false;\n        notFoundCacheKeys.delete(cssText);\n\n        if (rule.parentRule instanceof CSSMediaRule) {\n          cssText += \";\" + rule.parentRule.media.mediaText;\n        }\n\n        if (!rulesTextCache.has(cssText)) {\n          rulesTextCache.add(cssText);\n          textDiffersFromPrev = true;\n        }\n\n        if (textDiffersFromPrev) {\n          rulesChanged = true;\n        } else {\n          modRules.push(rulesModCache.get(cssText));\n          return;\n        }\n\n        var modDecs = [];\n        rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\n          var mod = getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageAnalysis, isAsyncCancelled);\n\n          if (mod) {\n            modDecs.push(mod);\n          }\n        });\n        var modRule = null;\n\n        if (modDecs.length > 0) {\n          var parentRule = rule.parentRule;\n          modRule = {\n            selector: rule.selectorText,\n            declarations: modDecs,\n            parentRule: parentRule\n          };\n          modRules.push(modRule);\n        }\n\n        rulesModCache.set(cssText, modRule);\n      }, function () {\n        hasNonLoadedLink = true;\n      });\n      notFoundCacheKeys.forEach(function (key) {\n        rulesTextCache.delete(key);\n        rulesModCache.delete(key);\n      });\n      prevFilterKey = themeKey;\n\n      if (!force && !rulesChanged && !themeChanged) {\n        return;\n      }\n\n      renderId++;\n\n      function setRule(target, index, rule) {\n        var selector = rule.selector,\n            declarations = rule.declarations;\n\n        var getDeclarationText = function getDeclarationText(dec) {\n          var property = dec.property,\n              value = dec.value,\n              important = dec.important,\n              sourceValue = dec.sourceValue;\n          return property + \": \" + (value == null ? sourceValue : value) + (important ? ' !important' : '') + \";\";\n        };\n\n        var cssRulesText = '';\n        declarations.forEach(function (declarations) {\n          cssRulesText += getDeclarationText(declarations) + \" \";\n        });\n        var ruleText = selector + \" { \" + cssRulesText + \" }\";\n        target.insertRule(ruleText, index);\n      }\n\n      var asyncDeclarations = new Map();\n      var varDeclarations = new Map();\n      var asyncDeclarationCounter = 0;\n      var varDeclarationCounter = 0;\n      var rootReadyGroup = {\n        rule: null,\n        rules: [],\n        isGroup: true\n      };\n      var groupRefs = new WeakMap();\n\n      function getGroup(rule) {\n        if (rule == null) {\n          return rootReadyGroup;\n        }\n\n        if (groupRefs.has(rule)) {\n          return groupRefs.get(rule);\n        }\n\n        var group = {\n          rule: rule,\n          rules: [],\n          isGroup: true\n        };\n        groupRefs.set(rule, group);\n        var parentGroup = getGroup(rule.parentRule);\n        parentGroup.rules.push(group);\n        return group;\n      }\n\n      varTypeChangeCleaners.forEach(function (clear) {\n        return clear();\n      });\n      varTypeChangeCleaners.clear();\n      modRules.filter(function (r) {\n        return r;\n      }).forEach(function (_a) {\n        var selector = _a.selector,\n            declarations = _a.declarations,\n            parentRule = _a.parentRule;\n        var group = getGroup(parentRule);\n        var readyStyleRule = {\n          selector: selector,\n          declarations: [],\n          isGroup: false\n        };\n        var readyDeclarations = readyStyleRule.declarations;\n        group.rules.push(readyStyleRule);\n\n        function handleAsyncDeclaration(property, modified, important, sourceValue) {\n          var asyncKey = ++asyncDeclarationCounter;\n          var asyncDeclaration = {\n            property: property,\n            value: null,\n            important: important,\n            asyncKey: asyncKey,\n            sourceValue: sourceValue\n          };\n          readyDeclarations.push(asyncDeclaration);\n          var currentRenderId = renderId;\n          modified.then(function (asyncValue) {\n            if (!asyncValue || isAsyncCancelled() || currentRenderId !== renderId) {\n              return;\n            }\n\n            asyncDeclaration.value = asyncValue;\n            asyncQueue.add(function () {\n              if (isAsyncCancelled() || currentRenderId !== renderId) {\n                return;\n              }\n\n              rebuildAsyncRule(asyncKey);\n            });\n          });\n        }\n\n        function handleVarDeclarations(property, modified, important, sourceValue) {\n          var _a = modified,\n              varDecs = _a.declarations,\n              onTypeChange = _a.onTypeChange;\n          var varKey = ++varDeclarationCounter;\n          var currentRenderId = renderId;\n          var initialIndex = readyDeclarations.length;\n          var oldDecs = [];\n\n          if (varDecs.length === 0) {\n            var tempDec = {\n              property: property,\n              value: sourceValue,\n              important: important,\n              sourceValue: sourceValue,\n              varKey: varKey\n            };\n            readyDeclarations.push(tempDec);\n            oldDecs = [tempDec];\n          }\n\n          varDecs.forEach(function (mod) {\n            if (mod.value instanceof Promise) {\n              handleAsyncDeclaration(mod.property, mod.value, important, sourceValue);\n            } else {\n              var readyDec = {\n                property: mod.property,\n                value: mod.value,\n                important: important,\n                sourceValue: sourceValue,\n                varKey: varKey\n              };\n              readyDeclarations.push(readyDec);\n              oldDecs.push(readyDec);\n            }\n          });\n          onTypeChange.addListener(function (newDecs) {\n            if (isAsyncCancelled() || currentRenderId !== renderId) {\n              return;\n            }\n\n            var readyVarDecs = newDecs.map(function (mod) {\n              return {\n                property: mod.property,\n                value: mod.value,\n                important: important,\n                sourceValue: sourceValue,\n                varKey: varKey\n              };\n            });\n            var index = readyDeclarations.indexOf(oldDecs[0], initialIndex);\n            readyDeclarations.splice.apply(readyDeclarations, __spreadArray([index, oldDecs.length], __read(readyVarDecs), false));\n            oldDecs = readyVarDecs;\n            rebuildVarRule(varKey);\n          });\n          varTypeChangeCleaners.add(function () {\n            return onTypeChange.removeListeners();\n          });\n        }\n\n        declarations.forEach(function (_a) {\n          var property = _a.property,\n              value = _a.value,\n              important = _a.important,\n              sourceValue = _a.sourceValue;\n\n          if (typeof value === 'function') {\n            var modified = value(theme);\n\n            if (modified instanceof Promise) {\n              handleAsyncDeclaration(property, modified, important, sourceValue);\n            } else if (property.startsWith('--')) {\n              handleVarDeclarations(property, modified, important, sourceValue);\n            } else {\n              readyDeclarations.push({\n                property: property,\n                value: modified,\n                important: important,\n                sourceValue: sourceValue\n              });\n            }\n          } else {\n            readyDeclarations.push({\n              property: property,\n              value: value,\n              important: important,\n              sourceValue: sourceValue\n            });\n          }\n        });\n      });\n      var sheet = prepareSheet();\n\n      function buildStyleSheet() {\n        function createTarget(group, parent) {\n          var rule = group.rule;\n\n          if (rule instanceof CSSMediaRule) {\n            var media = rule.media;\n            var index = parent.cssRules.length;\n            parent.insertRule(\"@media \" + media.mediaText + \" {}\", index);\n            return parent.cssRules[index];\n          }\n\n          return parent;\n        }\n\n        function iterateReadyRules(group, target, styleIterator) {\n          group.rules.forEach(function (r) {\n            if (r.isGroup) {\n              var t = createTarget(r, target);\n              iterateReadyRules(r, t, styleIterator);\n            } else {\n              styleIterator(r, target);\n            }\n          });\n        }\n\n        iterateReadyRules(rootReadyGroup, sheet, function (rule, target) {\n          var index = target.cssRules.length;\n          rule.declarations.forEach(function (_a) {\n            var asyncKey = _a.asyncKey,\n                varKey = _a.varKey;\n\n            if (asyncKey != null) {\n              asyncDeclarations.set(asyncKey, {\n                rule: rule,\n                target: target,\n                index: index\n              });\n            }\n\n            if (varKey != null) {\n              varDeclarations.set(varKey, {\n                rule: rule,\n                target: target,\n                index: index\n              });\n            }\n          });\n          setRule(target, index, rule);\n        });\n      }\n\n      function rebuildAsyncRule(key) {\n        var _a = asyncDeclarations.get(key),\n            rule = _a.rule,\n            target = _a.target,\n            index = _a.index;\n\n        target.deleteRule(index);\n        setRule(target, index, rule);\n        asyncDeclarations.delete(key);\n      }\n\n      function rebuildVarRule(key) {\n        var _a = varDeclarations.get(key),\n            rule = _a.rule,\n            target = _a.target,\n            index = _a.index;\n\n        target.deleteRule(index);\n        setRule(target, index, rule);\n      }\n\n      buildStyleSheet();\n    }\n\n    return {\n      modifySheet: modifySheet,\n      shouldRebuildStyle: shouldRebuildStyle\n    };\n  }\n\n  var STYLE_SELECTOR = 'style, link[rel*=\"stylesheet\" i]:not([disabled])';\n\n  function shouldManageStyle(element) {\n    return (element instanceof HTMLStyleElement || element instanceof SVGStyleElement || element instanceof HTMLLinkElement && element.rel && element.rel.toLowerCase().includes('stylesheet') && !element.disabled && (isFirefox ? !element.href.startsWith('moz-extension://') : true)) && !element.classList.contains('darkreader') && element.media.toLowerCase() !== 'print' && !element.classList.contains('stylus');\n  }\n\n  function getManageableStyles(node, results, deep) {\n    if (results === void 0) {\n      results = [];\n    }\n\n    if (deep === void 0) {\n      deep = true;\n    }\n\n    if (shouldManageStyle(node)) {\n      results.push(node);\n    } else if (node instanceof Element || isShadowDomSupported && node instanceof ShadowRoot || node === document) {\n      forEach(node.querySelectorAll(STYLE_SELECTOR), function (style) {\n        return getManageableStyles(style, results, false);\n      });\n\n      if (deep) {\n        iterateShadowHosts(node, function (host) {\n          return getManageableStyles(host.shadowRoot, results, false);\n        });\n      }\n    }\n\n    return results;\n  }\n\n  var syncStyleSet = new WeakSet();\n  var corsStyleSet = new WeakSet();\n  var canOptimizeUsingProxy$1 = false;\n\n  if (typeof document !== 'undefined') {\n    document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\n      canOptimizeUsingProxy$1 = true;\n    });\n  }\n\n  var loadingLinkCounter = 0;\n  var rejectorsForLoadingLinks = new Map();\n\n  function cleanLoadingLinks() {\n    rejectorsForLoadingLinks.clear();\n  }\n\n  function manageStyle(element, _a) {\n    var update = _a.update,\n        loadingStart = _a.loadingStart,\n        loadingEnd = _a.loadingEnd;\n    var prevStyles = [];\n    var next = element;\n\n    while ((next = next.nextElementSibling) && next.matches('.darkreader')) {\n      prevStyles.push(next);\n    }\n\n    var corsCopy = prevStyles.find(function (el) {\n      return el.matches('.darkreader--cors') && !corsStyleSet.has(el);\n    }) || null;\n    var syncStyle = prevStyles.find(function (el) {\n      return el.matches('.darkreader--sync') && !syncStyleSet.has(el);\n    }) || null;\n    var corsCopyPositionWatcher = null;\n    var syncStylePositionWatcher = null;\n    var cancelAsyncOperations = false;\n    var isOverrideEmpty = true;\n    var sheetModifier = createStyleSheetModifier();\n    var observer = new MutationObserver(function () {\n      update();\n    });\n    var observerOptions = {\n      attributes: true,\n      childList: true,\n      subtree: true,\n      characterData: true\n    };\n\n    function containsCSSImport() {\n      return element instanceof HTMLStyleElement && element.textContent.trim().match(cssImportRegex);\n    }\n\n    function hasImports(cssRules, checkCrossOrigin) {\n      var result = false;\n\n      if (cssRules) {\n        var rule = void 0;\n\n        cssRulesLoop: for (var i = 0, len = cssRules.length; i < len; i++) {\n          rule = cssRules[i];\n\n          if (rule.href) {\n            if (checkCrossOrigin) {\n              if (rule.href.startsWith('http') && !rule.href.startsWith(location.origin)) {\n                result = true;\n                break cssRulesLoop;\n              }\n            } else {\n              result = true;\n              break cssRulesLoop;\n            }\n          }\n        }\n      }\n\n      return result;\n    }\n\n    function getRulesSync() {\n      if (corsCopy) {\n        logInfo('[getRulesSync] Using cors-copy.');\n        return corsCopy.sheet.cssRules;\n      }\n\n      if (containsCSSImport()) {\n        logInfo('[getRulesSync] CSSImport detected.');\n        return null;\n      }\n\n      var cssRules = safeGetSheetRules();\n\n      if (element instanceof HTMLLinkElement && !isRelativeHrefOnAbsolutePath(element.href) && hasImports(cssRules, false)) {\n        logInfo('[getRulesSync] CSSImportRule detected on non-local href.');\n        return null;\n      }\n\n      if (hasImports(cssRules, true)) {\n        logInfo('[getRulesSync] Cross-Origin CSSImportRule detected.');\n        return null;\n      }\n\n      logInfo('[getRulesSync] Using cssRules.');\n      !cssRules && logWarn('[getRulesSync] cssRules is null, trying again.');\n      return cssRules;\n    }\n\n    function insertStyle() {\n      if (corsCopy) {\n        if (element.nextSibling !== corsCopy) {\n          element.parentNode.insertBefore(corsCopy, element.nextSibling);\n        }\n\n        if (corsCopy.nextSibling !== syncStyle) {\n          element.parentNode.insertBefore(syncStyle, corsCopy.nextSibling);\n        }\n      } else if (element.nextSibling !== syncStyle) {\n        element.parentNode.insertBefore(syncStyle, element.nextSibling);\n      }\n    }\n\n    function createSyncStyle() {\n      syncStyle = element instanceof SVGStyleElement ? document.createElementNS('http://www.w3.org/2000/svg', 'style') : document.createElement('style');\n      syncStyle.classList.add('darkreader');\n      syncStyle.classList.add('darkreader--sync');\n      syncStyle.media = 'screen';\n\n      if (!isChromium && element.title) {\n        syncStyle.title = element.title;\n      }\n\n      syncStyleSet.add(syncStyle);\n    }\n\n    var isLoadingRules = false;\n    var wasLoadingError = false;\n    var loadingLinkId = ++loadingLinkCounter;\n\n    function getRulesAsync() {\n      return __awaiter(this, void 0, void 0, function () {\n        var cssText, cssBasePath, _a, cssRules, accessError, err_1, fullCSSText, err_2;\n\n        var _b;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              if (!(element instanceof HTMLLinkElement)) return [3, 7];\n              _a = __read(getRulesOrError(), 2), cssRules = _a[0], accessError = _a[1];\n\n              if (accessError) {\n                logWarn(accessError);\n              }\n\n              if (!(!cssRules && !accessError && !isSafari || isSafari && !element.sheet || isStillLoadingError(accessError))) return [3, 5];\n              _c.label = 1;\n\n            case 1:\n              _c.trys.push([1, 3,, 4]);\n\n              logInfo(\"Linkelement \" + loadingLinkId + \" is not loaded yet and thus will be await for\", element);\n              return [4, linkLoading(element, loadingLinkId)];\n\n            case 2:\n              _c.sent();\n\n              return [3, 4];\n\n            case 3:\n              err_1 = _c.sent();\n              logWarn(err_1);\n              wasLoadingError = true;\n              return [3, 4];\n\n            case 4:\n              if (cancelAsyncOperations) {\n                return [2, null];\n              }\n\n              _b = __read(getRulesOrError(), 2), cssRules = _b[0], accessError = _b[1];\n\n              if (accessError) {\n                logWarn(accessError);\n              }\n\n              _c.label = 5;\n\n            case 5:\n              if (cssRules) {\n                if (!hasImports(cssRules, false)) {\n                  return [2, cssRules];\n                }\n              }\n\n              return [4, loadText(element.href)];\n\n            case 6:\n              cssText = _c.sent();\n              cssBasePath = getCSSBaseBath(element.href);\n\n              if (cancelAsyncOperations) {\n                return [2, null];\n              }\n\n              return [3, 8];\n\n            case 7:\n              if (containsCSSImport()) {\n                cssText = element.textContent.trim();\n                cssBasePath = getCSSBaseBath(location.href);\n              } else {\n                return [2, null];\n              }\n\n              _c.label = 8;\n\n            case 8:\n              if (!cssText) return [3, 13];\n              _c.label = 9;\n\n            case 9:\n              _c.trys.push([9, 11,, 12]);\n\n              return [4, replaceCSSImports(cssText, cssBasePath)];\n\n            case 10:\n              fullCSSText = _c.sent();\n              corsCopy = createCORSCopy(element, fullCSSText);\n              return [3, 12];\n\n            case 11:\n              err_2 = _c.sent();\n              logWarn(err_2);\n              return [3, 12];\n\n            case 12:\n              if (corsCopy) {\n                corsCopyPositionWatcher = watchForNodePosition(corsCopy, 'prev-sibling');\n                return [2, corsCopy.sheet.cssRules];\n              }\n\n              _c.label = 13;\n\n            case 13:\n              return [2, null];\n          }\n        });\n      });\n    }\n\n    function details(options) {\n      var rules = getRulesSync();\n\n      if (!rules) {\n        if (options.secondRound) {\n          logWarn('Detected dead-lock at details(), returning early to prevent it.');\n          return null;\n        }\n\n        if (isLoadingRules || wasLoadingError) {\n          return null;\n        }\n\n        isLoadingRules = true;\n        loadingStart();\n        getRulesAsync().then(function (results) {\n          isLoadingRules = false;\n          loadingEnd();\n\n          if (results) {\n            update();\n          }\n        }).catch(function (err) {\n          logWarn(err);\n          isLoadingRules = false;\n          loadingEnd();\n        });\n        return null;\n      }\n\n      return {\n        rules: rules\n      };\n    }\n\n    var forceRenderStyle = false;\n\n    function render(theme, ignoreImageAnalysis) {\n      var rules = getRulesSync();\n\n      if (!rules) {\n        return;\n      }\n\n      cancelAsyncOperations = false;\n\n      function removeCSSRulesFromSheet(sheet) {\n        try {\n          if (sheet.replaceSync) {\n            sheet.replaceSync('');\n            return;\n          }\n        } catch (err) {\n          logWarn('Could not use fastpath for removing rules from stylesheet', err);\n        }\n\n        for (var i = sheet.cssRules.length - 1; i >= 0; i--) {\n          sheet.deleteRule(i);\n        }\n      }\n\n      function prepareOverridesSheet() {\n        if (!syncStyle) {\n          createSyncStyle();\n        }\n\n        syncStylePositionWatcher && syncStylePositionWatcher.stop();\n        insertStyle();\n\n        if (syncStyle.sheet == null) {\n          syncStyle.textContent = '';\n        }\n\n        var sheet = syncStyle.sheet;\n        removeCSSRulesFromSheet(sheet);\n\n        if (syncStylePositionWatcher) {\n          syncStylePositionWatcher.run();\n        } else {\n          syncStylePositionWatcher = watchForNodePosition(syncStyle, 'prev-sibling', function () {\n            forceRenderStyle = true;\n            buildOverrides();\n          });\n        }\n\n        return syncStyle.sheet;\n      }\n\n      function buildOverrides() {\n        var force = forceRenderStyle;\n        forceRenderStyle = false;\n        sheetModifier.modifySheet({\n          prepareSheet: prepareOverridesSheet,\n          sourceCSSRules: rules,\n          theme: theme,\n          ignoreImageAnalysis: ignoreImageAnalysis,\n          force: force,\n          isAsyncCancelled: function isAsyncCancelled() {\n            return cancelAsyncOperations;\n          }\n        });\n        isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\n\n        if (sheetModifier.shouldRebuildStyle()) {\n          addReadyStateCompleteListener(function () {\n            return update();\n          });\n        }\n      }\n\n      buildOverrides();\n    }\n\n    function getRulesOrError() {\n      try {\n        if (element.sheet == null) {\n          return [null, null];\n        }\n\n        return [element.sheet.cssRules, null];\n      } catch (err) {\n        return [null, err];\n      }\n    }\n\n    function isStillLoadingError(error) {\n      return error && error.message && error.message.includes('loading');\n    }\n\n    function safeGetSheetRules() {\n      var _a = __read(getRulesOrError(), 2),\n          cssRules = _a[0],\n          err = _a[1];\n\n      if (err) {\n        logWarn(err);\n        return null;\n      }\n\n      return cssRules;\n    }\n\n    function watchForSheetChanges() {\n      watchForSheetChangesUsingProxy();\n\n      if (!isThunderbird && !(canOptimizeUsingProxy$1 && element.sheet)) {\n        watchForSheetChangesUsingRAF();\n      }\n    }\n\n    var rulesChangeKey = null;\n    var rulesCheckFrameId = null;\n\n    function getRulesChangeKey() {\n      var rules = safeGetSheetRules();\n      return rules ? rules.length : null;\n    }\n\n    function didRulesKeyChange() {\n      return getRulesChangeKey() !== rulesChangeKey;\n    }\n\n    function watchForSheetChangesUsingRAF() {\n      rulesChangeKey = getRulesChangeKey();\n      stopWatchingForSheetChangesUsingRAF();\n\n      var checkForUpdate = function checkForUpdate() {\n        if (didRulesKeyChange()) {\n          rulesChangeKey = getRulesChangeKey();\n          update();\n        }\n\n        if (canOptimizeUsingProxy$1 && element.sheet) {\n          stopWatchingForSheetChangesUsingRAF();\n          return;\n        }\n\n        rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\n      };\n\n      checkForUpdate();\n    }\n\n    function stopWatchingForSheetChangesUsingRAF() {\n      cancelAnimationFrame(rulesCheckFrameId);\n    }\n\n    var areSheetChangesPending = false;\n\n    function onSheetChange() {\n      canOptimizeUsingProxy$1 = true;\n      stopWatchingForSheetChangesUsingRAF();\n\n      if (areSheetChangesPending) {\n        return;\n      }\n\n      function handleSheetChanges() {\n        areSheetChangesPending = false;\n\n        if (cancelAsyncOperations) {\n          return;\n        }\n\n        update();\n      }\n\n      areSheetChangesPending = true;\n\n      if (typeof queueMicrotask === 'function') {\n        queueMicrotask(handleSheetChanges);\n      } else {\n        requestAnimationFrame(handleSheetChanges);\n      }\n    }\n\n    function watchForSheetChangesUsingProxy() {\n      element.addEventListener('__darkreader__updateSheet', onSheetChange);\n    }\n\n    function stopWatchingForSheetChangesUsingProxy() {\n      element.removeEventListener('__darkreader__updateSheet', onSheetChange);\n    }\n\n    function stopWatchingForSheetChanges() {\n      stopWatchingForSheetChangesUsingProxy();\n      stopWatchingForSheetChangesUsingRAF();\n    }\n\n    function pause() {\n      observer.disconnect();\n      cancelAsyncOperations = true;\n      corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\n      syncStylePositionWatcher && syncStylePositionWatcher.stop();\n      stopWatchingForSheetChanges();\n    }\n\n    function destroy() {\n      pause();\n      removeNode(corsCopy);\n      removeNode(syncStyle);\n      loadingEnd();\n\n      if (rejectorsForLoadingLinks.has(loadingLinkId)) {\n        var reject = rejectorsForLoadingLinks.get(loadingLinkId);\n        rejectorsForLoadingLinks.delete(loadingLinkId);\n        reject && reject();\n      }\n    }\n\n    function watch() {\n      observer.observe(element, observerOptions);\n\n      if (element instanceof HTMLStyleElement) {\n        watchForSheetChanges();\n      }\n    }\n\n    var maxMoveCount = 10;\n    var moveCount = 0;\n\n    function restore() {\n      if (!syncStyle) {\n        return;\n      }\n\n      moveCount++;\n\n      if (moveCount > maxMoveCount) {\n        logWarn('Style sheet was moved multiple times', element);\n        return;\n      }\n\n      logWarn('Restore style', syncStyle, element);\n      insertStyle();\n      corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\n      syncStylePositionWatcher && syncStylePositionWatcher.skip();\n\n      if (!isOverrideEmpty) {\n        forceRenderStyle = true;\n        update();\n      }\n    }\n\n    return {\n      details: details,\n      render: render,\n      pause: pause,\n      destroy: destroy,\n      watch: watch,\n      restore: restore\n    };\n  }\n\n  function linkLoading(link, loadingId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var cleanUp = function cleanUp() {\n            link.removeEventListener('load', onLoad);\n            link.removeEventListener('error', onError);\n            rejectorsForLoadingLinks.delete(loadingId);\n          };\n\n          var onLoad = function onLoad() {\n            cleanUp();\n            logInfo(\"Linkelement \" + loadingId + \" has been loaded\");\n            resolve();\n          };\n\n          var onError = function onError() {\n            cleanUp();\n            reject(\"Linkelement \" + loadingId + \" couldn't be loaded. \" + link.href);\n          };\n\n          rejectorsForLoadingLinks.set(loadingId, function () {\n            cleanUp();\n            reject();\n          });\n          link.addEventListener('load', onLoad);\n          link.addEventListener('error', onError);\n\n          if (!link.href) {\n            onError();\n          }\n        })];\n      });\n    });\n  }\n\n  function getCSSImportURL(importDeclaration) {\n    return getCSSURLValue(importDeclaration.substring(7).trim().replace(/;$/, '').replace(/screen$/, ''));\n  }\n\n  function loadText(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!url.startsWith('data:')) return [3, 3];\n            return [4, fetch(url)];\n\n          case 1:\n            return [4, _a.sent().text()];\n\n          case 2:\n            return [2, _a.sent()];\n\n          case 3:\n            return [4, bgFetch({\n              url: url,\n              responseType: 'text',\n              mimeType: 'text/css',\n              origin: window.location.origin\n            })];\n\n          case 4:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function replaceCSSImports(cssText, basePath, cache) {\n    if (cache === void 0) {\n      cache = new Map();\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var importMatches, importMatches_1, importMatches_1_1, match, importURL, absoluteURL, importedCSS, err_3, e_1_1;\n\n      var e_1, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            cssText = removeCSSComments(cssText);\n            cssText = replaceCSSFontFace(cssText);\n            cssText = replaceCSSRelativeURLsWithAbsolute(cssText, basePath);\n            importMatches = getMatches(cssImportRegex, cssText);\n            _b.label = 1;\n\n          case 1:\n            _b.trys.push([1, 10, 11, 12]);\n\n            importMatches_1 = __values(importMatches), importMatches_1_1 = importMatches_1.next();\n            _b.label = 2;\n\n          case 2:\n            if (!!importMatches_1_1.done) return [3, 9];\n            match = importMatches_1_1.value;\n            importURL = getCSSImportURL(match);\n            absoluteURL = getAbsoluteURL(basePath, importURL);\n            importedCSS = void 0;\n            if (!cache.has(absoluteURL)) return [3, 3];\n            importedCSS = cache.get(absoluteURL);\n            return [3, 7];\n\n          case 3:\n            _b.trys.push([3, 6,, 7]);\n\n            return [4, loadText(absoluteURL)];\n\n          case 4:\n            importedCSS = _b.sent();\n            cache.set(absoluteURL, importedCSS);\n            return [4, replaceCSSImports(importedCSS, getCSSBaseBath(absoluteURL), cache)];\n\n          case 5:\n            importedCSS = _b.sent();\n            return [3, 7];\n\n          case 6:\n            err_3 = _b.sent();\n            logWarn(err_3);\n            importedCSS = '';\n            return [3, 7];\n\n          case 7:\n            cssText = cssText.split(match).join(importedCSS);\n            _b.label = 8;\n\n          case 8:\n            importMatches_1_1 = importMatches_1.next();\n            return [3, 2];\n\n          case 9:\n            return [3, 12];\n\n          case 10:\n            e_1_1 = _b.sent();\n            e_1 = {\n              error: e_1_1\n            };\n            return [3, 12];\n\n          case 11:\n            try {\n              if (importMatches_1_1 && !importMatches_1_1.done && (_a = importMatches_1.return)) _a.call(importMatches_1);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n\n            return [7];\n\n          case 12:\n            cssText = cssText.trim();\n            return [2, cssText];\n        }\n      });\n    });\n  }\n\n  function createCORSCopy(srcElement, cssText) {\n    if (!cssText) {\n      return null;\n    }\n\n    var cors = document.createElement('style');\n    cors.classList.add('darkreader');\n    cors.classList.add('darkreader--cors');\n    cors.media = 'screen';\n    cors.textContent = cssText;\n    srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\n    cors.sheet.disabled = true;\n    corsStyleSet.add(cors);\n    return cors;\n  }\n\n  var observers = [];\n  var observedRoots;\n  var undefinedGroups = new Map();\n  var elementsDefinitionCallback;\n\n  function collectUndefinedElements(root) {\n    if (!isDefinedSelectorSupported) {\n      return;\n    }\n\n    forEach(root.querySelectorAll(':not(:defined)'), function (el) {\n      var tag = el.tagName.toLowerCase();\n\n      if (!tag.includes('-')) {\n        var extendedTag = el.getAttribute('is');\n\n        if (extendedTag) {\n          tag = extendedTag;\n        } else {\n          return;\n        }\n      }\n\n      if (!undefinedGroups.has(tag)) {\n        undefinedGroups.set(tag, new Set());\n        customElementsWhenDefined(tag).then(function () {\n          if (elementsDefinitionCallback) {\n            var elements = undefinedGroups.get(tag);\n            undefinedGroups.delete(tag);\n            elementsDefinitionCallback(Array.from(elements));\n          }\n        });\n      }\n\n      undefinedGroups.get(tag).add(el);\n    });\n  }\n\n  var canOptimizeUsingProxy = false;\n\n  if (typeof document !== 'undefined') {\n    document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\n      canOptimizeUsingProxy = true;\n    });\n  }\n\n  var resolvers = new Map();\n\n  function handleIsDefined(e) {\n    canOptimizeUsingProxy = true;\n\n    if (resolvers.has(e.detail.tag)) {\n      var resolve = resolvers.get(e.detail.tag);\n      resolve();\n    }\n  }\n\n  function customElementsWhenDefined(tag) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve) {\n          if (window.customElements && typeof customElements.whenDefined === 'function') {\n            customElements.whenDefined(tag).then(function () {\n              return resolve();\n            });\n          } else if (canOptimizeUsingProxy) {\n            resolvers.set(tag, resolve);\n            document.dispatchEvent(new CustomEvent('__darkreader__addUndefinedResolver', {\n              detail: {\n                tag: tag\n              }\n            }));\n          } else {\n            var checkIfDefined_1 = function checkIfDefined_1() {\n              var elements = undefinedGroups.get(tag);\n\n              if (elements && elements.size > 0) {\n                if (elements.values().next().value.matches(':defined')) {\n                  resolve();\n                } else {\n                  requestAnimationFrame(checkIfDefined_1);\n                }\n              }\n            };\n\n            requestAnimationFrame(checkIfDefined_1);\n          }\n        })];\n      });\n    });\n  }\n\n  function watchWhenCustomElementsDefined(callback) {\n    elementsDefinitionCallback = callback;\n  }\n\n  function unsubscribeFromDefineCustomElements() {\n    elementsDefinitionCallback = null;\n    undefinedGroups.clear();\n    document.removeEventListener('__darkreader__isDefined', handleIsDefined);\n  }\n\n  function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\n    stopWatchingForStyleChanges();\n    var prevStyles = new Set(currentStyles);\n    var prevStyleSiblings = new WeakMap();\n    var nextStyleSiblings = new WeakMap();\n\n    function saveStylePosition(style) {\n      prevStyleSiblings.set(style, style.previousElementSibling);\n      nextStyleSiblings.set(style, style.nextElementSibling);\n    }\n\n    function forgetStylePosition(style) {\n      prevStyleSiblings.delete(style);\n      nextStyleSiblings.delete(style);\n    }\n\n    function didStylePositionChange(style) {\n      return style.previousElementSibling !== prevStyleSiblings.get(style) || style.nextElementSibling !== nextStyleSiblings.get(style);\n    }\n\n    currentStyles.forEach(saveStylePosition);\n\n    function handleStyleOperations(operations) {\n      var createdStyles = operations.createdStyles,\n          removedStyles = operations.removedStyles,\n          movedStyles = operations.movedStyles;\n      createdStyles.forEach(function (s) {\n        return saveStylePosition(s);\n      });\n      movedStyles.forEach(function (s) {\n        return saveStylePosition(s);\n      });\n      removedStyles.forEach(function (s) {\n        return forgetStylePosition(s);\n      });\n      createdStyles.forEach(function (s) {\n        return prevStyles.add(s);\n      });\n      removedStyles.forEach(function (s) {\n        return prevStyles.delete(s);\n      });\n\n      if (createdStyles.size + removedStyles.size + movedStyles.size > 0) {\n        update({\n          created: Array.from(createdStyles),\n          removed: Array.from(removedStyles),\n          moved: Array.from(movedStyles),\n          updated: []\n        });\n      }\n    }\n\n    function handleMinorTreeMutations(_a) {\n      var additions = _a.additions,\n          moves = _a.moves,\n          deletions = _a.deletions;\n      var createdStyles = new Set();\n      var removedStyles = new Set();\n      var movedStyles = new Set();\n      additions.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return createdStyles.add(style);\n        });\n      });\n      deletions.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return removedStyles.add(style);\n        });\n      });\n      moves.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return movedStyles.add(style);\n        });\n      });\n      handleStyleOperations({\n        createdStyles: createdStyles,\n        removedStyles: removedStyles,\n        movedStyles: movedStyles\n      });\n      additions.forEach(function (n) {\n        iterateShadowHosts(n, subscribeForShadowRootChanges);\n        collectUndefinedElements(n);\n      });\n    }\n\n    function handleHugeTreeMutations(root) {\n      var styles = new Set(getManageableStyles(root));\n      var createdStyles = new Set();\n      var removedStyles = new Set();\n      var movedStyles = new Set();\n      styles.forEach(function (s) {\n        if (!prevStyles.has(s)) {\n          createdStyles.add(s);\n        }\n      });\n      prevStyles.forEach(function (s) {\n        if (!styles.has(s)) {\n          removedStyles.add(s);\n        }\n      });\n      styles.forEach(function (s) {\n        if (!createdStyles.has(s) && !removedStyles.has(s) && didStylePositionChange(s)) {\n          movedStyles.add(s);\n        }\n      });\n      handleStyleOperations({\n        createdStyles: createdStyles,\n        removedStyles: removedStyles,\n        movedStyles: movedStyles\n      });\n      iterateShadowHosts(root, subscribeForShadowRootChanges);\n      collectUndefinedElements(root);\n    }\n\n    function handleAttributeMutations(mutations) {\n      var updatedStyles = new Set();\n      var removedStyles = new Set();\n      mutations.forEach(function (m) {\n        var target = m.target;\n\n        if (target.isConnected) {\n          if (shouldManageStyle(target)) {\n            updatedStyles.add(target);\n          } else if (target instanceof HTMLLinkElement && target.disabled) {\n            removedStyles.add(target);\n          }\n        }\n      });\n\n      if (updatedStyles.size + removedStyles.size > 0) {\n        update({\n          updated: Array.from(updatedStyles),\n          created: [],\n          removed: Array.from(removedStyles),\n          moved: []\n        });\n      }\n    }\n\n    function observe(root) {\n      var treeObserver = createOptimizedTreeObserver(root, {\n        onMinorMutations: handleMinorTreeMutations,\n        onHugeMutations: handleHugeTreeMutations\n      });\n      var attrObserver = new MutationObserver(handleAttributeMutations);\n      attrObserver.observe(root, {\n        attributes: true,\n        attributeFilter: ['rel', 'disabled', 'media'],\n        subtree: true\n      });\n      observers.push(treeObserver, attrObserver);\n      observedRoots.add(root);\n    }\n\n    function subscribeForShadowRootChanges(node) {\n      var shadowRoot = node.shadowRoot;\n\n      if (shadowRoot == null || observedRoots.has(shadowRoot)) {\n        return;\n      }\n\n      observe(shadowRoot);\n      shadowRootDiscovered(shadowRoot);\n    }\n\n    observe(document);\n    iterateShadowHosts(document.documentElement, subscribeForShadowRootChanges);\n    watchWhenCustomElementsDefined(function (hosts) {\n      var newStyles = [];\n      hosts.forEach(function (host) {\n        return push(newStyles, getManageableStyles(host.shadowRoot));\n      });\n      update({\n        created: newStyles,\n        updated: [],\n        removed: [],\n        moved: []\n      });\n      hosts.forEach(function (host) {\n        var shadowRoot = host.shadowRoot;\n\n        if (shadowRoot == null) {\n          return;\n        }\n\n        subscribeForShadowRootChanges(host);\n        iterateShadowHosts(shadowRoot, subscribeForShadowRootChanges);\n        collectUndefinedElements(shadowRoot);\n      });\n    });\n    document.addEventListener('__darkreader__isDefined', handleIsDefined);\n    collectUndefinedElements(document);\n  }\n\n  function resetObservers() {\n    observers.forEach(function (o) {\n      return o.disconnect();\n    });\n    observers.splice(0, observers.length);\n    observedRoots = new WeakSet();\n  }\n\n  function stopWatchingForStyleChanges() {\n    resetObservers();\n    unsubscribeFromDefineCustomElements();\n  }\n\n  function hexify(number) {\n    return (number < 16 ? '0' : '') + number.toString(16);\n  }\n\n  function generateUID() {\n    if (typeof crypto === 'undefined') return 'xxx-xxxx';\n\n    if ('randomUUID' in crypto) {\n      var uuid = crypto.randomUUID();\n      return uuid.substring(0, 8) + uuid.substring(9, 13) + uuid.substring(14, 18) + uuid.substring(19, 23) + uuid.substring(24);\n    }\n\n    return Array.from(crypto.getRandomValues(new Uint8Array(16))).map(function (x) {\n      return hexify(x);\n    }).join('');\n  }\n\n  var adoptedStyleOverrides = new WeakMap();\n  var overrideList = new WeakSet();\n\n  function createAdoptedStyleSheetOverride(node) {\n    var cancelAsyncOperations = false;\n\n    function injectSheet(sheet, override) {\n      var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\n\n      var sheetIndex = newSheets.indexOf(sheet);\n      var existingIndex = newSheets.indexOf(override);\n\n      if (sheetIndex === existingIndex - 1) {\n        return;\n      }\n\n      if (existingIndex >= 0) {\n        newSheets.splice(existingIndex, 1);\n      }\n\n      newSheets.splice(sheetIndex + 1, 0, override);\n      node.adoptedStyleSheets = newSheets;\n    }\n\n    function destroy() {\n      cancelAsyncOperations = true;\n\n      var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\n\n      node.adoptedStyleSheets.forEach(function (adoptedStyleSheet) {\n        if (overrideList.has(adoptedStyleSheet)) {\n          var existingIndex = newSheets.indexOf(adoptedStyleSheet);\n\n          if (existingIndex >= 0) {\n            newSheets.splice(existingIndex, 1);\n          }\n\n          adoptedStyleOverrides.delete(adoptedStyleSheet);\n          overrideList.delete(adoptedStyleSheet);\n        }\n      });\n      node.adoptedStyleSheets = newSheets;\n    }\n\n    function render(theme, ignoreImageAnalysis) {\n      node.adoptedStyleSheets.forEach(function (sheet) {\n        if (overrideList.has(sheet)) {\n          return;\n        }\n\n        var rules = sheet.rules;\n        var override = new CSSStyleSheet();\n\n        function prepareOverridesSheet() {\n          for (var i = override.cssRules.length - 1; i >= 0; i--) {\n            override.deleteRule(i);\n          }\n\n          injectSheet(sheet, override);\n          adoptedStyleOverrides.set(sheet, override);\n          overrideList.add(override);\n          return override;\n        }\n\n        var sheetModifier = createStyleSheetModifier();\n        sheetModifier.modifySheet({\n          prepareSheet: prepareOverridesSheet,\n          sourceCSSRules: rules,\n          theme: theme,\n          ignoreImageAnalysis: ignoreImageAnalysis,\n          force: false,\n          isAsyncCancelled: function isAsyncCancelled() {\n            return cancelAsyncOperations;\n          }\n        });\n      });\n    }\n\n    return {\n      render: render,\n      destroy: destroy\n    };\n  }\n\n  function injectProxy(enableStyleSheetsProxy) {\n    document.dispatchEvent(new CustomEvent('__darkreader__inlineScriptsAllowed'));\n    var addRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'addRule');\n    var insertRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'insertRule');\n    var deleteRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'deleteRule');\n    var removeRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'removeRule');\n    var documentStyleSheetsDescriptor = enableStyleSheetsProxy ? Object.getOwnPropertyDescriptor(Document.prototype, 'styleSheets') : null;\n    var shouldWrapHTMLElement = location.hostname.endsWith('baidu.com');\n    var getElementsByTagNameDescriptor = shouldWrapHTMLElement ? Object.getOwnPropertyDescriptor(Element.prototype, 'getElementsByTagName') : null;\n\n    var cleanUp = function cleanUp() {\n      Object.defineProperty(CSSStyleSheet.prototype, 'addRule', addRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', insertRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', deleteRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', removeRuleDescriptor);\n      document.removeEventListener('__darkreader__cleanUp', cleanUp);\n      document.removeEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\n\n      if (enableStyleSheetsProxy) {\n        Object.defineProperty(Document.prototype, 'styleSheets', documentStyleSheetsDescriptor);\n      }\n\n      if (shouldWrapHTMLElement) {\n        Object.defineProperty(Element.prototype, 'getElementsByTagName', getElementsByTagNameDescriptor);\n      }\n    };\n\n    var addUndefinedResolver = function addUndefinedResolver(e) {\n      customElements.whenDefined(e.detail.tag).then(function () {\n        document.dispatchEvent(new CustomEvent('__darkreader__isDefined', {\n          detail: {\n            tag: e.detail.tag\n          }\n        }));\n      });\n    };\n\n    document.addEventListener('__darkreader__cleanUp', cleanUp);\n    document.addEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\n    var updateSheetEvent = new Event('__darkreader__updateSheet');\n\n    function proxyAddRule(selector, style, index) {\n      addRuleDescriptor.value.call(this, selector, style, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n\n      return -1;\n    }\n\n    function proxyInsertRule(rule, index) {\n      var returnValue = insertRuleDescriptor.value.call(this, rule, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n\n      return returnValue;\n    }\n\n    function proxyDeleteRule(index) {\n      deleteRuleDescriptor.value.call(this, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n    }\n\n    function proxyRemoveRule(index) {\n      removeRuleDescriptor.value.call(this, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n    }\n\n    function proxyDocumentStyleSheets() {\n      var docSheets = documentStyleSheetsDescriptor.get.call(this);\n\n      var filtered = __spreadArray([], __read(docSheets), false).filter(function (styleSheet) {\n        return !styleSheet.ownerNode.classList.contains('darkreader');\n      });\n\n      return Object.setPrototypeOf(filtered, StyleSheetList.prototype);\n    }\n\n    function proxyGetElementsByTagName(tagName) {\n      var _this = this;\n\n      if (tagName !== 'style') {\n        return getElementsByTagNameDescriptor.value.call(this, tagName);\n      }\n\n      var getCurrentElementValue = function getCurrentElementValue() {\n        var elements = getElementsByTagNameDescriptor.value.call(_this, tagName);\n        return Object.setPrototypeOf(__spreadArray([], __read(elements), false).filter(function (element) {\n          return !element.classList.contains('darkreader');\n        }), NodeList.prototype);\n      };\n\n      var elements = getCurrentElementValue();\n      var NodeListBehavior = {\n        get: function get(_, property) {\n          return getCurrentElementValue()[Number(property)];\n        }\n      };\n      elements = new Proxy(elements, NodeListBehavior);\n      return elements;\n    }\n\n    Object.defineProperty(CSSStyleSheet.prototype, 'addRule', Object.assign({}, addRuleDescriptor, {\n      value: proxyAddRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', Object.assign({}, insertRuleDescriptor, {\n      value: proxyInsertRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', Object.assign({}, deleteRuleDescriptor, {\n      value: proxyDeleteRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', Object.assign({}, removeRuleDescriptor, {\n      value: proxyRemoveRule\n    }));\n\n    if (enableStyleSheetsProxy) {\n      Object.defineProperty(Document.prototype, 'styleSheets', Object.assign({}, documentStyleSheetsDescriptor, {\n        get: proxyDocumentStyleSheets\n      }));\n    }\n\n    if (shouldWrapHTMLElement) {\n      Object.defineProperty(Element.prototype, 'getElementsByTagName', Object.assign({}, getElementsByTagNameDescriptor, {\n        value: proxyGetElementsByTagName\n      }));\n    }\n  }\n\n  var INSTANCE_ID = generateUID();\n  var styleManagers = new Map();\n  var adoptedStyleManagers = [];\n  var filter = null;\n  var fixes = null;\n  var isIFrame$1 = null;\n  var ignoredImageAnalysisSelectors = null;\n  var ignoredInlineSelectors = null;\n\n  function createOrUpdateStyle(className, root) {\n    if (root === void 0) {\n      root = document.head || document;\n    }\n\n    var element = root.querySelector(\".\" + className);\n\n    if (!element) {\n      element = document.createElement('style');\n      element.classList.add('darkreader');\n      element.classList.add(className);\n      element.media = 'screen';\n      element.textContent = '';\n    }\n\n    return element;\n  }\n\n  function createOrUpdateScript(className, root) {\n    if (root === void 0) {\n      root = document.head || document;\n    }\n\n    var element = root.querySelector(\".\" + className);\n\n    if (!element) {\n      element = document.createElement('script');\n      element.classList.add('darkreader');\n      element.classList.add(className);\n    }\n\n    return element;\n  }\n\n  var nodePositionWatchers = new Map();\n\n  function setupNodePositionWatcher(node, alias) {\n    nodePositionWatchers.has(alias) && nodePositionWatchers.get(alias).stop();\n    nodePositionWatchers.set(alias, watchForNodePosition(node, 'parent'));\n  }\n\n  function stopStylePositionWatchers() {\n    forEach(nodePositionWatchers.values(), function (watcher) {\n      return watcher.stop();\n    });\n    nodePositionWatchers.clear();\n  }\n\n  function createStaticStyleOverrides() {\n    var fallbackStyle = createOrUpdateStyle('darkreader--fallback', document);\n    fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n      strict: true\n    });\n    document.head.insertBefore(fallbackStyle, document.head.firstChild);\n    setupNodePositionWatcher(fallbackStyle, 'fallback');\n    var userAgentStyle = createOrUpdateStyle('darkreader--user-agent');\n    userAgentStyle.textContent = getModifiedUserAgentStyle(filter, isIFrame$1, filter.styleSystemControls);\n    document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\n    setupNodePositionWatcher(userAgentStyle, 'user-agent');\n    var textStyle = createOrUpdateStyle('darkreader--text');\n\n    if (filter.useFont || filter.textStroke > 0) {\n      textStyle.textContent = createTextStyle(filter);\n    } else {\n      textStyle.textContent = '';\n    }\n\n    document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\n    setupNodePositionWatcher(textStyle, 'text');\n    var invertStyle = createOrUpdateStyle('darkreader--invert');\n\n    if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\n      invertStyle.textContent = [fixes.invert.join(', ') + \" {\", \"    filter: \" + getCSSFilterValue(_assign(_assign({}, filter), {\n        contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100)\n      })) + \" !important;\", '}'].join('\\n');\n    } else {\n      invertStyle.textContent = '';\n    }\n\n    document.head.insertBefore(invertStyle, textStyle.nextSibling);\n    setupNodePositionWatcher(invertStyle, 'invert');\n    var inlineStyle = createOrUpdateStyle('darkreader--inline');\n    inlineStyle.textContent = getInlineOverrideStyle();\n    document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\n    setupNodePositionWatcher(inlineStyle, 'inline');\n    var overrideStyle = createOrUpdateStyle('darkreader--override');\n    overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\n    document.head.appendChild(overrideStyle);\n    setupNodePositionWatcher(overrideStyle, 'override');\n    var variableStyle = createOrUpdateStyle('darkreader--variables');\n    var selectionColors = getSelectionColor(filter);\n    var darkSchemeBackgroundColor = filter.darkSchemeBackgroundColor,\n        darkSchemeTextColor = filter.darkSchemeTextColor,\n        lightSchemeBackgroundColor = filter.lightSchemeBackgroundColor,\n        lightSchemeTextColor = filter.lightSchemeTextColor,\n        mode = filter.mode;\n    var schemeBackgroundColor = mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\n    var schemeTextColor = mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\n    schemeBackgroundColor = modifyBackgroundColor(parse(schemeBackgroundColor), filter);\n    schemeTextColor = modifyForegroundColor(parse(schemeTextColor), filter);\n    variableStyle.textContent = [\":root {\", \"   --darkreader-neutral-background: \" + schemeBackgroundColor + \";\", \"   --darkreader-neutral-text: \" + schemeTextColor + \";\", \"   --darkreader-selection-background: \" + selectionColors.backgroundColorSelection + \";\", \"   --darkreader-selection-text: \" + selectionColors.foregroundColorSelection + \";\", \"}\"].join('\\n');\n    document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\n    setupNodePositionWatcher(variableStyle, 'variables');\n    var rootVarsStyle = createOrUpdateStyle('darkreader--root-vars');\n    document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\n    var proxyScript = createOrUpdateScript('darkreader--proxy');\n    proxyScript.append(\"(\" + injectProxy + \")(!\" + (fixes && fixes.disableStyleSheetsProxy) + \")\");\n    document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\n    proxyScript.remove();\n  }\n\n  var shadowRootsWithOverrides = new Set();\n\n  function createShadowStaticStyleOverrides(root) {\n    var inlineStyle = createOrUpdateStyle('darkreader--inline', root);\n    inlineStyle.textContent = getInlineOverrideStyle();\n    root.insertBefore(inlineStyle, root.firstChild);\n    var overrideStyle = createOrUpdateStyle('darkreader--override', root);\n    overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\n    root.insertBefore(overrideStyle, inlineStyle.nextSibling);\n    var invertStyle = createOrUpdateStyle('darkreader--invert', root);\n\n    if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\n      invertStyle.textContent = [fixes.invert.join(', ') + \" {\", \"    filter: \" + getCSSFilterValue(_assign(_assign({}, filter), {\n        contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100)\n      })) + \" !important;\", '}'].join('\\n');\n    } else {\n      invertStyle.textContent = '';\n    }\n\n    root.insertBefore(invertStyle, overrideStyle.nextSibling);\n    shadowRootsWithOverrides.add(root);\n  }\n\n  function replaceCSSTemplates($cssText) {\n    return $cssText.replace(/\\${(.+?)}/g, function (_, $color) {\n      var color = tryParseColor($color);\n\n      if (color) {\n        return modifyColor(color, filter);\n      }\n\n      logWarn(\"Couldn't parse CSSTemplate's color.\");\n      return $color;\n    });\n  }\n\n  function cleanFallbackStyle() {\n    var fallback = document.querySelector('.darkreader--fallback');\n\n    if (fallback) {\n      fallback.textContent = '';\n    }\n  }\n\n  function createDynamicStyleOverrides() {\n    cancelRendering();\n    var allStyles = getManageableStyles(document);\n    var newManagers = allStyles.filter(function (style) {\n      return !styleManagers.has(style);\n    }).map(function (style) {\n      return createManager(style);\n    });\n    newManagers.map(function (manager) {\n      return manager.details({\n        secondRound: false\n      });\n    }).filter(function (detail) {\n      return detail && detail.rules.length > 0;\n    }).forEach(function (detail) {\n      variablesStore.addRulesForMatching(detail.rules);\n    });\n    variablesStore.matchVariablesAndDependants();\n    variablesStore.setOnRootVariableChange(function () {\n      variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n    });\n    variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n    styleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n\n    if (loadingStyles.size === 0) {\n      cleanFallbackStyle();\n    }\n\n    newManagers.forEach(function (manager) {\n      return manager.watch();\n    });\n    var inlineStyleElements = toArray(document.querySelectorAll(INLINE_STYLE_SELECTOR));\n    iterateShadowHosts(document.documentElement, function (host) {\n      createShadowStaticStyleOverrides(host.shadowRoot);\n      var elements = host.shadowRoot.querySelectorAll(INLINE_STYLE_SELECTOR);\n\n      if (elements.length > 0) {\n        push(inlineStyleElements, elements);\n      }\n    });\n    inlineStyleElements.forEach(function (el) {\n      return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n    });\n    handleAdoptedStyleSheets(document);\n  }\n\n  var loadingStylesCounter = 0;\n  var loadingStyles = new Set();\n\n  function createManager(element) {\n    var loadingStyleId = ++loadingStylesCounter;\n    logInfo(\"New manager for element, with loadingStyleID \" + loadingStyleId, element);\n\n    function loadingStart() {\n      if (!isDOMReady() || !didDocumentShowUp) {\n        loadingStyles.add(loadingStyleId);\n        logInfo(\"Current amount of styles loading: \" + loadingStyles.size);\n        var fallbackStyle = document.querySelector('.darkreader--fallback');\n\n        if (!fallbackStyle.textContent) {\n          fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n            strict: false\n          });\n        }\n      }\n    }\n\n    function loadingEnd() {\n      loadingStyles.delete(loadingStyleId);\n      logInfo(\"Removed loadingStyle \" + loadingStyleId + \", now awaiting: \" + loadingStyles.size);\n      logInfo(\"To-do to be loaded\", loadingStyles);\n\n      if (loadingStyles.size === 0 && isDOMReady()) {\n        cleanFallbackStyle();\n      }\n    }\n\n    function update() {\n      var details = manager.details({\n        secondRound: true\n      });\n\n      if (!details) {\n        return;\n      }\n\n      variablesStore.addRulesForMatching(details.rules);\n      variablesStore.matchVariablesAndDependants();\n      manager.render(filter, ignoredImageAnalysisSelectors);\n    }\n\n    var manager = manageStyle(element, {\n      update: update,\n      loadingStart: loadingStart,\n      loadingEnd: loadingEnd\n    });\n    styleManagers.set(element, manager);\n    return manager;\n  }\n\n  function removeManager(element) {\n    var manager = styleManagers.get(element);\n\n    if (manager) {\n      manager.destroy();\n      styleManagers.delete(element);\n    }\n  }\n\n  var throttledRenderAllStyles = throttle(function (callback) {\n    styleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n    adoptedStyleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n    callback && callback();\n  });\n\n  var cancelRendering = function cancelRendering() {\n    throttledRenderAllStyles.cancel();\n  };\n\n  function onDOMReady() {\n    if (loadingStyles.size === 0) {\n      cleanFallbackStyle();\n      return;\n    }\n\n    logWarn(\"DOM is ready, but still have styles being loaded.\", loadingStyles);\n  }\n\n  var documentVisibilityListener = null;\n  var didDocumentShowUp = typeof document !== 'undefined' && !document.hidden;\n\n  function watchForDocumentVisibility(callback) {\n    var alreadyWatching = Boolean(documentVisibilityListener);\n\n    documentVisibilityListener = function documentVisibilityListener() {\n      if (!document.hidden) {\n        stopWatchingForDocumentVisibility();\n        callback();\n        didDocumentShowUp = true;\n      }\n    };\n\n    if (!alreadyWatching) {\n      document.addEventListener('visibilitychange', documentVisibilityListener);\n    }\n  }\n\n  function stopWatchingForDocumentVisibility() {\n    document.removeEventListener('visibilitychange', documentVisibilityListener);\n    documentVisibilityListener = null;\n  }\n\n  function createThemeAndWatchForUpdates() {\n    createStaticStyleOverrides();\n\n    function runDynamicStyle() {\n      createDynamicStyleOverrides();\n      watchForUpdates();\n    }\n\n    if (document.hidden) {\n      watchForDocumentVisibility(runDynamicStyle);\n    } else {\n      runDynamicStyle();\n    }\n\n    changeMetaThemeColorWhenAvailable(filter);\n  }\n\n  function handleAdoptedStyleSheets(node) {\n    if (Array.isArray(node.adoptedStyleSheets)) {\n      if (node.adoptedStyleSheets.length > 0) {\n        var newManger = createAdoptedStyleSheetOverride(node);\n        adoptedStyleManagers.push(newManger);\n        newManger.render(filter, ignoredImageAnalysisSelectors);\n      }\n    }\n  }\n\n  function watchForUpdates() {\n    var managedStyles = Array.from(styleManagers.keys());\n    watchForStyleChanges(managedStyles, function (_a) {\n      var created = _a.created,\n          updated = _a.updated,\n          removed = _a.removed,\n          moved = _a.moved;\n      var stylesToRemove = removed;\n      var stylesToManage = created.concat(updated).concat(moved).filter(function (style) {\n        return !styleManagers.has(style);\n      });\n      var stylesToRestore = moved.filter(function (style) {\n        return styleManagers.has(style);\n      });\n      logInfo(\"Styles to be removed:\", stylesToRemove);\n      stylesToRemove.forEach(function (style) {\n        return removeManager(style);\n      });\n      var newManagers = stylesToManage.map(function (style) {\n        return createManager(style);\n      });\n      newManagers.map(function (manager) {\n        return manager.details({\n          secondRound: false\n        });\n      }).filter(function (detail) {\n        return detail && detail.rules.length > 0;\n      }).forEach(function (detail) {\n        variablesStore.addRulesForMatching(detail.rules);\n      });\n      variablesStore.matchVariablesAndDependants();\n      newManagers.forEach(function (manager) {\n        return manager.render(filter, ignoredImageAnalysisSelectors);\n      });\n      newManagers.forEach(function (manager) {\n        return manager.watch();\n      });\n      stylesToRestore.forEach(function (style) {\n        return styleManagers.get(style).restore();\n      });\n    }, function (shadowRoot) {\n      createShadowStaticStyleOverrides(shadowRoot);\n      handleAdoptedStyleSheets(shadowRoot);\n    });\n    watchForInlineStyles(function (element) {\n      overrideInlineStyle(element, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n\n      if (element === document.documentElement) {\n        var styleAttr = element.getAttribute('style');\n\n        if (styleAttr.includes('--')) {\n          variablesStore.matchVariablesAndDependants();\n          variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n        }\n      }\n    }, function (root) {\n      createShadowStaticStyleOverrides(root);\n      var inlineStyleElements = root.querySelectorAll(INLINE_STYLE_SELECTOR);\n\n      if (inlineStyleElements.length > 0) {\n        forEach(inlineStyleElements, function (el) {\n          return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n        });\n      }\n    });\n    addDOMReadyListener(onDOMReady);\n  }\n\n  function stopWatchingForUpdates() {\n    styleManagers.forEach(function (manager) {\n      return manager.pause();\n    });\n    stopStylePositionWatchers();\n    stopWatchingForStyleChanges();\n    stopWatchingForInlineStyles();\n    removeDOMReadyListener(onDOMReady);\n    cleanReadyStateCompleteListeners();\n  }\n\n  function createDarkReaderInstanceMarker() {\n    var metaElement = document.createElement('meta');\n    metaElement.name = 'darkreader';\n    metaElement.content = INSTANCE_ID;\n    document.head.appendChild(metaElement);\n  }\n\n  function isAnotherDarkReaderInstanceActive() {\n    var meta = document.querySelector('meta[name=\"darkreader\"]');\n\n    if (meta) {\n      if (meta.content !== INSTANCE_ID) {\n        return true;\n      }\n\n      return false;\n    }\n\n    createDarkReaderInstanceMarker();\n    return false;\n  }\n\n  function createOrUpdateDynamicTheme(filterConfig, dynamicThemeFixes, iframe) {\n    filter = filterConfig;\n    fixes = dynamicThemeFixes;\n\n    if (fixes) {\n      ignoredImageAnalysisSelectors = Array.isArray(fixes.ignoreImageAnalysis) ? fixes.ignoreImageAnalysis : [];\n      ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle) ? fixes.ignoreInlineStyle : [];\n    } else {\n      ignoredImageAnalysisSelectors = [];\n      ignoredInlineSelectors = [];\n    }\n\n    isIFrame$1 = iframe;\n\n    if (document.head) {\n      if (isAnotherDarkReaderInstanceActive()) {\n        return;\n      }\n\n      document.documentElement.setAttribute('data-darkreader-mode', 'dynamic');\n      document.documentElement.setAttribute('data-darkreader-scheme', filter.mode ? 'dark' : 'dimmed');\n      createThemeAndWatchForUpdates();\n    } else {\n      if (!isFirefox) {\n        var fallbackStyle = createOrUpdateStyle('darkreader--fallback');\n        document.documentElement.appendChild(fallbackStyle);\n        fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n          strict: true\n        });\n      }\n\n      var headObserver_1 = new MutationObserver(function () {\n        if (document.head) {\n          headObserver_1.disconnect();\n\n          if (isAnotherDarkReaderInstanceActive()) {\n            removeDynamicTheme();\n            return;\n          }\n\n          createThemeAndWatchForUpdates();\n        }\n      });\n      headObserver_1.observe(document, {\n        childList: true,\n        subtree: true\n      });\n    }\n  }\n\n  function removeProxy() {\n    document.dispatchEvent(new CustomEvent('__darkreader__cleanUp'));\n    removeNode(document.head.querySelector('.darkreader--proxy'));\n  }\n\n  function removeDynamicTheme() {\n    document.documentElement.removeAttribute(\"data-darkreader-mode\");\n    document.documentElement.removeAttribute(\"data-darkreader-scheme\");\n    cleanDynamicThemeCache();\n    removeNode(document.querySelector('.darkreader--fallback'));\n\n    if (document.head) {\n      restoreMetaThemeColor();\n      removeNode(document.head.querySelector('.darkreader--user-agent'));\n      removeNode(document.head.querySelector('.darkreader--text'));\n      removeNode(document.head.querySelector('.darkreader--invert'));\n      removeNode(document.head.querySelector('.darkreader--inline'));\n      removeNode(document.head.querySelector('.darkreader--override'));\n      removeNode(document.head.querySelector('.darkreader--variables'));\n      removeNode(document.head.querySelector('.darkreader--root-vars'));\n      removeNode(document.head.querySelector('meta[name=\"darkreader\"]'));\n      removeProxy();\n    }\n\n    shadowRootsWithOverrides.forEach(function (root) {\n      removeNode(root.querySelector('.darkreader--inline'));\n      removeNode(root.querySelector('.darkreader--override'));\n    });\n    shadowRootsWithOverrides.clear();\n    forEach(styleManagers.keys(), function (el) {\n      return removeManager(el);\n    });\n    loadingStyles.clear();\n    cleanLoadingLinks();\n    forEach(document.querySelectorAll('.darkreader'), removeNode);\n    adoptedStyleManagers.forEach(function (manager) {\n      manager.destroy();\n    });\n    adoptedStyleManagers.splice(0);\n  }\n\n  function cleanDynamicThemeCache() {\n    variablesStore.clear();\n    parsedURLCache.clear();\n    stopWatchingForDocumentVisibility();\n    cancelRendering();\n    stopWatchingForUpdates();\n    cleanModificationCache();\n  }\n\n  var blobRegex = /url\\(\\\"(blob\\:.*?)\\\"\\)/g;\n\n  function replaceBlobs(text) {\n    return __awaiter(this, void 0, void 0, function () {\n      var promises, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            promises = [];\n            getMatches(blobRegex, text, 1).forEach(function (url) {\n              var promise = loadAsDataURL(url);\n              promises.push(promise);\n            });\n            return [4, Promise.all(promises)];\n\n          case 1:\n            data = _a.sent();\n            return [2, text.replace(blobRegex, function () {\n              return \"url(\\\"\" + data.shift() + \"\\\")\";\n            })];\n        }\n      });\n    });\n  }\n\n  var banner = \"/*\\n                        _______\\n                       /       \\\\\\n                      .==.    .==.\\n                     ((  ))==((  ))\\n                    / \\\"==\\\"    \\\"==\\\"\\\\\\n                   /____|| || ||___\\\\\\n       ________     ____    ________  ___    ___\\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\\n                https://darkreader.org\\n*/\\n\\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/master/LICENSE */\\n\";\n\n  function collectCSS() {\n    return __awaiter(this, void 0, void 0, function () {\n      function addStaticCSS(selector, comment) {\n        var staticStyle = document.querySelector(selector);\n\n        if (staticStyle && staticStyle.textContent) {\n          css.push(\"/* \" + comment + \" */\");\n          css.push(staticStyle.textContent);\n          css.push('');\n        }\n      }\n\n      var css, modifiedCSS, formattedCSS, _a, _b;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            css = [banner];\n            addStaticCSS('.darkreader--fallback', 'Fallback Style');\n            addStaticCSS('.darkreader--user-agent', 'User-Agent Style');\n            addStaticCSS('.darkreader--text', 'Text Style');\n            addStaticCSS('.darkreader--invert', 'Invert Style');\n            addStaticCSS('.darkreader--variables', 'Variables Style');\n            modifiedCSS = [];\n            document.querySelectorAll('.darkreader--sync').forEach(function (element) {\n              forEach(element.sheet.cssRules, function (rule) {\n                rule && rule.cssText && modifiedCSS.push(rule.cssText);\n              });\n            });\n            if (!modifiedCSS.length) return [3, 2];\n            formattedCSS = formatCSS(modifiedCSS.join('\\n'));\n            css.push('/* Modified CSS */');\n            _b = (_a = css).push;\n            return [4, replaceBlobs(formattedCSS)];\n\n          case 1:\n            _b.apply(_a, [_c.sent()]);\n\n            css.push('');\n            _c.label = 2;\n\n          case 2:\n            addStaticCSS('.darkreader--override', 'Override Style');\n            return [2, css.join('\\n')];\n        }\n      });\n    });\n  }\n\n  var isDarkReaderEnabled = false;\n\n  var isIFrame = function () {\n    if (typeof window === 'undefined') return false;\n\n    try {\n      return window.self !== window.top;\n    } catch (err) {\n      console.warn(err);\n      return true;\n    }\n  }();\n\n  function enable(themeOptions, fixes) {\n    if (themeOptions === void 0) {\n      themeOptions = {};\n    }\n\n    if (fixes === void 0) {\n      fixes = null;\n    }\n\n    var theme = _assign(_assign({}, DEFAULT_THEME), themeOptions);\n\n    if (theme.engine !== ThemeEngines.dynamicTheme) {\n      throw new Error('Theme engine is not supported.');\n    }\n\n    createOrUpdateDynamicTheme(theme, fixes, isIFrame);\n    isDarkReaderEnabled = true;\n  }\n\n  function isEnabled() {\n    return isDarkReaderEnabled;\n  }\n\n  function disable() {\n    removeDynamicTheme();\n    isDarkReaderEnabled = false;\n  }\n\n  var store = {\n    themeOptions: null,\n    fixes: null\n  };\n\n  function handleColorScheme() {\n    var darkScheme = matchMedia('(prefers-color-scheme: dark)');\n\n    if (darkScheme.matches) {\n      enable(store.themeOptions, store.fixes);\n    } else {\n      disable();\n    }\n  }\n\n  function auto(themeOptions, fixes) {\n    if (themeOptions === void 0) {\n      themeOptions = {};\n    }\n\n    if (fixes === void 0) {\n      fixes = null;\n    }\n\n    var darkScheme = matchMedia('(prefers-color-scheme: dark)');\n\n    if (themeOptions) {\n      store = {\n        themeOptions: themeOptions,\n        fixes: fixes\n      };\n      handleColorScheme();\n\n      if (isMatchMediaChangeEventListenerSupported) {\n        darkScheme.addEventListener('change', handleColorScheme);\n      } else {\n        darkScheme.addListener(handleColorScheme);\n      }\n    } else {\n      if (isMatchMediaChangeEventListenerSupported) {\n        darkScheme.removeEventListener('change', handleColorScheme);\n      } else {\n        darkScheme.removeListener(handleColorScheme);\n      }\n\n      disable();\n    }\n  }\n\n  function exportGeneratedCSS() {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, collectCSS()];\n\n          case 1:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  var setFetchMethod = setFetchMethod$1;\n  exports.auto = auto;\n  exports.disable = disable;\n  exports.enable = enable;\n  exports.exportGeneratedCSS = exportGeneratedCSS;\n  exports.isEnabled = isEnabled;\n  exports.setFetchMethod = setFetchMethod;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["/Users/jameszow/Documents/RustWorkSpace/covid-ipfs/covid-ipfs-client/node_modules/@umijs/ssr-darkreader/darkreader.js"],"names":["global","factory","exports","module","define","amd","globalThis","self","DarkReader","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","__read","r","ar","error","__spreadArray","to","from","pack","l","Array","slice","concat","MessageType","UI_GET_DATA","UI_GET_ACTIVE_TAB_INFO","UI_SUBSCRIBE_TO_CHANGES","UI_UNSUBSCRIBE_FROM_CHANGES","UI_CHANGE_SETTINGS","UI_SET_THEME","UI_SET_SHORTCUT","UI_TOGGLE_URL","UI_MARK_NEWS_AS_READ","UI_LOAD_CONFIG","UI_APPLY_DEV_DYNAMIC_THEME_FIXES","UI_RESET_DEV_DYNAMIC_THEME_FIXES","UI_APPLY_DEV_INVERSION_FIXES","UI_RESET_DEV_INVERSION_FIXES","UI_APPLY_DEV_STATIC_THEMES","UI_RESET_DEV_STATIC_THEMES","UI_SAVE_FILE","UI_REQUEST_EXPORT_CSS","BG_CHANGES","BG_ADD_CSS_FILTER","BG_ADD_STATIC_THEME","BG_ADD_SVG_FILTER","BG_ADD_DYNAMIC_THEME","BG_EXPORT_CSS","BG_UNSUPPORTED_SENDER","BG_CLEAN_UP","BG_RELOAD","BG_FETCH_RESPONSE","BG_UI_UPDATE","BG_CSS_UPDATE","CS_COLOR_SCHEME_CHANGE","CS_FRAME_CONNECT","CS_FRAME_FORGET","CS_FRAME_FREEZE","CS_FRAME_RESUME","CS_EXPORT_CSS_RESPONSE","CS_FETCH","userAgent","navigator","toLowerCase","platform","isChromium","includes","isThunderbird","isFirefox","isSafari","isWindows","startsWith","isMacOS","isShadowDomSupported","ShadowRoot","isMatchMediaChangeEventListenerSupported","MediaQueryList","addEventListener","match","isDefinedSelectorSupported","document","querySelector","err","chrome","runtime","getManifest","manifest_version","getOKResponse","url","mimeType","origin","response","_a","fetch","cache","credentials","referrer","endsWith","headers","get","Error","ok","status","statusText","loadAsDataURL","readResponseAsDataURL","blob","dataURL","reader","FileReader","onloadend","readAsDataURL","throwCORSError","join","fetcher","setFetchMethod$1","callFetchMethod","initChrome","window","messageListeners","Set","sendMessage","args","_i","id_1","responseType","text_1","error_1","_b","type","id","data","text","forEach","cb","console","addMessageListener","callback","add","nativeSendMessage_1","onMessage","addListener","nativeAddListener_1","ThemeEngines","cssFilter","svgFilter","staticTheme","dynamicTheme","DEFAULT_COLORS","darkScheme","background","lightScheme","DEFAULT_THEME","mode","brightness","contrast","grayscale","sepia","useFont","fontFamily","textStroke","engine","stylesheet","darkSchemeBackgroundColor","darkSchemeTextColor","lightSchemeBackgroundColor","lightSchemeTextColor","scrollbarColor","selectionColor","styleSystemControls","lightColorScheme","darkColorScheme","isArrayLike","items","e_1","len","items_1","items_1_1","item","e_1_1","return","array","addition","a","toArray","results","logInfo","logWarn","throttle","pending","frameId","lastArgs","throttled","requestAnimationFrame","cancel","cancelAnimationFrame","createAsyncTasksQueue","tasks","runTasks","task","shift","splice","getDuration","time","duration","seconds","minutes","hours","days","removeNode","node","parentNode","removeChild","watchForNodePosition","onRestore","Function","MAX_ATTEMPTS_COUNT","RETRY_TIMEOUT","ATTEMPTS_INTERVAL","prevSibling","previousSibling","parent","attempts","start","timeoutId","restore","now","Date","setTimeout","stop","updateParent","insertBefore","nextSibling","firstChild","observer","takeRecords","MutationObserver","run","observe","childList","clearTimeout","disconnect","skip","iterateShadowHosts","root","walker","createTreeWalker","NodeFilter","SHOW_ELEMENT","acceptNode","shadowRoot","FILTER_SKIP","FILTER_ACCEPT","currentNode","nextNode","isDOMReady","readyState","readyStateListeners","addDOMReadyListener","listener","removeDOMReadyListener","delete","isReadyStateComplete","readyStateCompleteListeners","addReadyStateCompleteListener","cleanReadyStateCompleteListeners","clear","onReadyStateChange_1","removeEventListener","HUGE_MUTATIONS_COUNT","isHugeMutation","mutations","addedNodesCount","addedNodes","getElementsTreeOperations","additions","deletions","moves","Element","isConnected","removedNodes","duplicateAdditions","duplicateDeletions","has","parentElement","optimizedTreeObservers","Map","optimizedTreeCallbacks","WeakMap","createOptimizedTreeObserver","callbacks","observerCallbacks","domReadyListener","hadHugeMutationsBefore_1","subscribedForReadyState_1","onHugeMutations","elementsOperations_1","onMinorMutations","subtree","set","size","anchor","parsedURLCache","fixBaseURL","$url","createElement","href","parseURL","$base","key","parsedURL_1","URL","parsedURL","getAbsoluteURL","$relative","test","location","protocol","b","isRelativeHrefOnAbsolutePath","hostname","port","pathname","iterateCSSRules","rules","iterate","onMediaRuleError","rule","selectorText","styleSheet","cssRules","media","isScreenOrAllOrQuery","some","isPrintOrSpeech","conditionText","CSS","supports","shorthandVarDependantProperties","shorthandVarDepPropRegexps","map","prop","regexp","RegExp","iterateCSSDeclarations","style","property","getPropertyValue","trim","cssText","val","cssURLRegex","cssImportRegex","getCSSURLValue","cssURL","replace","getCSSBaseBath","replaceCSSRelativeURLsWithAbsolute","$css","cssBasePath","pathValue","cssCommentsRegex","removeCSSComments","fontFaceRegex","replaceCSSFontFace","hslToRGB","h","_c","x","Math","round","r_1","b_1","g_1","c","abs","_d","rgbToHSL","r255","g255","b255","max","min","toFixed","digits","fixed","dot","indexOf","zerosMatch","index","substring","rgbToString","rgb","rgbToHexString","toString","hslToString","hsl","rgbMatch","hslMatch","hexMatch","parse","$color","parseRGB","parseHSL","parseHex","knownColors","getColorByName","systemColors","getSystemColor","getNumbers","numbers","prevPos","isMining","startIndex","getNumbersFromString","str","range","units","raw","unitsList","entries","unit","find","u","parseFloat","rgbRange","rgbUnits","$rgb","hslRange","hslUnits","PI","$hsl","$hex","parseInt","isCharDigit","char","getAmountOfDigits","number","floor","log10","lowerCalcExpression","color","searchIndex","replaceBetweenIndices","end","replacement","getNumber","resultNumber","Number","lenDigits","possibleType","firstNumber","operation","secondNumber","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","ActiveBorder","ActiveCaption","AppWorkspace","Background","ButtonFace","ButtonHighlight","ButtonShadow","ButtonText","CaptionText","GrayText","Highlight","HighlightText","InactiveBorder","InactiveCaption","InactiveCaptionText","InfoBackground","InfoText","Menu","MenuText","Scrollbar","ThreeDDarkShadow","ThreeDFace","ThreeDHighlight","ThreeDLightShadow","ThreeDShadow","Window","WindowFrame","WindowText","scale","inLow","inHigh","outLow","outHigh","clamp","multiplyMatrices","m1","m2","j","len2","sum","k","len3","getMatches","regex","input","group","matches","exec","formatCSS","trimLeft","getIndent","depth","repeat","emptyRuleRegexp","css","split","formatted","line","getParenthesesRange","searchStartIndex","firstOpenIndex","openIndex","closingIndex","createFilterMatrix","config","Matrix","identity","invertNHue","applyColorMatrix","matrix","getBgPole","theme","isDarkScheme","getFgPole","colorModificationCache","colorParseCache$1","parseToHSLWithCache","clearColorModificationCache","rgbCacheKeys","themeCacheKeys$1","getCacheId","resultId","modifyColorWithCache","modifyHSL","poleColor","anotherPoleColor","fnCache","pole","anotherPole","modified","rf","gf","bf","noopHSL","modifyColor","modifyLightSchemeColor","poleBg","poleFg","modifyLightModeHSL","isDark","isNeutral","isBlue","hx","sx","lx","MAX_BG_LIGHTNESS","modifyBgHSL","lx_1","hx_1","hx_2","isYellow","isCloserToGreen","modifyBackgroundColor","MIN_FG_LIGHTNESS","modifyBlueFgHue","hue","modifyFgHSL","isLight","lx_2","hx_3","hx_4","hx_5","lx_3","modifyForegroundColor","modifyBorderHSL","modifyBorderColor","modifyShadowColor","filter","modifyGradientColor","createTextStyle","lines","FilterMode","getCSSFilterValue","filters","dark","toSVGMatrix","getSVGFilterMatrixValue","counter","resolvers$1","rejectors","bgFetch","request","AsyncQueue","queue","timerId","frameDuration","addToQueue","entry","startQueue","stopQueue","_this","imageManager","getImageDetails","image_1","error_2","getImageDataURL","urlToImage","src","width","naturalWidth","height","naturalHeight","analyzeImage","image","Image","onload","onerror","MAX_ANALIZE_PIXELS_COUNT","canvas","context","createCanvas","maxWidth","maxHeight","getContext","imageSmoothingEnabled","removeCanvas","MAX_IMAGE_SIZE","currentSrc","isTransparent","isLarge","isTooLarge","naturalPixelsCount","sqrt","ceil","clearRect","drawImage","imageData","getImageData","d","TRANSPARENT_ALPHA_THRESHOLD","DARK_LIGHTNESS_THRESHOLD","LIGHT_LIGHTNESS_THRESHOLD","transparentPixelsCount","darkPixelsCount","lightPixelsCount","totalPixelsCount","opaquePixelsCount","DARK_IMAGE_THRESHOLD","LIGHT_IMAGE_THRESHOLD","TRANSPARENT_IMAGE_THRESHOLD","LARGE_IMAGE_PIXELS_COUNT","getFilteredImageDataURL","svg","btoa","cleanImageProcessingCache","getPriority","ruleStyle","Boolean","getPropertyPriority","getModifiableCSSDeclaration","variablesStore","ignoreImageSelectors","isCancelled","modifier","getVariableModifier","important","sourceValue","getVariableDependantModifier","getColorModifier","getBgImageModifier","getShadowModifier","getModifiedUserAgentStyle","isIFrame","getModifiedScrollbarStyle","getModifiedSelectionStyle","getSelectionColor","backgroundColorSelection","foregroundColorSelection","modifiedSelectionColor","selection","colorTrack","colorIcons","colorThumb","colorThumbHover","colorThumbActive","colorCorner","hsl_1","lighten","lighter","darken","darker","getModifiedFallbackStyle","strict","isMicrosoft","unparsableColors","colorParseCache","parseColorWithCache","tryParseColor","rgb_1","gradientRegex","imageDetailsCache","awaitingForImageLoading","shouldIgnoreImage","selectors","ruleSelectors","_loop_1","ignoredSelector","state_1","gradients","urls","getIndices","valueIndex","matches_1","sort","getGradientModifier_1","gradient","content","partsRegex","colorStopRegex","parts","part","space","lastIndexOf","colorStopMatch","modify","getURLModifier_1","urlValue","parentStyleSheet","baseURL","ownerNode","baseURI","absoluteValue","imageDetails","awaiters_1","err_1","bgImageValue","getBgImageValue_1","inverted","dimmed","filtered","modifiers_1","index_1","matchStart","prefixStart","matchEnd","all","asyncResults","getShadowModifierWithInfo","index_2","colorMatches_1","notParsed_1","modifiers_2","prefixIndex","matchIndex","matchesLength","unparseableMatchesLength","shadowModifier","ignoredImgSelectors","getModifierForVariable","varName","getModifierForVarDependant","cleanModificationCache","VAR_TYPE_BGCOLOR","VAR_TYPE_TEXTCOLOR","VAR_TYPE_BORDERCOLOR","VAR_TYPE_BGIMG","VariablesStore","varTypes","rulesQueue","definedVars","varRefs","unknownColorVars","unknownBgVars","undefinedVars","initialVarTypes","changedTypeVars","typeChangeSubscriptions","unstableVarValues","isVarType","typeNum","addRulesForMatching","matchVariablesAndDependants","collectRootVariables","collectVariablesAndVarDep","collectRootVarDependants","refs","resolveVariableType","hasColor","findVarRef","ref","itarateVarRefs","options","getDeclarations","declarations","addModifiedValue","varNameWrapper","colorModifier","modifiedValue","isVarDependant","isConstructedColorVar","insertVarValues","replaceCSSVariablesNames","fallback","wrapBgColorVariableName","tryModifyBgColor","wrapTextColorVariableName","tryModifyTextColor","wrapBorderColorVariableName","tryModifyBorderColor","wrapBgImgVariableName","bgModifier","onTypeChange","decs","subscribeForVarTypeChange","removeListeners","unsubscribeFromVariableTypeChanges","isBg_1","isText_1","unknownVars","variableReplaced","modifiedShadow","firstUnknownVar","values","newValue","rootStore","ruleList","isVariable","inspectVariable","inspectVarDependant","documentElement","initialType","currentType","newType","iterateVarDeps","isBgColor","varDeps","iterateVarDependencies","stack","refs_1","refs_1_1","found","setOnRootVariableChange","onRootVariableDefined","putRootVars","styleElement","e_2","sheet","deleteRule","cssLines","declarations_1","declarations_1_1","e_2_1","insertRule","getVariableRange","searchStart","getVariablesMatches","ranges","replaceVariablesMatches","replacer","matchesCount","inputLength","replacements","getVariableNameAndFallback","commaIndex","name","nameReplacer","fallbackReplacer","matchReplacer","newName","newFallback","rawValueRegex","parseRawValue","splitted","resultInRGB_1","substr","isRaw","handleRawValue","modifyFunction","newColor","outputColor","outputInRGB","source","varValues","containsUnresolvedVar","varValue","inserted","replaced","overrides","customProp","cssProp","dataAttr","overridesList","normalizedPropList","INLINE_STYLE_ATTRS","INLINE_STYLE_SELECTOR","attr","getInlineOverrideStyle","getInlineStyleElements","Document","querySelectorAll","treeObservers","attrObservers","watchForInlineStyles","elementStyleDidChange","shadowRootDiscovered","deepWatchForInlineStyles","host","discoveredNodes","WeakSet","discoverNodes","el","treeObserver","added","attemptCount","handleAttributeMutations","attributeName","target","attrObserver","attributeCache","attributes","attributeFilter","stopWatchingForInlineStyles","inlineStyleCache","filterProps","getInlineStyleCacheKey","getAttribute","shouldIgnoreInlineStyle","element","ingnoredSelector","overrideInlineStyle","ignoreInlineSelectors","cacheKey","unsetProps","keys","setCustomProp","targetCSSProp","modifierCSSProp","cssVal","mod","setProperty","hasAttribute","setAttribute","removeAttribute","rel","SVGElement","SMALL_SVG_LIMIT_1","value_1","SVGTextElement","handleSVGElement","getBoundingClientRect","isBg","SVGLineElement","overridenProp","fill","metaThemeColorName","metaThemeColorSelector","srcMetaThemeColor","changeMetaThemeColor","meta","changeMetaThemeColorWhenAvailable","loop","HTMLMetaElement","head","restoreMetaThemeColor","themeCacheKeys","getThemeKey","asyncQueue","createStyleSheetModifier","renderId","rulesTextCache","rulesModCache","varTypeChangeCleaners","prevFilterKey","hasNonLoadedLink","wasRebuilt","shouldRebuildStyle","modifySheet","sourceCSSRules","ignoreImageAnalysis","force","prepareSheet","isAsyncCancelled","rulesChanged","notFoundCacheKeys","themeKey","themeChanged","modRules","textDiffersFromPrev","parentRule","CSSMediaRule","mediaText","modDecs","modRule","selector","setRule","getDeclarationText","dec","cssRulesText","ruleText","asyncDeclarations","varDeclarations","asyncDeclarationCounter","varDeclarationCounter","rootReadyGroup","isGroup","groupRefs","getGroup","parentGroup","readyStyleRule","readyDeclarations","handleAsyncDeclaration","asyncKey","asyncDeclaration","currentRenderId","asyncValue","rebuildAsyncRule","handleVarDeclarations","varDecs","varKey","initialIndex","oldDecs","tempDec","readyDec","newDecs","readyVarDecs","rebuildVarRule","buildStyleSheet","createTarget","iterateReadyRules","styleIterator","STYLE_SELECTOR","shouldManageStyle","HTMLStyleElement","SVGStyleElement","HTMLLinkElement","disabled","classList","contains","getManageableStyles","deep","syncStyleSet","corsStyleSet","canOptimizeUsingProxy$1","loadingLinkCounter","rejectorsForLoadingLinks","cleanLoadingLinks","manageStyle","update","loadingStart","loadingEnd","prevStyles","nextElementSibling","corsCopy","syncStyle","corsCopyPositionWatcher","syncStylePositionWatcher","cancelAsyncOperations","isOverrideEmpty","sheetModifier","observerOptions","characterData","containsCSSImport","textContent","hasImports","checkCrossOrigin","cssRulesLoop","getRulesSync","safeGetSheetRules","insertStyle","createSyncStyle","createElementNS","title","isLoadingRules","wasLoadingError","loadingLinkId","getRulesAsync","accessError","fullCSSText","err_2","getRulesOrError","isStillLoadingError","linkLoading","loadText","replaceCSSImports","createCORSCopy","details","secondRound","catch","forceRenderStyle","render","removeCSSRulesFromSheet","replaceSync","prepareOverridesSheet","buildOverrides","message","watchForSheetChanges","watchForSheetChangesUsingProxy","watchForSheetChangesUsingRAF","rulesChangeKey","rulesCheckFrameId","getRulesChangeKey","didRulesKeyChange","stopWatchingForSheetChangesUsingRAF","checkForUpdate","areSheetChangesPending","onSheetChange","handleSheetChanges","queueMicrotask","stopWatchingForSheetChangesUsingProxy","stopWatchingForSheetChanges","pause","destroy","watch","maxMoveCount","moveCount","link","loadingId","cleanUp","onLoad","onError","getCSSImportURL","importDeclaration","basePath","importMatches","importMatches_1","importMatches_1_1","importURL","absoluteURL","importedCSS","err_3","srcElement","cors","observers","observedRoots","undefinedGroups","elementsDefinitionCallback","collectUndefinedElements","tag","tagName","extendedTag","customElementsWhenDefined","elements","canOptimizeUsingProxy","resolvers","handleIsDefined","detail","customElements","whenDefined","dispatchEvent","CustomEvent","checkIfDefined_1","watchWhenCustomElementsDefined","unsubscribeFromDefineCustomElements","watchForStyleChanges","currentStyles","stopWatchingForStyleChanges","prevStyleSiblings","nextStyleSiblings","saveStylePosition","previousElementSibling","forgetStylePosition","didStylePositionChange","handleStyleOperations","operations","createdStyles","removedStyles","movedStyles","created","removed","moved","updated","handleMinorTreeMutations","subscribeForShadowRootChanges","handleHugeTreeMutations","styles","updatedStyles","hosts","newStyles","resetObservers","hexify","generateUID","crypto","uuid","randomUUID","getRandomValues","Uint8Array","adoptedStyleOverrides","overrideList","createAdoptedStyleSheetOverride","injectSheet","override","newSheets","adoptedStyleSheets","sheetIndex","existingIndex","adoptedStyleSheet","CSSStyleSheet","injectProxy","enableStyleSheetsProxy","addRuleDescriptor","getOwnPropertyDescriptor","insertRuleDescriptor","deleteRuleDescriptor","removeRuleDescriptor","documentStyleSheetsDescriptor","shouldWrapHTMLElement","getElementsByTagNameDescriptor","defineProperty","addUndefinedResolver","updateSheetEvent","Event","proxyAddRule","proxyInsertRule","returnValue","proxyDeleteRule","proxyRemoveRule","proxyDocumentStyleSheets","docSheets","setPrototypeOf","StyleSheetList","proxyGetElementsByTagName","getCurrentElementValue","NodeList","NodeListBehavior","Proxy","INSTANCE_ID","styleManagers","adoptedStyleManagers","fixes","isIFrame$1","ignoredImageAnalysisSelectors","ignoredInlineSelectors","createOrUpdateStyle","className","createOrUpdateScript","nodePositionWatchers","setupNodePositionWatcher","alias","stopStylePositionWatchers","watcher","createStaticStyleOverrides","fallbackStyle","userAgentStyle","textStyle","invertStyle","isArray","invert","inlineStyle","overrideStyle","replaceCSSTemplates","appendChild","variableStyle","selectionColors","schemeBackgroundColor","schemeTextColor","rootVarsStyle","proxyScript","append","disableStyleSheetsProxy","remove","shadowRootsWithOverrides","createShadowStaticStyleOverrides","$cssText","cleanFallbackStyle","createDynamicStyleOverrides","cancelRendering","allStyles","newManagers","createManager","manager","loadingStyles","inlineStyleElements","handleAdoptedStyleSheets","loadingStylesCounter","loadingStyleId","didDocumentShowUp","removeManager","throttledRenderAllStyles","onDOMReady","documentVisibilityListener","hidden","watchForDocumentVisibility","alreadyWatching","stopWatchingForDocumentVisibility","createThemeAndWatchForUpdates","runDynamicStyle","watchForUpdates","newManger","managedStyles","stylesToRemove","stylesToManage","stylesToRestore","styleAttr","stopWatchingForUpdates","createDarkReaderInstanceMarker","metaElement","isAnotherDarkReaderInstanceActive","createOrUpdateDynamicTheme","filterConfig","dynamicThemeFixes","iframe","ignoreInlineStyle","headObserver_1","removeDynamicTheme","removeProxy","cleanDynamicThemeCache","blobRegex","replaceBlobs","promises","promise","banner","collectCSS","addStaticCSS","comment","staticStyle","modifiedCSS","formattedCSS","isDarkReaderEnabled","top","warn","enable","themeOptions","isEnabled","disable","store","handleColorScheme","matchMedia","auto","removeListener","exportGeneratedCSS","setFetchMethod"],"mappings":"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","sourcesContent":["/**\n * Dark Reader v4.9.45\n * https://darkreader.org/\n */\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.DarkReader = {}));\n})(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation.\r\n\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n    purpose with or without fee is hereby granted.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n    PERFORMANCE OF THIS SOFTWARE.\r\n    ***************************************************************************** */\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\r\n\r\n    function __awaiter(thisArg, _arguments, P, generator) {\r\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    }\r\n\r\n    function __generator(thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    }\r\n\r\n    function __values(o) {\r\n        var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n        if (m) return m.call(o);\r\n        if (o && typeof o.length === \"number\") return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n        throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n    }\r\n\r\n    function __read(o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    }\r\n\r\n    function __spreadArray(to, from, pack) {\r\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n            if (ar || !(i in from)) {\r\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n                ar[i] = from[i];\r\n            }\r\n        }\r\n        return to.concat(ar || Array.prototype.slice.call(from));\r\n    }\n\n    var MessageType = {\r\n        UI_GET_DATA: 'ui-get-data',\r\n        UI_GET_ACTIVE_TAB_INFO: 'ui-get-active-tab-info',\r\n        UI_SUBSCRIBE_TO_CHANGES: 'ui-subscribe-to-changes',\r\n        UI_UNSUBSCRIBE_FROM_CHANGES: 'ui-unsubscribe-from-changes',\r\n        UI_CHANGE_SETTINGS: 'ui-change-settings',\r\n        UI_SET_THEME: 'ui-set-theme',\r\n        UI_SET_SHORTCUT: 'ui-set-shortcut',\r\n        UI_TOGGLE_URL: 'ui-toggle-url',\r\n        UI_MARK_NEWS_AS_READ: 'ui-mark-news-as-read',\r\n        UI_LOAD_CONFIG: 'ui-load-config',\r\n        UI_APPLY_DEV_DYNAMIC_THEME_FIXES: 'ui-apply-dev-dynamic-theme-fixes',\r\n        UI_RESET_DEV_DYNAMIC_THEME_FIXES: 'ui-reset-dev-dynamic-theme-fixes',\r\n        UI_APPLY_DEV_INVERSION_FIXES: 'ui-apply-dev-inversion-fixes',\r\n        UI_RESET_DEV_INVERSION_FIXES: 'ui-reset-dev-inversion-fixes',\r\n        UI_APPLY_DEV_STATIC_THEMES: 'ui-apply-dev-static-themes',\r\n        UI_RESET_DEV_STATIC_THEMES: 'ui-reset-dev-static-themes',\r\n        UI_SAVE_FILE: 'ui-save-file',\r\n        UI_REQUEST_EXPORT_CSS: 'ui-request-export-css',\r\n        BG_CHANGES: 'bg-changes',\r\n        BG_ADD_CSS_FILTER: 'bg-add-css-filter',\r\n        BG_ADD_STATIC_THEME: 'bg-add-static-theme',\r\n        BG_ADD_SVG_FILTER: 'bg-add-svg-filter',\r\n        BG_ADD_DYNAMIC_THEME: 'bg-add-dynamic-theme',\r\n        BG_EXPORT_CSS: 'bg-export-css',\r\n        BG_UNSUPPORTED_SENDER: 'bg-unsupported-sender',\r\n        BG_CLEAN_UP: 'bg-clean-up',\r\n        BG_RELOAD: 'bg-reload',\r\n        BG_FETCH_RESPONSE: 'bg-fetch-response',\r\n        BG_UI_UPDATE: 'bg-ui-update',\r\n        BG_CSS_UPDATE: 'bg-css-update',\r\n        CS_COLOR_SCHEME_CHANGE: 'cs-color-scheme-change',\r\n        CS_FRAME_CONNECT: 'cs-frame-connect',\r\n        CS_FRAME_FORGET: 'cs-frame-forget',\r\n        CS_FRAME_FREEZE: 'cs-frame-freeze',\r\n        CS_FRAME_RESUME: 'cs-frame-resume',\r\n        CS_EXPORT_CSS_RESPONSE: 'cs-export-css-response',\r\n        CS_FETCH: 'cs-fetch',\r\n    };\n\n    var userAgent = typeof navigator === 'undefined' ? 'some useragent' : navigator.userAgent.toLowerCase();\r\n    var platform = typeof navigator === 'undefined' ? 'some platform' : navigator.platform.toLowerCase();\r\n    var isChromium = userAgent.includes('chrome') || userAgent.includes('chromium');\r\n    var isThunderbird = userAgent.includes('thunderbird');\r\n    var isFirefox = userAgent.includes('firefox') || userAgent.includes('librewolf') || isThunderbird;\r\n    userAgent.includes('vivaldi');\r\n    userAgent.includes('yabrowser');\r\n    userAgent.includes('opr') || userAgent.includes('opera');\r\n    userAgent.includes('edg');\r\n    var isSafari = userAgent.includes('safari') && !isChromium;\r\n    var isWindows = platform.startsWith('win');\r\n    var isMacOS = platform.startsWith('mac');\r\n    userAgent.includes('mobile');\r\n    var isShadowDomSupported = typeof ShadowRoot === 'function';\r\n    var isMatchMediaChangeEventListenerSupported = (typeof MediaQueryList === 'function' &&\r\n        typeof MediaQueryList.prototype.addEventListener === 'function');\r\n    ((function () {\r\n        var m = userAgent.match(/chrom[e|ium]\\/([^ ]+)/);\r\n        if (m && m[1]) {\r\n            return m[1];\r\n        }\r\n        return '';\r\n    }))();\r\n    var isDefinedSelectorSupported = (function () {\r\n        try {\r\n            document.querySelector(':defined');\r\n            return true;\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    })();\r\n    typeof globalThis !== 'undefined' && globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.getManifest && globalThis.chrome.runtime.getManifest().manifest_version === 3;\n\n    function getOKResponse(url, mimeType, origin) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, fetch(url, {\r\n                            cache: 'force-cache',\r\n                            credentials: 'omit',\r\n                            referrer: origin\r\n                        })];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        if (isFirefox && mimeType === 'text/css' && url.startsWith('moz-extension://') && url.endsWith('.css')) {\r\n                            return [2, response];\r\n                        }\r\n                        if (mimeType && !response.headers.get('Content-Type').startsWith(mimeType)) {\r\n                            throw new Error(\"Mime type mismatch when loading \" + url);\r\n                        }\r\n                        if (!response.ok) {\r\n                            throw new Error(\"Unable to load \" + url + \" \" + response.status + \" \" + response.statusText);\r\n                        }\r\n                        return [2, response];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function loadAsDataURL(url, mimeType) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, getOKResponse(url, mimeType)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        return [4, readResponseAsDataURL(response)];\r\n                    case 2: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function readResponseAsDataURL(response) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var blob, dataURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, response.blob()];\r\n                    case 1:\r\n                        blob = _a.sent();\r\n                        return [4, (new Promise(function (resolve) {\r\n                                var reader = new FileReader();\r\n                                reader.onloadend = function () { return resolve(reader.result); };\r\n                                reader.readAsDataURL(blob);\r\n                            }))];\r\n                    case 2:\r\n                        dataURL = _a.sent();\r\n                        return [2, dataURL];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    var throwCORSError = function (url) { return __awaiter(void 0, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2, Promise.reject(new Error([\r\n                    'Embedded Dark Reader cannot access a cross-origin resource',\r\n                    url,\r\n                    'Overview your URLs and CORS policies or use',\r\n                    '`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.',\r\n                    'See if using `DarkReader.setFetchMethod(window.fetch)`',\r\n                    'before `DarkReader.enable()` works.'\r\n                ].join(' ')))];\r\n        });\r\n    }); };\r\n    var fetcher = throwCORSError;\r\n    function setFetchMethod$1(fetch) {\r\n        if (fetch) {\r\n            fetcher = fetch;\r\n        }\r\n        else {\r\n            fetcher = throwCORSError;\r\n        }\r\n    }\r\n    function callFetchMethod(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, fetcher(url)];\r\n                    case 1: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    function initChrome() {\r\n        if (typeof chrome === 'undefined')\r\n            return;\r\n        if (typeof window !== 'undefined' && !window.chrome) {\r\n            window.chrome = {};\r\n        }\r\n        if (typeof chrome !== 'undefined' && !chrome.runtime) {\r\n            chrome.runtime = {};\r\n        }\r\n        var messageListeners = new Set();\r\n        function sendMessage() {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var id_1, _a, url, responseType, response, text_1, error_1;\r\n                return __generator(this, function (_b) {\r\n                    switch (_b.label) {\r\n                        case 0:\r\n                            if (!(args[0] && args[0].type === MessageType.CS_FETCH)) return [3, 8];\r\n                            id_1 = args[0].id;\r\n                            _b.label = 1;\r\n                        case 1:\r\n                            _b.trys.push([1, 7, , 8]);\r\n                            _a = args[0].data, url = _a.url, responseType = _a.responseType;\r\n                            return [4, callFetchMethod(url)];\r\n                        case 2:\r\n                            response = _b.sent();\r\n                            if (!(responseType === 'data-url')) return [3, 4];\r\n                            return [4, readResponseAsDataURL(response)];\r\n                        case 3:\r\n                            text_1 = _b.sent();\r\n                            return [3, 6];\r\n                        case 4: return [4, response.text()];\r\n                        case 5:\r\n                            text_1 = _b.sent();\r\n                            _b.label = 6;\r\n                        case 6:\r\n                            messageListeners.forEach(function (cb) { return cb({ type: MessageType.BG_FETCH_RESPONSE, data: text_1, error: null, id: id_1 }); });\r\n                            return [3, 8];\r\n                        case 7:\r\n                            error_1 = _b.sent();\r\n                            console.error(error_1);\r\n                            messageListeners.forEach(function (cb) { return cb({ type: MessageType.BG_FETCH_RESPONSE, data: null, error: error_1, id: id_1 }); });\r\n                            return [3, 8];\r\n                        case 8: return [2];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function addMessageListener(callback) {\r\n            messageListeners.add(callback);\r\n        }\r\n        if (typeof chrome.runtime.sendMessage === 'function') {\r\n            var nativeSendMessage_1 = chrome.runtime.sendMessage;\r\n            chrome.runtime.sendMessage = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                sendMessage.apply(void 0, __spreadArray([], __read(args), false));\r\n                nativeSendMessage_1.apply(chrome.runtime, args);\r\n            };\r\n        }\r\n        else {\r\n            chrome.runtime.sendMessage = sendMessage;\r\n        }\r\n        if (!chrome.runtime.onMessage) {\r\n            chrome.runtime.onMessage = {};\r\n        }\r\n        if (typeof chrome.runtime.onMessage.addListener === 'function') {\r\n            var nativeAddListener_1 = chrome.runtime.onMessage.addListener;\r\n            chrome.runtime.onMessage.addListener = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                addMessageListener(args[0]);\r\n                nativeAddListener_1.apply(chrome.runtime.onMessage, args);\r\n            };\r\n        }\r\n        else {\r\n            chrome.runtime.onMessage.addListener = function () {\r\n                var args = [];\r\n                for (var _i = 0; _i < arguments.length; _i++) {\r\n                    args[_i] = arguments[_i];\r\n                }\r\n                return addMessageListener(args[0]);\r\n            };\r\n        }\r\n    }\r\n    initChrome();\n\n    var ThemeEngines = {\r\n        cssFilter: 'cssFilter',\r\n        svgFilter: 'svgFilter',\r\n        staticTheme: 'staticTheme',\r\n        dynamicTheme: 'dynamicTheme',\r\n    };\n\n    var DEFAULT_COLORS = {\r\n        darkScheme: {\r\n            background: '#181a1b',\r\n            text: '#e8e6e3',\r\n        },\r\n        lightScheme: {\r\n            background: '#dcdad7',\r\n            text: '#181a1b',\r\n        },\r\n    };\r\n    var DEFAULT_THEME = {\r\n        mode: 1,\r\n        brightness: 100,\r\n        contrast: 100,\r\n        grayscale: 0,\r\n        sepia: 0,\r\n        useFont: false,\r\n        fontFamily: isMacOS ? 'Helvetica Neue' : isWindows ? 'Segoe UI' : 'Open Sans',\r\n        textStroke: 0,\r\n        engine: ThemeEngines.dynamicTheme,\r\n        stylesheet: '',\r\n        darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\r\n        darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\r\n        lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\r\n        lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\r\n        scrollbarColor: isMacOS ? '' : 'auto',\r\n        selectionColor: 'auto',\r\n        styleSystemControls: true,\r\n        lightColorScheme: 'Default',\r\n        darkColorScheme: 'Default',\r\n    };\n\n    function isArrayLike(items) {\r\n        return items.length != null;\r\n    }\r\n    function forEach(items, iterator) {\r\n        var e_1, _a;\r\n        if (isArrayLike(items)) {\r\n            for (var i = 0, len = items.length; i < len; i++) {\r\n                iterator(items[i]);\r\n            }\r\n        }\r\n        else {\r\n            try {\r\n                for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\r\n                    var item = items_1_1.value;\r\n                    iterator(item);\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        }\r\n    }\r\n    function push(array, addition) {\r\n        forEach(addition, function (a) { return array.push(a); });\r\n    }\r\n    function toArray(items) {\r\n        var results = [];\r\n        for (var i = 0, len = items.length; i < len; i++) {\r\n            results.push(items[i]);\r\n        }\r\n        return results;\r\n    }\n\n    function logInfo() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n    }\r\n    function logWarn() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n    }\n\n    function throttle(callback) {\r\n        var pending = false;\r\n        var frameId = null;\r\n        var lastArgs;\r\n        var throttled = (function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            lastArgs = args;\r\n            if (frameId) {\r\n                pending = true;\r\n            }\r\n            else {\r\n                callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\r\n                frameId = requestAnimationFrame(function () {\r\n                    frameId = null;\r\n                    if (pending) {\r\n                        callback.apply(void 0, __spreadArray([], __read(lastArgs), false));\r\n                        pending = false;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        var cancel = function () {\r\n            cancelAnimationFrame(frameId);\r\n            pending = false;\r\n            frameId = null;\r\n        };\r\n        return Object.assign(throttled, { cancel: cancel });\r\n    }\r\n    function createAsyncTasksQueue() {\r\n        var tasks = [];\r\n        var frameId = null;\r\n        function runTasks() {\r\n            var task;\r\n            while ((task = tasks.shift())) {\r\n                task();\r\n            }\r\n            frameId = null;\r\n        }\r\n        function add(task) {\r\n            tasks.push(task);\r\n            if (!frameId) {\r\n                frameId = requestAnimationFrame(runTasks);\r\n            }\r\n        }\r\n        function cancel() {\r\n            tasks.splice(0);\r\n            cancelAnimationFrame(frameId);\r\n            frameId = null;\r\n        }\r\n        return { add: add, cancel: cancel };\r\n    }\n\n    function getDuration(time) {\r\n        var duration = 0;\r\n        if (time.seconds) {\r\n            duration += time.seconds * 1000;\r\n        }\r\n        if (time.minutes) {\r\n            duration += time.minutes * 60 * 1000;\r\n        }\r\n        if (time.hours) {\r\n            duration += time.hours * 60 * 60 * 1000;\r\n        }\r\n        if (time.days) {\r\n            duration += time.days * 24 * 60 * 60 * 1000;\r\n        }\r\n        return duration;\r\n    }\n\n    function removeNode(node) {\r\n        node && node.parentNode && node.parentNode.removeChild(node);\r\n    }\r\n    function watchForNodePosition(node, mode, onRestore) {\r\n        if (onRestore === void 0) { onRestore = Function.prototype; }\r\n        var MAX_ATTEMPTS_COUNT = 10;\r\n        var RETRY_TIMEOUT = getDuration({ seconds: 2 });\r\n        var ATTEMPTS_INTERVAL = getDuration({ seconds: 10 });\r\n        var prevSibling = node.previousSibling;\r\n        var parent = node.parentNode;\r\n        if (!parent) {\r\n            throw new Error('Unable to watch for node position: parent element not found');\r\n        }\r\n        if (mode === 'prev-sibling' && !prevSibling) {\r\n            throw new Error('Unable to watch for node position: there is no previous sibling');\r\n        }\r\n        var attempts = 0;\r\n        var start = null;\r\n        var timeoutId = null;\r\n        var restore = throttle(function () {\r\n            if (timeoutId) {\r\n                return;\r\n            }\r\n            attempts++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            }\r\n            else if (attempts >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    logWarn(\"Node position watcher paused: retry in \" + RETRY_TIMEOUT + \"ms\", node, prevSibling);\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attempts = 0;\r\n                        timeoutId = null;\r\n                        restore();\r\n                    }, RETRY_TIMEOUT);\r\n                    return;\r\n                }\r\n                start = now;\r\n                attempts = 1;\r\n            }\r\n            if (mode === 'parent') {\r\n                if (prevSibling && prevSibling.parentNode !== parent) {\r\n                    logWarn('Unable to restore node position: sibling parent changed', node, prevSibling, parent);\r\n                    stop();\r\n                    return;\r\n                }\r\n            }\r\n            if (mode === 'prev-sibling') {\r\n                if (prevSibling.parentNode == null) {\r\n                    logWarn('Unable to restore node position: sibling was removed', node, prevSibling, parent);\r\n                    stop();\r\n                    return;\r\n                }\r\n                if (prevSibling.parentNode !== parent) {\r\n                    logWarn('Style was moved to another parent', node, prevSibling, parent);\r\n                    updateParent(prevSibling.parentNode);\r\n                }\r\n            }\r\n            logWarn('Restoring node position', node, prevSibling, parent);\r\n            parent.insertBefore(node, prevSibling ? prevSibling.nextSibling : parent.firstChild);\r\n            observer.takeRecords();\r\n            onRestore && onRestore();\r\n        });\r\n        var observer = new MutationObserver(function () {\r\n            if ((mode === 'parent' && node.parentNode !== parent) ||\r\n                (mode === 'prev-sibling' && node.previousSibling !== prevSibling)) {\r\n                restore();\r\n            }\r\n        });\r\n        var run = function () {\r\n            observer.observe(parent, { childList: true });\r\n        };\r\n        var stop = function () {\r\n            clearTimeout(timeoutId);\r\n            observer.disconnect();\r\n            restore.cancel();\r\n        };\r\n        var skip = function () {\r\n            observer.takeRecords();\r\n        };\r\n        var updateParent = function (parentNode) {\r\n            parent = parentNode;\r\n            stop();\r\n            run();\r\n        };\r\n        run();\r\n        return { run: run, stop: stop, skip: skip };\r\n    }\r\n    function iterateShadowHosts(root, iterator) {\r\n        if (root == null) {\r\n            return;\r\n        }\r\n        var walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {\r\n            acceptNode: function (node) {\r\n                return node.shadowRoot == null ? NodeFilter.FILTER_SKIP : NodeFilter.FILTER_ACCEPT;\r\n            }\r\n        });\r\n        for (var node = (root.shadowRoot ? walker.currentNode : walker.nextNode()); node != null; node = walker.nextNode()) {\r\n            iterator(node);\r\n            iterateShadowHosts(node.shadowRoot, iterator);\r\n        }\r\n    }\r\n    function isDOMReady() {\r\n        if (typeof document === 'undefined')\r\n            return false;\r\n        return document.readyState === 'complete' || document.readyState === 'interactive';\r\n    }\r\n    var readyStateListeners = new Set();\r\n    function addDOMReadyListener(listener) {\r\n        readyStateListeners.add(listener);\r\n    }\r\n    function removeDOMReadyListener(listener) {\r\n        readyStateListeners.delete(listener);\r\n    }\r\n    function isReadyStateComplete() {\r\n        return document.readyState === 'complete';\r\n    }\r\n    var readyStateCompleteListeners = new Set();\r\n    function addReadyStateCompleteListener(listener) {\r\n        readyStateCompleteListeners.add(listener);\r\n    }\r\n    function cleanReadyStateCompleteListeners() {\r\n        readyStateCompleteListeners.clear();\r\n    }\r\n    if (!isDOMReady()) {\r\n        var onReadyStateChange_1 = function () {\r\n            if (isDOMReady()) {\r\n                readyStateListeners.forEach(function (listener) { return listener(); });\r\n                readyStateListeners.clear();\r\n                if (isReadyStateComplete()) {\r\n                    document.removeEventListener('readystatechange', onReadyStateChange_1);\r\n                    readyStateCompleteListeners.forEach(function (listener) { return listener(); });\r\n                    readyStateCompleteListeners.clear();\r\n                }\r\n            }\r\n        };\r\n        if (typeof document !== 'undefined') {\r\n            document.addEventListener('readystatechange', onReadyStateChange_1);\r\n        }\r\n    }\r\n    var HUGE_MUTATIONS_COUNT = 1000;\r\n    function isHugeMutation(mutations) {\r\n        if (mutations.length > HUGE_MUTATIONS_COUNT) {\r\n            return true;\r\n        }\r\n        var addedNodesCount = 0;\r\n        for (var i = 0; i < mutations.length; i++) {\r\n            addedNodesCount += mutations[i].addedNodes.length;\r\n            if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function getElementsTreeOperations(mutations) {\r\n        var additions = new Set();\r\n        var deletions = new Set();\r\n        var moves = new Set();\r\n        mutations.forEach(function (m) {\r\n            forEach(m.addedNodes, function (n) {\r\n                if (n instanceof Element && n.isConnected) {\r\n                    additions.add(n);\r\n                }\r\n            });\r\n            forEach(m.removedNodes, function (n) {\r\n                if (n instanceof Element) {\r\n                    if (n.isConnected) {\r\n                        moves.add(n);\r\n                        additions.delete(n);\r\n                    }\r\n                    else {\r\n                        deletions.add(n);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        var duplicateAdditions = [];\r\n        var duplicateDeletions = [];\r\n        additions.forEach(function (node) {\r\n            if (additions.has(node.parentElement)) {\r\n                duplicateAdditions.push(node);\r\n            }\r\n        });\r\n        deletions.forEach(function (node) {\r\n            if (deletions.has(node.parentElement)) {\r\n                duplicateDeletions.push(node);\r\n            }\r\n        });\r\n        duplicateAdditions.forEach(function (node) { return additions.delete(node); });\r\n        duplicateDeletions.forEach(function (node) { return deletions.delete(node); });\r\n        return { additions: additions, moves: moves, deletions: deletions };\r\n    }\r\n    var optimizedTreeObservers = new Map();\r\n    var optimizedTreeCallbacks = new WeakMap();\r\n    function createOptimizedTreeObserver(root, callbacks) {\r\n        var observer;\r\n        var observerCallbacks;\r\n        var domReadyListener;\r\n        if (optimizedTreeObservers.has(root)) {\r\n            observer = optimizedTreeObservers.get(root);\r\n            observerCallbacks = optimizedTreeCallbacks.get(observer);\r\n        }\r\n        else {\r\n            var hadHugeMutationsBefore_1 = false;\r\n            var subscribedForReadyState_1 = false;\r\n            observer = new MutationObserver(function (mutations) {\r\n                if (isHugeMutation(mutations)) {\r\n                    if (!hadHugeMutationsBefore_1 || isDOMReady()) {\r\n                        observerCallbacks.forEach(function (_a) {\r\n                            var onHugeMutations = _a.onHugeMutations;\r\n                            return onHugeMutations(root);\r\n                        });\r\n                    }\r\n                    else if (!subscribedForReadyState_1) {\r\n                        domReadyListener = function () { return observerCallbacks.forEach(function (_a) {\r\n                            var onHugeMutations = _a.onHugeMutations;\r\n                            return onHugeMutations(root);\r\n                        }); };\r\n                        addDOMReadyListener(domReadyListener);\r\n                        subscribedForReadyState_1 = true;\r\n                    }\r\n                    hadHugeMutationsBefore_1 = true;\r\n                }\r\n                else {\r\n                    var elementsOperations_1 = getElementsTreeOperations(mutations);\r\n                    observerCallbacks.forEach(function (_a) {\r\n                        var onMinorMutations = _a.onMinorMutations;\r\n                        return onMinorMutations(elementsOperations_1);\r\n                    });\r\n                }\r\n            });\r\n            observer.observe(root, { childList: true, subtree: true });\r\n            optimizedTreeObservers.set(root, observer);\r\n            observerCallbacks = new Set();\r\n            optimizedTreeCallbacks.set(observer, observerCallbacks);\r\n        }\r\n        observerCallbacks.add(callbacks);\r\n        return {\r\n            disconnect: function () {\r\n                observerCallbacks.delete(callbacks);\r\n                if (domReadyListener) {\r\n                    removeDOMReadyListener(domReadyListener);\r\n                }\r\n                if (observerCallbacks.size === 0) {\r\n                    observer.disconnect();\r\n                    optimizedTreeCallbacks.delete(observer);\r\n                    optimizedTreeObservers.delete(root);\r\n                }\r\n            },\r\n        };\r\n    }\n\n    var anchor;\r\n    var parsedURLCache = new Map();\r\n    function fixBaseURL($url) {\r\n        if (!anchor) {\r\n            anchor = document.createElement('a');\r\n        }\r\n        anchor.href = $url;\r\n        return anchor.href;\r\n    }\r\n    function parseURL($url, $base) {\r\n        if ($base === void 0) { $base = null; }\r\n        var key = \"\" + $url + ($base ? \";\" + $base : '');\r\n        if (parsedURLCache.has(key)) {\r\n            return parsedURLCache.get(key);\r\n        }\r\n        if ($base) {\r\n            var parsedURL_1 = new URL($url, fixBaseURL($base));\r\n            parsedURLCache.set(key, parsedURL_1);\r\n            return parsedURL_1;\r\n        }\r\n        var parsedURL = new URL(fixBaseURL($url));\r\n        parsedURLCache.set($url, parsedURL);\r\n        return parsedURL;\r\n    }\r\n    function getAbsoluteURL($base, $relative) {\r\n        if ($relative.match(/^data\\\\?\\:/)) {\r\n            return $relative;\r\n        }\r\n        if (/^\\/\\//.test($relative)) {\r\n            return \"\" + location.protocol + $relative;\r\n        }\r\n        var b = parseURL($base);\r\n        var a = parseURL($relative, b.href);\r\n        return a.href;\r\n    }\r\n    function isRelativeHrefOnAbsolutePath(href) {\r\n        if (href.startsWith('data:')) {\r\n            return true;\r\n        }\r\n        var url = parseURL(href);\r\n        if (url.protocol !== location.protocol) {\r\n            return false;\r\n        }\r\n        if (url.hostname !== location.hostname) {\r\n            return false;\r\n        }\r\n        if (url.port !== location.port) {\r\n            return false;\r\n        }\r\n        return url.pathname === location.pathname;\r\n    }\n\n    function iterateCSSRules(rules, iterate, onMediaRuleError) {\r\n        forEach(rules, function (rule) {\r\n            if (rule.selectorText) {\r\n                iterate(rule);\r\n            }\r\n            else if (rule.href) {\r\n                try {\r\n                    iterateCSSRules(rule.styleSheet.cssRules, iterate, onMediaRuleError);\r\n                }\r\n                catch (err) {\r\n                    logInfo(\"Found a non-loaded link.\");\r\n                    onMediaRuleError && onMediaRuleError();\r\n                }\r\n            }\r\n            else if (rule.media) {\r\n                var media = Array.from(rule.media);\r\n                var isScreenOrAllOrQuery = media.some(function (m) { return m.startsWith('screen') || m.startsWith('all') || m.startsWith('('); });\r\n                var isPrintOrSpeech = media.some(function (m) { return m.startsWith('print') || m.startsWith('speech'); });\r\n                if (isScreenOrAllOrQuery || !isPrintOrSpeech) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            }\r\n            else if (rule.conditionText) {\r\n                if (CSS.supports(rule.conditionText)) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            }\r\n            else {\r\n                logWarn(\"CSSRule type not supported\", rule);\r\n            }\r\n        });\r\n    }\r\n    var shorthandVarDependantProperties = [\r\n        'background',\r\n        'border',\r\n        'border-color',\r\n        'border-bottom',\r\n        'border-left',\r\n        'border-right',\r\n        'border-top',\r\n        'outline',\r\n        'outline-color',\r\n    ];\r\n    var shorthandVarDepPropRegexps = isSafari ? shorthandVarDependantProperties.map(function (prop) {\r\n        var regexp = new RegExp(prop + \":\\\\s*(.*?)\\\\s*;\");\r\n        return [prop, regexp];\r\n    }) : null;\r\n    function iterateCSSDeclarations(style, iterate) {\r\n        forEach(style, function (property) {\r\n            var value = style.getPropertyValue(property).trim();\r\n            if (!value) {\r\n                return;\r\n            }\r\n            iterate(property, value);\r\n        });\r\n        var cssText = style.cssText;\r\n        if (cssText.includes('var(')) {\r\n            if (isSafari) {\r\n                shorthandVarDepPropRegexps.forEach(function (_a) {\r\n                    var _b = __read(_a, 2), prop = _b[0], regexp = _b[1];\r\n                    var match = cssText.match(regexp);\r\n                    if (match && match[1]) {\r\n                        var val = match[1].trim();\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                shorthandVarDependantProperties.forEach(function (prop) {\r\n                    var val = style.getPropertyValue(prop);\r\n                    if (val && val.includes('var(')) {\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    var cssURLRegex = /url\\((('.+?')|(\".+?\")|([^\\)]*?))\\)/g;\r\n    var cssImportRegex = /@import\\s*(url\\()?(('.+?')|(\".+?\")|([^\\)]*?))\\)? ?(screen)?;?/g;\r\n    function getCSSURLValue(cssURL) {\r\n        return cssURL.replace(/^url\\((.*)\\)$/, '$1').trim().replace(/^\"(.*)\"$/, '$1').replace(/^'(.*)'$/, '$1');\r\n    }\r\n    function getCSSBaseBath(url) {\r\n        var cssURL = parseURL(url);\r\n        return \"\" + cssURL.origin + cssURL.pathname.replace(/\\?.*$/, '').replace(/(\\/)([^\\/]+)$/i, '$1');\r\n    }\r\n    function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\r\n        return $css.replace(cssURLRegex, function (match) {\r\n            var pathValue = getCSSURLValue(match);\r\n            try {\r\n                return \"url(\\\"\" + getAbsoluteURL(cssBasePath, pathValue) + \"\\\")\";\r\n            }\r\n            catch (err) {\r\n                logWarn('Not able to replace relative URL with Absolute URL, skipping');\r\n                return match;\r\n            }\r\n        });\r\n    }\r\n    var cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\r\n    function removeCSSComments($css) {\r\n        return $css.replace(cssCommentsRegex, '');\r\n    }\r\n    var fontFaceRegex = /@font-face\\s*{[^}]*}/g;\r\n    function replaceCSSFontFace($css) {\r\n        return $css.replace(fontFaceRegex, '');\r\n    }\n\n    function hslToRGB(_a) {\r\n        var h = _a.h, s = _a.s, l = _a.l, _b = _a.a, a = _b === void 0 ? 1 : _b;\r\n        if (s === 0) {\r\n            var _c = __read([l, l, l].map(function (x) { return Math.round(x * 255); }), 3), r_1 = _c[0], b_1 = _c[1], g_1 = _c[2];\r\n            return { r: r_1, g: g_1, b: b_1, a: a };\r\n        }\r\n        var c = (1 - Math.abs(2 * l - 1)) * s;\r\n        var x = c * (1 - Math.abs((h / 60) % 2 - 1));\r\n        var m = l - c / 2;\r\n        var _d = __read((h < 60 ? [c, x, 0] :\r\n            h < 120 ? [x, c, 0] :\r\n                h < 180 ? [0, c, x] :\r\n                    h < 240 ? [0, x, c] :\r\n                        h < 300 ? [x, 0, c] :\r\n                            [c, 0, x]).map(function (n) { return Math.round((n + m) * 255); }), 3), r = _d[0], g = _d[1], b = _d[2];\r\n        return { r: r, g: g, b: b, a: a };\r\n    }\r\n    function rgbToHSL(_a) {\r\n        var r255 = _a.r, g255 = _a.g, b255 = _a.b, _b = _a.a, a = _b === void 0 ? 1 : _b;\r\n        var r = r255 / 255;\r\n        var g = g255 / 255;\r\n        var b = b255 / 255;\r\n        var max = Math.max(r, g, b);\r\n        var min = Math.min(r, g, b);\r\n        var c = max - min;\r\n        var l = (max + min) / 2;\r\n        if (c === 0) {\r\n            return { h: 0, s: 0, l: l, a: a };\r\n        }\r\n        var h = (max === r ? (((g - b) / c) % 6) :\r\n            max === g ? ((b - r) / c + 2) :\r\n                ((r - g) / c + 4)) * 60;\r\n        if (h < 0) {\r\n            h += 360;\r\n        }\r\n        var s = c / (1 - Math.abs(2 * l - 1));\r\n        return { h: h, s: s, l: l, a: a };\r\n    }\r\n    function toFixed(n, digits) {\r\n        if (digits === void 0) { digits = 0; }\r\n        var fixed = n.toFixed(digits);\r\n        if (digits === 0) {\r\n            return fixed;\r\n        }\r\n        var dot = fixed.indexOf('.');\r\n        if (dot >= 0) {\r\n            var zerosMatch = fixed.match(/0+$/);\r\n            if (zerosMatch) {\r\n                if (zerosMatch.index === dot + 1) {\r\n                    return fixed.substring(0, dot);\r\n                }\r\n                return fixed.substring(0, zerosMatch.index);\r\n            }\r\n        }\r\n        return fixed;\r\n    }\r\n    function rgbToString(rgb) {\r\n        var r = rgb.r, g = rgb.g, b = rgb.b, a = rgb.a;\r\n        if (a != null && a < 1) {\r\n            return \"rgba(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \", \" + toFixed(a, 2) + \")\";\r\n        }\r\n        return \"rgb(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \")\";\r\n    }\r\n    function rgbToHexString(_a) {\r\n        var r = _a.r, g = _a.g, b = _a.b, a = _a.a;\r\n        return \"#\" + (a != null && a < 1 ? [r, g, b, Math.round(a * 255)] : [r, g, b]).map(function (x) {\r\n            return \"\" + (x < 16 ? '0' : '') + x.toString(16);\r\n        }).join('');\r\n    }\r\n    function hslToString(hsl) {\r\n        var h = hsl.h, s = hsl.s, l = hsl.l, a = hsl.a;\r\n        if (a != null && a < 1) {\r\n            return \"hsla(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%, \" + toFixed(a, 2) + \")\";\r\n        }\r\n        return \"hsl(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%)\";\r\n    }\r\n    var rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\r\n    var hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\r\n    var hexMatch = /^#[0-9a-f]+$/i;\r\n    function parse($color) {\r\n        var c = $color.trim().toLowerCase();\r\n        if (c.match(rgbMatch)) {\r\n            return parseRGB(c);\r\n        }\r\n        if (c.match(hslMatch)) {\r\n            return parseHSL(c);\r\n        }\r\n        if (c.match(hexMatch)) {\r\n            return parseHex(c);\r\n        }\r\n        if (knownColors.has(c)) {\r\n            return getColorByName(c);\r\n        }\r\n        if (systemColors.has(c)) {\r\n            return getSystemColor(c);\r\n        }\r\n        if ($color === 'transparent') {\r\n            return { r: 0, g: 0, b: 0, a: 0 };\r\n        }\r\n        throw new Error(\"Unable to parse \" + $color);\r\n    }\r\n    function getNumbers($color) {\r\n        var numbers = [];\r\n        var prevPos = 0;\r\n        var isMining = false;\r\n        var startIndex = $color.indexOf('(');\r\n        $color = $color.substring(startIndex + 1, $color.length - 1);\r\n        for (var i = 0; i < $color.length; i++) {\r\n            var c = $color[i];\r\n            if (c >= '0' && c <= '9' || c === '.' || c === '+' || c === '-') {\r\n                isMining = true;\r\n            }\r\n            else if (isMining && (c === ' ' || c === ',')) {\r\n                numbers.push($color.substring(prevPos, i));\r\n                isMining = false;\r\n                prevPos = i + 1;\r\n            }\r\n            else if (!isMining) {\r\n                prevPos = i + 1;\r\n            }\r\n        }\r\n        if (isMining) {\r\n            numbers.push($color.substring(prevPos, $color.length));\r\n        }\r\n        return numbers;\r\n    }\r\n    function getNumbersFromString(str, range, units) {\r\n        var raw = getNumbers(str);\r\n        var unitsList = Object.entries(units);\r\n        var numbers = raw.map(function (r) { return r.trim(); }).map(function (r, i) {\r\n            var n;\r\n            var unit = unitsList.find(function (_a) {\r\n                var _b = __read(_a, 1), u = _b[0];\r\n                return r.endsWith(u);\r\n            });\r\n            if (unit) {\r\n                n = parseFloat(r.substring(0, r.length - unit[0].length)) / unit[1] * range[i];\r\n            }\r\n            else {\r\n                n = parseFloat(r);\r\n            }\r\n            if (range[i] > 1) {\r\n                return Math.round(n);\r\n            }\r\n            return n;\r\n        });\r\n        return numbers;\r\n    }\r\n    var rgbRange = [255, 255, 255, 1];\r\n    var rgbUnits = { '%': 100 };\r\n    function parseRGB($rgb) {\r\n        var _a = __read(getNumbersFromString($rgb, rgbRange, rgbUnits), 4), r = _a[0], g = _a[1], b = _a[2], _b = _a[3], a = _b === void 0 ? 1 : _b;\r\n        return { r: r, g: g, b: b, a: a };\r\n    }\r\n    var hslRange = [360, 1, 1, 1];\r\n    var hslUnits = { '%': 100, 'deg': 360, 'rad': 2 * Math.PI, 'turn': 1 };\r\n    function parseHSL($hsl) {\r\n        var _a = __read(getNumbersFromString($hsl, hslRange, hslUnits), 4), h = _a[0], s = _a[1], l = _a[2], _b = _a[3], a = _b === void 0 ? 1 : _b;\r\n        return hslToRGB({ h: h, s: s, l: l, a: a });\r\n    }\r\n    function parseHex($hex) {\r\n        var h = $hex.substring(1);\r\n        switch (h.length) {\r\n            case 3:\r\n            case 4: {\r\n                var _a = __read([0, 1, 2].map(function (i) { return parseInt(\"\" + h[i] + h[i], 16); }), 3), r = _a[0], g = _a[1], b = _a[2];\r\n                var a = h.length === 3 ? 1 : (parseInt(\"\" + h[3] + h[3], 16) / 255);\r\n                return { r: r, g: g, b: b, a: a };\r\n            }\r\n            case 6:\r\n            case 8: {\r\n                var _b = __read([0, 2, 4].map(function (i) { return parseInt(h.substring(i, i + 2), 16); }), 3), r = _b[0], g = _b[1], b = _b[2];\r\n                var a = h.length === 6 ? 1 : (parseInt(h.substring(6, 8), 16) / 255);\r\n                return { r: r, g: g, b: b, a: a };\r\n            }\r\n        }\r\n        throw new Error(\"Unable to parse \" + $hex);\r\n    }\r\n    function getColorByName($color) {\r\n        var n = knownColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    function getSystemColor($color) {\r\n        var n = systemColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    var isCharDigit = function (char) { return char >= '0' && char <= '9'; };\r\n    var getAmountOfDigits = function (number) { return Math.floor(Math.log10(number)) + 1; };\r\n    function lowerCalcExpression(color) {\r\n        var searchIndex = 0;\r\n        var replaceBetweenIndices = function (start, end, replacement) {\r\n            color = color.substring(0, start) + replacement + color.substring(end);\r\n        };\r\n        var getNumber = function () {\r\n            var resultNumber = 0;\r\n            for (var i = 1; i < 4; i++) {\r\n                var char = color[searchIndex + i];\r\n                if (char === ' ') {\r\n                    break;\r\n                }\r\n                if (isCharDigit(char)) {\r\n                    resultNumber *= 10;\r\n                    resultNumber += Number(char);\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n            var lenDigits = getAmountOfDigits(resultNumber);\r\n            searchIndex += lenDigits;\r\n            var possibleType = color[searchIndex + 1];\r\n            if (possibleType !== '%') {\r\n                return;\r\n            }\r\n            searchIndex++;\r\n            return resultNumber;\r\n        };\r\n        while ((searchIndex = color.indexOf('calc(')) !== 0) {\r\n            var startIndex = searchIndex;\r\n            searchIndex += 4;\r\n            var firstNumber = getNumber();\r\n            if (!firstNumber) {\r\n                break;\r\n            }\r\n            if (color[searchIndex + 1] !== ' ') {\r\n                break;\r\n            }\r\n            searchIndex++;\r\n            var operation = color[searchIndex + 1];\r\n            if (operation !== '+' && operation !== '-') {\r\n                break;\r\n            }\r\n            searchIndex++;\r\n            if (color[searchIndex + 1] !== ' ') {\r\n                break;\r\n            }\r\n            searchIndex++;\r\n            var secondNumber = getNumber();\r\n            if (!secondNumber) {\r\n                break;\r\n            }\r\n            var replacement = void 0;\r\n            if (operation === '+') {\r\n                replacement = firstNumber + secondNumber + \"%\";\r\n            }\r\n            else {\r\n                replacement = firstNumber - secondNumber + \"%\";\r\n            }\r\n            replaceBetweenIndices(startIndex, searchIndex + 2, replacement);\r\n        }\r\n        return color;\r\n    }\r\n    var knownColors = new Map(Object.entries({\r\n        aliceblue: 0xf0f8ff,\r\n        antiquewhite: 0xfaebd7,\r\n        aqua: 0x00ffff,\r\n        aquamarine: 0x7fffd4,\r\n        azure: 0xf0ffff,\r\n        beige: 0xf5f5dc,\r\n        bisque: 0xffe4c4,\r\n        black: 0x000000,\r\n        blanchedalmond: 0xffebcd,\r\n        blue: 0x0000ff,\r\n        blueviolet: 0x8a2be2,\r\n        brown: 0xa52a2a,\r\n        burlywood: 0xdeb887,\r\n        cadetblue: 0x5f9ea0,\r\n        chartreuse: 0x7fff00,\r\n        chocolate: 0xd2691e,\r\n        coral: 0xff7f50,\r\n        cornflowerblue: 0x6495ed,\r\n        cornsilk: 0xfff8dc,\r\n        crimson: 0xdc143c,\r\n        cyan: 0x00ffff,\r\n        darkblue: 0x00008b,\r\n        darkcyan: 0x008b8b,\r\n        darkgoldenrod: 0xb8860b,\r\n        darkgray: 0xa9a9a9,\r\n        darkgrey: 0xa9a9a9,\r\n        darkgreen: 0x006400,\r\n        darkkhaki: 0xbdb76b,\r\n        darkmagenta: 0x8b008b,\r\n        darkolivegreen: 0x556b2f,\r\n        darkorange: 0xff8c00,\r\n        darkorchid: 0x9932cc,\r\n        darkred: 0x8b0000,\r\n        darksalmon: 0xe9967a,\r\n        darkseagreen: 0x8fbc8f,\r\n        darkslateblue: 0x483d8b,\r\n        darkslategray: 0x2f4f4f,\r\n        darkslategrey: 0x2f4f4f,\r\n        darkturquoise: 0x00ced1,\r\n        darkviolet: 0x9400d3,\r\n        deeppink: 0xff1493,\r\n        deepskyblue: 0x00bfff,\r\n        dimgray: 0x696969,\r\n        dimgrey: 0x696969,\r\n        dodgerblue: 0x1e90ff,\r\n        firebrick: 0xb22222,\r\n        floralwhite: 0xfffaf0,\r\n        forestgreen: 0x228b22,\r\n        fuchsia: 0xff00ff,\r\n        gainsboro: 0xdcdcdc,\r\n        ghostwhite: 0xf8f8ff,\r\n        gold: 0xffd700,\r\n        goldenrod: 0xdaa520,\r\n        gray: 0x808080,\r\n        grey: 0x808080,\r\n        green: 0x008000,\r\n        greenyellow: 0xadff2f,\r\n        honeydew: 0xf0fff0,\r\n        hotpink: 0xff69b4,\r\n        indianred: 0xcd5c5c,\r\n        indigo: 0x4b0082,\r\n        ivory: 0xfffff0,\r\n        khaki: 0xf0e68c,\r\n        lavender: 0xe6e6fa,\r\n        lavenderblush: 0xfff0f5,\r\n        lawngreen: 0x7cfc00,\r\n        lemonchiffon: 0xfffacd,\r\n        lightblue: 0xadd8e6,\r\n        lightcoral: 0xf08080,\r\n        lightcyan: 0xe0ffff,\r\n        lightgoldenrodyellow: 0xfafad2,\r\n        lightgray: 0xd3d3d3,\r\n        lightgrey: 0xd3d3d3,\r\n        lightgreen: 0x90ee90,\r\n        lightpink: 0xffb6c1,\r\n        lightsalmon: 0xffa07a,\r\n        lightseagreen: 0x20b2aa,\r\n        lightskyblue: 0x87cefa,\r\n        lightslategray: 0x778899,\r\n        lightslategrey: 0x778899,\r\n        lightsteelblue: 0xb0c4de,\r\n        lightyellow: 0xffffe0,\r\n        lime: 0x00ff00,\r\n        limegreen: 0x32cd32,\r\n        linen: 0xfaf0e6,\r\n        magenta: 0xff00ff,\r\n        maroon: 0x800000,\r\n        mediumaquamarine: 0x66cdaa,\r\n        mediumblue: 0x0000cd,\r\n        mediumorchid: 0xba55d3,\r\n        mediumpurple: 0x9370db,\r\n        mediumseagreen: 0x3cb371,\r\n        mediumslateblue: 0x7b68ee,\r\n        mediumspringgreen: 0x00fa9a,\r\n        mediumturquoise: 0x48d1cc,\r\n        mediumvioletred: 0xc71585,\r\n        midnightblue: 0x191970,\r\n        mintcream: 0xf5fffa,\r\n        mistyrose: 0xffe4e1,\r\n        moccasin: 0xffe4b5,\r\n        navajowhite: 0xffdead,\r\n        navy: 0x000080,\r\n        oldlace: 0xfdf5e6,\r\n        olive: 0x808000,\r\n        olivedrab: 0x6b8e23,\r\n        orange: 0xffa500,\r\n        orangered: 0xff4500,\r\n        orchid: 0xda70d6,\r\n        palegoldenrod: 0xeee8aa,\r\n        palegreen: 0x98fb98,\r\n        paleturquoise: 0xafeeee,\r\n        palevioletred: 0xdb7093,\r\n        papayawhip: 0xffefd5,\r\n        peachpuff: 0xffdab9,\r\n        peru: 0xcd853f,\r\n        pink: 0xffc0cb,\r\n        plum: 0xdda0dd,\r\n        powderblue: 0xb0e0e6,\r\n        purple: 0x800080,\r\n        rebeccapurple: 0x663399,\r\n        red: 0xff0000,\r\n        rosybrown: 0xbc8f8f,\r\n        royalblue: 0x4169e1,\r\n        saddlebrown: 0x8b4513,\r\n        salmon: 0xfa8072,\r\n        sandybrown: 0xf4a460,\r\n        seagreen: 0x2e8b57,\r\n        seashell: 0xfff5ee,\r\n        sienna: 0xa0522d,\r\n        silver: 0xc0c0c0,\r\n        skyblue: 0x87ceeb,\r\n        slateblue: 0x6a5acd,\r\n        slategray: 0x708090,\r\n        slategrey: 0x708090,\r\n        snow: 0xfffafa,\r\n        springgreen: 0x00ff7f,\r\n        steelblue: 0x4682b4,\r\n        tan: 0xd2b48c,\r\n        teal: 0x008080,\r\n        thistle: 0xd8bfd8,\r\n        tomato: 0xff6347,\r\n        turquoise: 0x40e0d0,\r\n        violet: 0xee82ee,\r\n        wheat: 0xf5deb3,\r\n        white: 0xffffff,\r\n        whitesmoke: 0xf5f5f5,\r\n        yellow: 0xffff00,\r\n        yellowgreen: 0x9acd32,\r\n    }));\r\n    var systemColors = new Map(Object.entries({\r\n        ActiveBorder: 0x3b99fc,\r\n        ActiveCaption: 0x000000,\r\n        AppWorkspace: 0xaaaaaa,\r\n        Background: 0x6363ce,\r\n        ButtonFace: 0xffffff,\r\n        ButtonHighlight: 0xe9e9e9,\r\n        ButtonShadow: 0x9fa09f,\r\n        ButtonText: 0x000000,\r\n        CaptionText: 0x000000,\r\n        GrayText: 0x7f7f7f,\r\n        Highlight: 0xb2d7ff,\r\n        HighlightText: 0x000000,\r\n        InactiveBorder: 0xffffff,\r\n        InactiveCaption: 0xffffff,\r\n        InactiveCaptionText: 0x000000,\r\n        InfoBackground: 0xfbfcc5,\r\n        InfoText: 0x000000,\r\n        Menu: 0xf6f6f6,\r\n        MenuText: 0xffffff,\r\n        Scrollbar: 0xaaaaaa,\r\n        ThreeDDarkShadow: 0x000000,\r\n        ThreeDFace: 0xc0c0c0,\r\n        ThreeDHighlight: 0xffffff,\r\n        ThreeDLightShadow: 0xffffff,\r\n        ThreeDShadow: 0x000000,\r\n        Window: 0xececec,\r\n        WindowFrame: 0xaaaaaa,\r\n        WindowText: 0x000000,\r\n        '-webkit-focus-ring-color': 0xe59700\r\n    }).map(function (_a) {\r\n        var _b = __read(_a, 2), key = _b[0], value = _b[1];\r\n        return [key.toLowerCase(), value];\r\n    }));\n\n    function scale(x, inLow, inHigh, outLow, outHigh) {\r\n        return (x - inLow) * (outHigh - outLow) / (inHigh - inLow) + outLow;\r\n    }\r\n    function clamp(x, min, max) {\r\n        return Math.min(max, Math.max(min, x));\r\n    }\r\n    function multiplyMatrices(m1, m2) {\r\n        var result = [];\r\n        for (var i = 0, len = m1.length; i < len; i++) {\r\n            result[i] = [];\r\n            for (var j = 0, len2 = m2[0].length; j < len2; j++) {\r\n                var sum = 0;\r\n                for (var k = 0, len3 = m1[0].length; k < len3; k++) {\r\n                    sum += m1[i][k] * m2[k][j];\r\n                }\r\n                result[i][j] = sum;\r\n            }\r\n        }\r\n        return result;\r\n    }\n\n    function getMatches(regex, input, group) {\r\n        if (group === void 0) { group = 0; }\r\n        var matches = [];\r\n        var m;\r\n        while ((m = regex.exec(input))) {\r\n            matches.push(m[group]);\r\n        }\r\n        return matches;\r\n    }\r\n    function formatCSS(text) {\r\n        function trimLeft(text) {\r\n            return text.replace(/^\\s+/, '');\r\n        }\r\n        function getIndent(depth) {\r\n            if (depth === 0) {\r\n                return '';\r\n            }\r\n            return ' '.repeat(4 * depth);\r\n        }\r\n        if (text.length < 50000) {\r\n            var emptyRuleRegexp = /[^{}]+{\\s*}/;\r\n            while (emptyRuleRegexp.test(text)) {\r\n                text = text.replace(emptyRuleRegexp, '');\r\n            }\r\n        }\r\n        var css = (text\r\n            .replace(/\\s{2,}/g, ' ')\r\n            .replace(/\\{/g, '{\\n')\r\n            .replace(/\\}/g, '\\n}\\n')\r\n            .replace(/\\;(?![^\\(|\\\"]*(\\)|\\\"))/g, ';\\n')\r\n            .replace(/\\,(?![^\\(|\\\"]*(\\)|\\\"))/g, ',\\n')\r\n            .replace(/\\n\\s*\\n/g, '\\n')\r\n            .split('\\n'));\r\n        var depth = 0;\r\n        var formatted = [];\r\n        for (var x = 0, len = css.length; x < len; x++) {\r\n            var line = css[x] + \"\\n\";\r\n            if (line.includes('{')) {\r\n                formatted.push(getIndent(depth++) + trimLeft(line));\r\n            }\r\n            else if (line.includes('\\}')) {\r\n                formatted.push(getIndent(--depth) + trimLeft(line));\r\n            }\r\n            else {\r\n                formatted.push(getIndent(depth) + trimLeft(line));\r\n            }\r\n        }\r\n        return formatted.join('').trim();\r\n    }\r\n    function getParenthesesRange(input, searchStartIndex) {\r\n        if (searchStartIndex === void 0) { searchStartIndex = 0; }\r\n        var length = input.length;\r\n        var depth = 0;\r\n        var firstOpenIndex = -1;\r\n        for (var i = searchStartIndex; i < length; i++) {\r\n            if (depth === 0) {\r\n                var openIndex = input.indexOf('(', i);\r\n                if (openIndex < 0) {\r\n                    break;\r\n                }\r\n                firstOpenIndex = openIndex;\r\n                depth++;\r\n                i = openIndex;\r\n            }\r\n            else {\r\n                var closingIndex = input.indexOf(')', i);\r\n                if (closingIndex < 0) {\r\n                    break;\r\n                }\r\n                var openIndex = input.indexOf('(', i);\r\n                if (openIndex < 0 || closingIndex < openIndex) {\r\n                    depth--;\r\n                    if (depth === 0) {\r\n                        return { start: firstOpenIndex, end: closingIndex + 1 };\r\n                    }\r\n                    i = closingIndex;\r\n                }\r\n                else {\r\n                    depth++;\r\n                    i = openIndex;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\n\n    function createFilterMatrix(config) {\r\n        var m = Matrix.identity();\r\n        if (config.sepia !== 0) {\r\n            m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\r\n        }\r\n        if (config.contrast !== 100) {\r\n            m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\r\n        }\r\n        if (config.brightness !== 100) {\r\n            m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\r\n        }\r\n        if (config.mode === 1) {\r\n            m = multiplyMatrices(m, Matrix.invertNHue());\r\n        }\r\n        return m;\r\n    }\r\n    function applyColorMatrix(_a, matrix) {\r\n        var _b = __read(_a, 3), r = _b[0], g = _b[1], b = _b[2];\r\n        var rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\r\n        var result = multiplyMatrices(matrix, rgb);\r\n        return [0, 1, 2].map(function (i) { return clamp(Math.round(result[i][0] * 255), 0, 255); });\r\n    }\r\n    var Matrix = {\r\n        identity: function () {\r\n            return [\r\n                [1, 0, 0, 0, 0],\r\n                [0, 1, 0, 0, 0],\r\n                [0, 0, 1, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        invertNHue: function () {\r\n            return [\r\n                [0.333, -0.667, -0.667, 0, 1],\r\n                [-0.667, 0.333, -0.667, 0, 1],\r\n                [-0.667, -0.667, 0.333, 0, 1],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        brightness: function (v) {\r\n            return [\r\n                [v, 0, 0, 0, 0],\r\n                [0, v, 0, 0, 0],\r\n                [0, 0, v, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        contrast: function (v) {\r\n            var t = (1 - v) / 2;\r\n            return [\r\n                [v, 0, 0, 0, t],\r\n                [0, v, 0, 0, t],\r\n                [0, 0, v, 0, t],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        sepia: function (v) {\r\n            return [\r\n                [(0.393 + 0.607 * (1 - v)), (0.769 - 0.769 * (1 - v)), (0.189 - 0.189 * (1 - v)), 0, 0],\r\n                [(0.349 - 0.349 * (1 - v)), (0.686 + 0.314 * (1 - v)), (0.168 - 0.168 * (1 - v)), 0, 0],\r\n                [(0.272 - 0.272 * (1 - v)), (0.534 - 0.534 * (1 - v)), (0.131 + 0.869 * (1 - v)), 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        grayscale: function (v) {\r\n            return [\r\n                [(0.2126 + 0.7874 * (1 - v)), (0.7152 - 0.7152 * (1 - v)), (0.0722 - 0.0722 * (1 - v)), 0, 0],\r\n                [(0.2126 - 0.2126 * (1 - v)), (0.7152 + 0.2848 * (1 - v)), (0.0722 - 0.0722 * (1 - v)), 0, 0],\r\n                [(0.2126 - 0.2126 * (1 - v)), (0.7152 - 0.7152 * (1 - v)), (0.0722 + 0.9278 * (1 - v)), 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n    };\n\n    function getBgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme ? 'darkSchemeBackgroundColor' : 'lightSchemeBackgroundColor';\r\n        return theme[prop];\r\n    }\r\n    function getFgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme ? 'darkSchemeTextColor' : 'lightSchemeTextColor';\r\n        return theme[prop];\r\n    }\r\n    var colorModificationCache = new Map();\r\n    var colorParseCache$1 = new Map();\r\n    function parseToHSLWithCache(color) {\r\n        if (colorParseCache$1.has(color)) {\r\n            return colorParseCache$1.get(color);\r\n        }\r\n        var rgb = parse(color);\r\n        var hsl = rgbToHSL(rgb);\r\n        colorParseCache$1.set(color, hsl);\r\n        return hsl;\r\n    }\r\n    function clearColorModificationCache() {\r\n        colorModificationCache.clear();\r\n        colorParseCache$1.clear();\r\n    }\r\n    var rgbCacheKeys = ['r', 'g', 'b', 'a'];\r\n    var themeCacheKeys$1 = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\r\n    function getCacheId(rgb, theme) {\r\n        var resultId = '';\r\n        rgbCacheKeys.forEach(function (key) {\r\n            resultId += rgb[key] + \";\";\r\n        });\r\n        themeCacheKeys$1.forEach(function (key) {\r\n            resultId += theme[key] + \";\";\r\n        });\r\n        return resultId;\r\n    }\r\n    function modifyColorWithCache(rgb, theme, modifyHSL, poleColor, anotherPoleColor) {\r\n        var fnCache;\r\n        if (colorModificationCache.has(modifyHSL)) {\r\n            fnCache = colorModificationCache.get(modifyHSL);\r\n        }\r\n        else {\r\n            fnCache = new Map();\r\n            colorModificationCache.set(modifyHSL, fnCache);\r\n        }\r\n        var id = getCacheId(rgb, theme);\r\n        if (fnCache.has(id)) {\r\n            return fnCache.get(id);\r\n        }\r\n        var hsl = rgbToHSL(rgb);\r\n        var pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\r\n        var anotherPole = anotherPoleColor == null ? null : parseToHSLWithCache(anotherPoleColor);\r\n        var modified = modifyHSL(hsl, pole, anotherPole);\r\n        var _a = hslToRGB(modified), r = _a.r, g = _a.g, b = _a.b, a = _a.a;\r\n        var matrix = createFilterMatrix(theme);\r\n        var _b = __read(applyColorMatrix([r, g, b], matrix), 3), rf = _b[0], gf = _b[1], bf = _b[2];\r\n        var color = (a === 1 ?\r\n            rgbToHexString({ r: rf, g: gf, b: bf }) :\r\n            rgbToString({ r: rf, g: gf, b: bf, a: a }));\r\n        fnCache.set(id, color);\r\n        return color;\r\n    }\r\n    function noopHSL(hsl) {\r\n        return hsl;\r\n    }\r\n    function modifyColor(rgb, theme) {\r\n        return modifyColorWithCache(rgb, theme, noopHSL);\r\n    }\r\n    function modifyLightSchemeColor(rgb, theme) {\r\n        var poleBg = getBgPole(theme);\r\n        var poleFg = getFgPole(theme);\r\n        return modifyColorWithCache(rgb, theme, modifyLightModeHSL, poleFg, poleBg);\r\n    }\r\n    function modifyLightModeHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral;\r\n        if (isDark) {\r\n            isNeutral = l < 0.2 || s < 0.12;\r\n        }\r\n        else {\r\n            var isBlue = h > 200 && h < 280;\r\n            isNeutral = s < 0.24 || (l > 0.8 && isBlue);\r\n        }\r\n        var hx = h;\r\n        var sx = l;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            }\r\n            else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, poleFg.l, poleBg.l);\r\n        return { h: hx, s: sx, l: lx, a: a };\r\n    }\r\n    var MAX_BG_LIGHTNESS = 0.4;\r\n    function modifyBgHSL(_a, pole) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isBlue = h > 200 && h < 280;\r\n        var isNeutral = s < 0.12 || (l > 0.8 && isBlue);\r\n        if (isDark) {\r\n            var lx_1 = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\r\n            if (isNeutral) {\r\n                var hx_1 = pole.h;\r\n                var sx = pole.s;\r\n                return { h: hx_1, s: sx, l: lx_1, a: a };\r\n            }\r\n            return { h: h, s: s, l: lx_1, a: a };\r\n        }\r\n        var lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\r\n        if (isNeutral) {\r\n            var hx_2 = pole.h;\r\n            var sx = pole.s;\r\n            return { h: hx_2, s: sx, l: lx, a: a };\r\n        }\r\n        var hx = h;\r\n        var isYellow = h > 60 && h < 180;\r\n        if (isYellow) {\r\n            var isCloserToGreen = h > 120;\r\n            if (isCloserToGreen) {\r\n                hx = scale(h, 120, 180, 135, 180);\r\n            }\r\n            else {\r\n                hx = scale(h, 60, 120, 60, 105);\r\n            }\r\n        }\r\n        return { h: hx, s: s, l: lx, a: a };\r\n    }\r\n    function modifyBackgroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getBgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyBgHSL, pole);\r\n    }\r\n    var MIN_FG_LIGHTNESS = 0.55;\r\n    function modifyBlueFgHue(hue) {\r\n        return scale(hue, 205, 245, 205, 220);\r\n    }\r\n    function modifyFgHSL(_a, pole) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isLight = l > 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var isBlue = !isNeutral && h > 205 && h < 245;\r\n        if (isLight) {\r\n            var lx_2 = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\r\n            if (isNeutral) {\r\n                var hx_3 = pole.h;\r\n                var sx = pole.s;\r\n                return { h: hx_3, s: sx, l: lx_2, a: a };\r\n            }\r\n            var hx_4 = h;\r\n            if (isBlue) {\r\n                hx_4 = modifyBlueFgHue(h);\r\n            }\r\n            return { h: hx_4, s: s, l: lx_2, a: a };\r\n        }\r\n        if (isNeutral) {\r\n            var hx_5 = pole.h;\r\n            var sx = pole.s;\r\n            var lx_3 = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n            return { h: hx_5, s: sx, l: lx_3, a: a };\r\n        }\r\n        var hx = h;\r\n        var lx;\r\n        if (isBlue) {\r\n            hx = modifyBlueFgHue(h);\r\n            lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\r\n        }\r\n        else {\r\n            lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n        }\r\n        return { h: hx, s: s, l: lx, a: a };\r\n    }\r\n    function modifyForegroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getFgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyFgHSL, pole);\r\n    }\r\n    function modifyBorderHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var hx = h;\r\n        var sx = s;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            }\r\n            else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, 0.5, 0.2);\r\n        return { h: hx, s: sx, l: lx, a: a };\r\n    }\r\n    function modifyBorderColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var poleFg = getFgPole(theme);\r\n        var poleBg = getBgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyBorderHSL, poleFg, poleBg);\r\n    }\r\n    function modifyShadowColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\r\n    function modifyGradientColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\n\n    function createTextStyle(config) {\r\n        var lines = [];\r\n        lines.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*=\"vjs-\"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*=\"mu-\"], .glyphicon, .icon) {');\r\n        if (config.useFont && config.fontFamily) {\r\n            lines.push(\"  font-family: \" + config.fontFamily + \" !important;\");\r\n        }\r\n        if (config.textStroke > 0) {\r\n            lines.push(\"  -webkit-text-stroke: \" + config.textStroke + \"px !important;\");\r\n            lines.push(\"  text-stroke: \" + config.textStroke + \"px !important;\");\r\n        }\r\n        lines.push('}');\r\n        return lines.join('\\n');\r\n    }\n\n    var FilterMode;\r\n    (function (FilterMode) {\r\n        FilterMode[FilterMode[\"light\"] = 0] = \"light\";\r\n        FilterMode[FilterMode[\"dark\"] = 1] = \"dark\";\r\n    })(FilterMode || (FilterMode = {}));\r\n    function getCSSFilterValue(config) {\r\n        var filters = [];\r\n        if (config.mode === FilterMode.dark) {\r\n            filters.push('invert(100%) hue-rotate(180deg)');\r\n        }\r\n        if (config.brightness !== 100) {\r\n            filters.push(\"brightness(\" + config.brightness + \"%)\");\r\n        }\r\n        if (config.contrast !== 100) {\r\n            filters.push(\"contrast(\" + config.contrast + \"%)\");\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            filters.push(\"grayscale(\" + config.grayscale + \"%)\");\r\n        }\r\n        if (config.sepia !== 0) {\r\n            filters.push(\"sepia(\" + config.sepia + \"%)\");\r\n        }\r\n        if (filters.length === 0) {\r\n            return null;\r\n        }\r\n        return filters.join(' ');\r\n    }\n\n    function toSVGMatrix(matrix) {\r\n        return matrix.slice(0, 4).map(function (m) { return m.map(function (m) { return m.toFixed(3); }).join(' '); }).join(' ');\r\n    }\r\n    function getSVGFilterMatrixValue(config) {\r\n        return toSVGMatrix(createFilterMatrix(config));\r\n    }\n\n    var counter = 0;\r\n    var resolvers$1 = new Map();\r\n    var rejectors = new Map();\r\n    function bgFetch(request) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var id = ++counter;\r\n                        resolvers$1.set(id, resolve);\r\n                        rejectors.set(id, reject);\r\n                        if (typeof chrome !== 'undefined') {\r\n                            chrome.runtime.sendMessage({ type: MessageType.CS_FETCH, data: request, id: id });\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    if (typeof chrome !== 'undefined') {\r\n        chrome.runtime.onMessage.addListener(function (_a) {\r\n            var type = _a.type, data = _a.data, error = _a.error, id = _a.id;\r\n            if (type === MessageType.BG_FETCH_RESPONSE) {\r\n                var resolve = resolvers$1.get(id);\r\n                var reject = rejectors.get(id);\r\n                resolvers$1.delete(id);\r\n                rejectors.delete(id);\r\n                if (error) {\r\n                    reject && reject(error);\r\n                }\r\n                else {\r\n                    resolve && resolve(data);\r\n                }\r\n            }\r\n        });\r\n    }\n\n    var AsyncQueue = (function () {\r\n        function AsyncQueue() {\r\n            this.queue = [];\r\n            this.timerId = null;\r\n            this.frameDuration = 1000 / 60;\r\n        }\r\n        AsyncQueue.prototype.addToQueue = function (entry) {\r\n            this.queue.push(entry);\r\n            this.startQueue();\r\n        };\r\n        AsyncQueue.prototype.stopQueue = function () {\r\n            if (this.timerId !== null) {\r\n                cancelAnimationFrame(this.timerId);\r\n                this.timerId = null;\r\n            }\r\n            this.queue = [];\r\n        };\r\n        AsyncQueue.prototype.startQueue = function () {\r\n            var _this = this;\r\n            if (this.timerId) {\r\n                return;\r\n            }\r\n            this.timerId = requestAnimationFrame(function () {\r\n                _this.timerId = null;\r\n                var start = Date.now();\r\n                var cb;\r\n                while ((cb = _this.queue.shift())) {\r\n                    cb();\r\n                    if (Date.now() - start >= _this.frameDuration) {\r\n                        _this.startQueue();\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        };\r\n        return AsyncQueue;\r\n    }());\n\n    var imageManager = new AsyncQueue();\r\n    function getImageDetails(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n                        var dataURL, error_1, image_1, error_2;\r\n                        return __generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0:\r\n                                    if (!url.startsWith('data:')) return [3, 1];\r\n                                    dataURL = url;\r\n                                    return [3, 4];\r\n                                case 1:\r\n                                    _a.trys.push([1, 3, , 4]);\r\n                                    return [4, getImageDataURL(url)];\r\n                                case 2:\r\n                                    dataURL = _a.sent();\r\n                                    return [3, 4];\r\n                                case 3:\r\n                                    error_1 = _a.sent();\r\n                                    reject(error_1);\r\n                                    return [2];\r\n                                case 4:\r\n                                    _a.trys.push([4, 6, , 7]);\r\n                                    return [4, urlToImage(dataURL)];\r\n                                case 5:\r\n                                    image_1 = _a.sent();\r\n                                    imageManager.addToQueue(function () {\r\n                                        resolve(__assign({ src: url, dataURL: dataURL, width: image_1.naturalWidth, height: image_1.naturalHeight }, analyzeImage(image_1)));\r\n                                    });\r\n                                    return [3, 7];\r\n                                case 6:\r\n                                    error_2 = _a.sent();\r\n                                    reject(error_2);\r\n                                    return [3, 7];\r\n                                case 7: return [2];\r\n                            }\r\n                        });\r\n                    }); })];\r\n            });\r\n        });\r\n    }\r\n    function getImageDataURL(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parsedURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        parsedURL = new URL(url);\r\n                        if (!(parsedURL.origin === location.origin)) return [3, 2];\r\n                        return [4, loadAsDataURL(url)];\r\n                    case 1: return [2, _a.sent()];\r\n                    case 2: return [4, bgFetch({ url: url, responseType: 'data-url' })];\r\n                    case 3: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function urlToImage(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var image = new Image();\r\n                        image.onload = function () { return resolve(image); };\r\n                        image.onerror = function () { return reject(\"Unable to load image \" + url); };\r\n                        image.src = url;\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    var MAX_ANALIZE_PIXELS_COUNT = 32 * 32;\r\n    var canvas;\r\n    var context;\r\n    function createCanvas() {\r\n        var maxWidth = MAX_ANALIZE_PIXELS_COUNT;\r\n        var maxHeight = MAX_ANALIZE_PIXELS_COUNT;\r\n        canvas = document.createElement('canvas');\r\n        canvas.width = maxWidth;\r\n        canvas.height = maxHeight;\r\n        context = canvas.getContext('2d');\r\n        context.imageSmoothingEnabled = false;\r\n    }\r\n    function removeCanvas() {\r\n        canvas = null;\r\n        context = null;\r\n    }\r\n    var MAX_IMAGE_SIZE = 5 * 1024 * 1024;\r\n    function analyzeImage(image) {\r\n        if (!canvas) {\r\n            createCanvas();\r\n        }\r\n        var naturalWidth = image.naturalWidth, naturalHeight = image.naturalHeight;\r\n        if (naturalHeight === 0 || naturalWidth === 0) {\r\n            logWarn(\"logWarn(Image is empty \" + image.currentSrc + \")\");\r\n            return null;\r\n        }\r\n        var size = naturalWidth * naturalHeight * 4;\r\n        if (size > MAX_IMAGE_SIZE) {\r\n            logInfo('Skipped large image analyzing(Larger than 5mb in memory)');\r\n            return {\r\n                isDark: false,\r\n                isLight: false,\r\n                isTransparent: false,\r\n                isLarge: false,\r\n                isTooLarge: true,\r\n            };\r\n        }\r\n        var naturalPixelsCount = naturalWidth * naturalHeight;\r\n        var k = Math.min(1, Math.sqrt(MAX_ANALIZE_PIXELS_COUNT / naturalPixelsCount));\r\n        var width = Math.ceil(naturalWidth * k);\r\n        var height = Math.ceil(naturalHeight * k);\r\n        context.clearRect(0, 0, width, height);\r\n        context.drawImage(image, 0, 0, naturalWidth, naturalHeight, 0, 0, width, height);\r\n        var imageData = context.getImageData(0, 0, width, height);\r\n        var d = imageData.data;\r\n        var TRANSPARENT_ALPHA_THRESHOLD = 0.05;\r\n        var DARK_LIGHTNESS_THRESHOLD = 0.4;\r\n        var LIGHT_LIGHTNESS_THRESHOLD = 0.7;\r\n        var transparentPixelsCount = 0;\r\n        var darkPixelsCount = 0;\r\n        var lightPixelsCount = 0;\r\n        var i, x, y;\r\n        var r, g, b, a;\r\n        var l;\r\n        for (y = 0; y < height; y++) {\r\n            for (x = 0; x < width; x++) {\r\n                i = 4 * (y * width + x);\r\n                r = d[i + 0] / 255;\r\n                g = d[i + 1] / 255;\r\n                b = d[i + 2] / 255;\r\n                a = d[i + 3] / 255;\r\n                if (a < TRANSPARENT_ALPHA_THRESHOLD) {\r\n                    transparentPixelsCount++;\r\n                }\r\n                else {\r\n                    l = 0.2126 * r + 0.7152 * g + 0.0722 * b;\r\n                    if (l < DARK_LIGHTNESS_THRESHOLD) {\r\n                        darkPixelsCount++;\r\n                    }\r\n                    if (l > LIGHT_LIGHTNESS_THRESHOLD) {\r\n                        lightPixelsCount++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var totalPixelsCount = width * height;\r\n        var opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\r\n        var DARK_IMAGE_THRESHOLD = 0.7;\r\n        var LIGHT_IMAGE_THRESHOLD = 0.7;\r\n        var TRANSPARENT_IMAGE_THRESHOLD = 0.1;\r\n        var LARGE_IMAGE_PIXELS_COUNT = 800 * 600;\r\n        return {\r\n            isDark: ((darkPixelsCount / opaquePixelsCount) >= DARK_IMAGE_THRESHOLD),\r\n            isLight: ((lightPixelsCount / opaquePixelsCount) >= LIGHT_IMAGE_THRESHOLD),\r\n            isTransparent: ((transparentPixelsCount / totalPixelsCount) >= TRANSPARENT_IMAGE_THRESHOLD),\r\n            isLarge: (naturalPixelsCount >= LARGE_IMAGE_PIXELS_COUNT),\r\n            isTooLarge: false,\r\n        };\r\n    }\r\n    function getFilteredImageDataURL(_a, theme) {\r\n        var dataURL = _a.dataURL, width = _a.width, height = _a.height;\r\n        var matrix = getSVGFilterMatrixValue(theme);\r\n        var svg = [\r\n            \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\">\",\r\n            '<defs>',\r\n            '<filter id=\"darkreader-image-filter\">',\r\n            \"<feColorMatrix type=\\\"matrix\\\" values=\\\"\" + matrix + \"\\\" />\",\r\n            '</filter>',\r\n            '</defs>',\r\n            \"<image width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\" filter=\\\"url(#darkreader-image-filter)\\\" xlink:href=\\\"\" + dataURL + \"\\\" />\",\r\n            '</svg>',\r\n        ].join('');\r\n        return \"data:image/svg+xml;base64,\" + btoa(svg);\r\n    }\r\n    function cleanImageProcessingCache() {\r\n        imageManager && imageManager.stopQueue();\r\n        removeCanvas();\r\n    }\n\n    function getPriority(ruleStyle, property) {\r\n        return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\r\n    }\r\n    function getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageSelectors, isCancelled) {\r\n        if (property.startsWith('--')) {\r\n            var modifier = getVariableModifier(variablesStore, property, value, rule, ignoreImageSelectors, isCancelled);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (value.includes('var(')) {\r\n            var modifier = getVariableDependantModifier(variablesStore, property, value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if ((property.includes('color') && property !== '-webkit-print-color-adjust') ||\r\n            property === 'fill' ||\r\n            property === 'stroke' ||\r\n            property === 'stop-color') {\r\n            var modifier = getColorModifier(property, value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (property === 'background-image' || property === 'list-style-image') {\r\n            var modifier = getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (property.includes('shadow')) {\r\n            var modifier = getShadowModifier(value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\r\n        var lines = [];\r\n        if (!isIFrame) {\r\n            lines.push('html {');\r\n            lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme) + \" !important;\");\r\n            lines.push('}');\r\n        }\r\n        lines.push(\"\" + (isIFrame ? '' : 'html, body, ') + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push(\"html, body, \" + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 76, g: 76, b: 76 }, theme) + \";\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('a {');\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 64, b: 255 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('table {');\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 128, g: 128, b: 128 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('::placeholder {');\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 169, g: 169, b: 169 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('input:-webkit-autofill,');\r\n        lines.push('textarea:-webkit-autofill,');\r\n        lines.push('select:-webkit-autofill {');\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 250, g: 255, b: 189 }, theme) + \" !important;\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, theme) + \" !important;\");\r\n        lines.push('}');\r\n        if (theme.scrollbarColor) {\r\n            lines.push(getModifiedScrollbarStyle(theme));\r\n        }\r\n        if (theme.selectionColor) {\r\n            lines.push(getModifiedSelectionStyle(theme));\r\n        }\r\n        return lines.join('\\n');\r\n    }\r\n    function getSelectionColor(theme) {\r\n        var backgroundColorSelection;\r\n        var foregroundColorSelection;\r\n        if (theme.selectionColor === 'auto') {\r\n            backgroundColorSelection = modifyBackgroundColor({ r: 0, g: 96, b: 212 }, __assign(__assign({}, theme), { grayscale: 0 }));\r\n            foregroundColorSelection = modifyForegroundColor({ r: 255, g: 255, b: 255 }, __assign(__assign({}, theme), { grayscale: 0 }));\r\n        }\r\n        else {\r\n            var rgb = parse(theme.selectionColor);\r\n            var hsl = rgbToHSL(rgb);\r\n            backgroundColorSelection = theme.selectionColor;\r\n            if (hsl.l < 0.5) {\r\n                foregroundColorSelection = '#FFF';\r\n            }\r\n            else {\r\n                foregroundColorSelection = '#000';\r\n            }\r\n        }\r\n        return { backgroundColorSelection: backgroundColorSelection, foregroundColorSelection: foregroundColorSelection };\r\n    }\r\n    function getModifiedSelectionStyle(theme) {\r\n        var lines = [];\r\n        var modifiedSelectionColor = getSelectionColor(theme);\r\n        var backgroundColorSelection = modifiedSelectionColor.backgroundColorSelection;\r\n        var foregroundColorSelection = modifiedSelectionColor.foregroundColorSelection;\r\n        ['::selection', '::-moz-selection'].forEach(function (selection) {\r\n            lines.push(selection + \" {\");\r\n            lines.push(\"    background-color: \" + backgroundColorSelection + \" !important;\");\r\n            lines.push(\"    color: \" + foregroundColorSelection + \" !important;\");\r\n            lines.push('}');\r\n        });\r\n        return lines.join('\\n');\r\n    }\r\n    function getModifiedScrollbarStyle(theme) {\r\n        var lines = [];\r\n        var colorTrack;\r\n        var colorIcons;\r\n        var colorThumb;\r\n        var colorThumbHover;\r\n        var colorThumbActive;\r\n        var colorCorner;\r\n        if (theme.scrollbarColor === 'auto') {\r\n            colorTrack = modifyBackgroundColor({ r: 241, g: 241, b: 241 }, theme);\r\n            colorIcons = modifyForegroundColor({ r: 96, g: 96, b: 96 }, theme);\r\n            colorThumb = modifyBackgroundColor({ r: 176, g: 176, b: 176 }, theme);\r\n            colorThumbHover = modifyBackgroundColor({ r: 144, g: 144, b: 144 }, theme);\r\n            colorThumbActive = modifyBackgroundColor({ r: 96, g: 96, b: 96 }, theme);\r\n            colorCorner = modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme);\r\n        }\r\n        else {\r\n            var rgb = parse(theme.scrollbarColor);\r\n            var hsl_1 = rgbToHSL(rgb);\r\n            var isLight = hsl_1.l > 0.5;\r\n            var lighten = function (lighter) { return (__assign(__assign({}, hsl_1), { l: clamp(hsl_1.l + lighter, 0, 1) })); };\r\n            var darken = function (darker) { return (__assign(__assign({}, hsl_1), { l: clamp(hsl_1.l - darker, 0, 1) })); };\r\n            colorTrack = hslToString(darken(0.4));\r\n            colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\r\n            colorThumb = hslToString(hsl_1);\r\n            colorThumbHover = hslToString(lighten(0.1));\r\n            colorThumbActive = hslToString(lighten(0.2));\r\n        }\r\n        lines.push('::-webkit-scrollbar {');\r\n        lines.push(\"    background-color: \" + colorTrack + \";\");\r\n        lines.push(\"    color: \" + colorIcons + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb {');\r\n        lines.push(\"    background-color: \" + colorThumb + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb:hover {');\r\n        lines.push(\"    background-color: \" + colorThumbHover + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb:active {');\r\n        lines.push(\"    background-color: \" + colorThumbActive + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-corner {');\r\n        lines.push(\"    background-color: \" + colorCorner + \";\");\r\n        lines.push('}');\r\n        if (isFirefox) {\r\n            lines.push('* {');\r\n            lines.push(\"    scrollbar-color: \" + colorThumb + \" \" + colorTrack + \";\");\r\n            lines.push('}');\r\n        }\r\n        return lines.join('\\n');\r\n    }\r\n    function getModifiedFallbackStyle(filter, _a) {\r\n        var strict = _a.strict;\r\n        var lines = [];\r\n        var isMicrosoft = location.hostname.endsWith('microsoft.com');\r\n        lines.push(\"html, body, \" + (strict ? \"body :not(iframe)\" + (isMicrosoft ? ':not(div[style^=\"position:absolute;top:0;left:-\"]' : '') : 'body > :not(iframe)') + \" {\");\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, filter) + \" !important;\");\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 64, g: 64, b: 64 }, filter) + \" !important;\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, filter) + \" !important;\");\r\n        lines.push('}');\r\n        return lines.join('\\n');\r\n    }\r\n    var unparsableColors = new Set([\r\n        'inherit',\r\n        'transparent',\r\n        'initial',\r\n        'currentcolor',\r\n        'none',\r\n        'unset',\r\n    ]);\r\n    var colorParseCache = new Map();\r\n    function parseColorWithCache($color) {\r\n        $color = $color.trim();\r\n        if (colorParseCache.has($color)) {\r\n            return colorParseCache.get($color);\r\n        }\r\n        if ($color.includes('calc(')) {\r\n            $color = lowerCalcExpression($color);\r\n        }\r\n        var color = parse($color);\r\n        colorParseCache.set($color, color);\r\n        return color;\r\n    }\r\n    function tryParseColor($color) {\r\n        try {\r\n            return parseColorWithCache($color);\r\n        }\r\n        catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    function getColorModifier(prop, value) {\r\n        if (unparsableColors.has(value.toLowerCase())) {\r\n            return value;\r\n        }\r\n        try {\r\n            var rgb_1 = parseColorWithCache(value);\r\n            if (prop.includes('background')) {\r\n                return function (filter) { return modifyBackgroundColor(rgb_1, filter); };\r\n            }\r\n            if (prop.includes('border') || prop.includes('outline')) {\r\n                return function (filter) { return modifyBorderColor(rgb_1, filter); };\r\n            }\r\n            return function (filter) { return modifyForegroundColor(rgb_1, filter); };\r\n        }\r\n        catch (err) {\r\n            logWarn('Color parse error', err);\r\n            return null;\r\n        }\r\n    }\r\n    var gradientRegex = /[\\-a-z]+gradient\\(([^\\(\\)]*(\\(([^\\(\\)]*(\\(.*?\\)))*[^\\(\\)]*\\))){0,15}[^\\(\\)]*\\)/g;\r\n    var imageDetailsCache = new Map();\r\n    var awaitingForImageLoading = new Map();\r\n    function shouldIgnoreImage(selectorText, selectors) {\r\n        if (!selectorText || selectors.length === 0) {\r\n            return false;\r\n        }\r\n        if (selectors.some(function (s) { return s === '*'; })) {\r\n            return true;\r\n        }\r\n        var ruleSelectors = selectorText.split(/,\\s*/g);\r\n        var _loop_1 = function (i) {\r\n            var ignoredSelector = selectors[i];\r\n            if (ruleSelectors.some(function (s) { return s === ignoredSelector; })) {\r\n                return { value: true };\r\n            }\r\n        };\r\n        for (var i = 0; i < selectors.length; i++) {\r\n            var state_1 = _loop_1(i);\r\n            if (typeof state_1 === \"object\")\r\n                return state_1.value;\r\n        }\r\n        return false;\r\n    }\r\n    function getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled) {\r\n        var _this = this;\r\n        try {\r\n            var gradients = getMatches(gradientRegex, value);\r\n            var urls = getMatches(cssURLRegex, value);\r\n            if (urls.length === 0 && gradients.length === 0) {\r\n                return value;\r\n            }\r\n            var getIndices = function (matches) {\r\n                var index = 0;\r\n                return matches.map(function (match) {\r\n                    var valueIndex = value.indexOf(match, index);\r\n                    index = valueIndex + match.length;\r\n                    return { match: match, index: valueIndex };\r\n                });\r\n            };\r\n            var matches_1 = getIndices(urls).map(function (i) { return (__assign({ type: 'url' }, i)); })\r\n                .concat(getIndices(gradients).map(function (i) { return (__assign({ type: 'gradient' }, i)); }))\r\n                .sort(function (a, b) { return a.index - b.index; });\r\n            var getGradientModifier_1 = function (gradient) {\r\n                var match = gradient.match(/^(.*-gradient)\\((.*)\\)$/);\r\n                var type = match[1];\r\n                var content = match[2];\r\n                var partsRegex = /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?[^\\(\\),]*),?/g;\r\n                var colorStopRegex = /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\r\n                var parts = getMatches(partsRegex, content, 1).map(function (part) {\r\n                    part = part.trim();\r\n                    var rgb = tryParseColor(part);\r\n                    if (rgb) {\r\n                        return function (filter) { return modifyGradientColor(rgb, filter); };\r\n                    }\r\n                    var space = part.lastIndexOf(' ');\r\n                    rgb = tryParseColor(part.substring(0, space));\r\n                    if (rgb) {\r\n                        return function (filter) { return modifyGradientColor(rgb, filter) + \" \" + part.substring(space + 1); };\r\n                    }\r\n                    var colorStopMatch = part.match(colorStopRegex);\r\n                    if (colorStopMatch) {\r\n                        rgb = tryParseColor(colorStopMatch[3]);\r\n                        if (rgb) {\r\n                            return function (filter) { return colorStopMatch[1] + \"(\" + (colorStopMatch[2] ? colorStopMatch[2] + \", \" : '') + modifyGradientColor(rgb, filter) + \")\"; };\r\n                        }\r\n                    }\r\n                    return function () { return part; };\r\n                });\r\n                return function (filter) {\r\n                    return type + \"(\" + parts.map(function (modify) { return modify(filter); }).join(', ') + \")\";\r\n                };\r\n            };\r\n            var getURLModifier_1 = function (urlValue) {\r\n                var _a;\r\n                if (shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)) {\r\n                    return null;\r\n                }\r\n                var url = getCSSURLValue(urlValue);\r\n                var parentStyleSheet = rule.parentStyleSheet;\r\n                var baseURL = (parentStyleSheet && parentStyleSheet.href) ?\r\n                    getCSSBaseBath(parentStyleSheet.href) :\r\n                    ((_a = parentStyleSheet.ownerNode) === null || _a === void 0 ? void 0 : _a.baseURI) || location.origin;\r\n                url = getAbsoluteURL(baseURL, url);\r\n                var absoluteValue = \"url(\\\"\" + url + \"\\\")\";\r\n                return function (filter) { return __awaiter(_this, void 0, void 0, function () {\r\n                    var imageDetails, awaiters_1, err_1, bgImageValue;\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                if (!imageDetailsCache.has(url)) return [3, 1];\r\n                                imageDetails = imageDetailsCache.get(url);\r\n                                return [3, 7];\r\n                            case 1:\r\n                                _a.trys.push([1, 6, , 7]);\r\n                                if (!awaitingForImageLoading.has(url)) return [3, 3];\r\n                                awaiters_1 = awaitingForImageLoading.get(url);\r\n                                return [4, new Promise(function (resolve) { return awaiters_1.push(resolve); })];\r\n                            case 2:\r\n                                imageDetails = _a.sent();\r\n                                if (!imageDetails) {\r\n                                    return [2, null];\r\n                                }\r\n                                return [3, 5];\r\n                            case 3:\r\n                                awaitingForImageLoading.set(url, []);\r\n                                return [4, getImageDetails(url)];\r\n                            case 4:\r\n                                imageDetails = _a.sent();\r\n                                imageDetailsCache.set(url, imageDetails);\r\n                                awaitingForImageLoading.get(url).forEach(function (resolve) { return resolve(imageDetails); });\r\n                                awaitingForImageLoading.delete(url);\r\n                                _a.label = 5;\r\n                            case 5:\r\n                                if (isCancelled()) {\r\n                                    return [2, null];\r\n                                }\r\n                                return [3, 7];\r\n                            case 6:\r\n                                err_1 = _a.sent();\r\n                                logWarn(err_1);\r\n                                if (awaitingForImageLoading.has(url)) {\r\n                                    awaitingForImageLoading.get(url).forEach(function (resolve) { return resolve(null); });\r\n                                    awaitingForImageLoading.delete(url);\r\n                                }\r\n                                return [2, absoluteValue];\r\n                            case 7:\r\n                                bgImageValue = getBgImageValue_1(imageDetails, filter) || absoluteValue;\r\n                                return [2, bgImageValue];\r\n                        }\r\n                    });\r\n                }); };\r\n            };\r\n            var getBgImageValue_1 = function (imageDetails, filter) {\r\n                var isDark = imageDetails.isDark, isLight = imageDetails.isLight, isTransparent = imageDetails.isTransparent, isLarge = imageDetails.isLarge, isTooLarge = imageDetails.isTooLarge, width = imageDetails.width;\r\n                var result;\r\n                if (isTooLarge) {\r\n                    result = \"url(\\\"\" + imageDetails.src + \"\\\")\";\r\n                }\r\n                else if (isDark && isTransparent && filter.mode === 1 && !isLarge && width > 2) {\r\n                    logInfo(\"Inverting dark image \" + imageDetails.src);\r\n                    var inverted = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), { sepia: clamp(filter.sepia + 10, 0, 100) }));\r\n                    result = \"url(\\\"\" + inverted + \"\\\")\";\r\n                }\r\n                else if (isLight && !isTransparent && filter.mode === 1) {\r\n                    if (isLarge) {\r\n                        result = 'none';\r\n                    }\r\n                    else {\r\n                        logInfo(\"Dimming light image \" + imageDetails.src);\r\n                        var dimmed = getFilteredImageDataURL(imageDetails, filter);\r\n                        result = \"url(\\\"\" + dimmed + \"\\\")\";\r\n                    }\r\n                }\r\n                else if (filter.mode === 0 && isLight && !isLarge) {\r\n                    logInfo(\"Applying filter to image \" + imageDetails.src);\r\n                    var filtered = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), { brightness: clamp(filter.brightness - 10, 5, 200), sepia: clamp(filter.sepia + 10, 0, 100) }));\r\n                    result = \"url(\\\"\" + filtered + \"\\\")\";\r\n                }\r\n                else {\r\n                    result = null;\r\n                }\r\n                return result;\r\n            };\r\n            var modifiers_1 = [];\r\n            var index_1 = 0;\r\n            matches_1.forEach(function (_a, i) {\r\n                var match = _a.match, type = _a.type, matchStart = _a.index;\r\n                var prefixStart = index_1;\r\n                var matchEnd = matchStart + match.length;\r\n                index_1 = matchEnd;\r\n                modifiers_1.push(function () { return value.substring(prefixStart, matchStart); });\r\n                modifiers_1.push(type === 'url' ? getURLModifier_1(match) : getGradientModifier_1(match));\r\n                if (i === matches_1.length - 1) {\r\n                    modifiers_1.push(function () { return value.substring(matchEnd); });\r\n                }\r\n            });\r\n            return function (filter) {\r\n                var results = modifiers_1.filter(Boolean).map(function (modify) { return modify(filter); });\r\n                if (results.some(function (r) { return r instanceof Promise; })) {\r\n                    return Promise.all(results)\r\n                        .then(function (asyncResults) {\r\n                        return asyncResults.join('');\r\n                    });\r\n                }\r\n                return results.join('');\r\n            };\r\n        }\r\n        catch (err) {\r\n            logWarn(\"Unable to parse gradient \" + value, err);\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifierWithInfo(value) {\r\n        try {\r\n            var index_2 = 0;\r\n            var colorMatches_1 = getMatches(/(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/ig, value, 2);\r\n            var notParsed_1 = 0;\r\n            var modifiers_2 = colorMatches_1.map(function (match, i) {\r\n                var prefixIndex = index_2;\r\n                var matchIndex = value.indexOf(match, index_2);\r\n                var matchEnd = matchIndex + match.length;\r\n                index_2 = matchEnd;\r\n                var rgb = tryParseColor(match);\r\n                if (!rgb) {\r\n                    notParsed_1++;\r\n                    return function () { return value.substring(prefixIndex, matchEnd); };\r\n                }\r\n                return function (filter) { return \"\" + value.substring(prefixIndex, matchIndex) + modifyShadowColor(rgb, filter) + (i === colorMatches_1.length - 1 ? value.substring(matchEnd) : ''); };\r\n            });\r\n            return function (filter) {\r\n                var modified = modifiers_2.map(function (modify) { return modify(filter); }).join('');\r\n                return {\r\n                    matchesLength: colorMatches_1.length,\r\n                    unparseableMatchesLength: notParsed_1,\r\n                    result: modified,\r\n                };\r\n            };\r\n        }\r\n        catch (err) {\r\n            logWarn(\"Unable to parse shadow \" + value, err);\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifier(value) {\r\n        var shadowModifier = getShadowModifierWithInfo(value);\r\n        if (!shadowModifier) {\r\n            return null;\r\n        }\r\n        return function (theme) { return shadowModifier(theme).result; };\r\n    }\r\n    function getVariableModifier(variablesStore, prop, value, rule, ignoredImgSelectors, isCancelled) {\r\n        return variablesStore.getModifierForVariable({\r\n            varName: prop,\r\n            sourceValue: value,\r\n            rule: rule,\r\n            ignoredImgSelectors: ignoredImgSelectors,\r\n            isCancelled: isCancelled,\r\n        });\r\n    }\r\n    function getVariableDependantModifier(variablesStore, prop, value) {\r\n        return variablesStore.getModifierForVarDependant(prop, value);\r\n    }\r\n    function cleanModificationCache() {\r\n        colorParseCache.clear();\r\n        clearColorModificationCache();\r\n        imageDetailsCache.clear();\r\n        cleanImageProcessingCache();\r\n        awaitingForImageLoading.clear();\r\n    }\n\n    var VAR_TYPE_BGCOLOR = 1 << 0;\r\n    var VAR_TYPE_TEXTCOLOR = 1 << 1;\r\n    var VAR_TYPE_BORDERCOLOR = 1 << 2;\r\n    var VAR_TYPE_BGIMG = 1 << 3;\r\n    var VariablesStore = (function () {\r\n        function VariablesStore() {\r\n            this.varTypes = new Map();\r\n            this.rulesQueue = [];\r\n            this.definedVars = new Set();\r\n            this.varRefs = new Map();\r\n            this.unknownColorVars = new Set();\r\n            this.unknownBgVars = new Set();\r\n            this.undefinedVars = new Set();\r\n            this.initialVarTypes = new Map();\r\n            this.changedTypeVars = new Set();\r\n            this.typeChangeSubscriptions = new Map();\r\n            this.unstableVarValues = new Map();\r\n        }\r\n        VariablesStore.prototype.clear = function () {\r\n            this.varTypes.clear();\r\n            this.rulesQueue.splice(0);\r\n            this.definedVars.clear();\r\n            this.varRefs.clear();\r\n            this.unknownColorVars.clear();\r\n            this.unknownBgVars.clear();\r\n            this.undefinedVars.clear();\r\n            this.initialVarTypes.clear();\r\n            this.changedTypeVars.clear();\r\n            this.typeChangeSubscriptions.clear();\r\n            this.unstableVarValues.clear();\r\n        };\r\n        VariablesStore.prototype.isVarType = function (varName, typeNum) {\r\n            return (this.varTypes.has(varName) &&\r\n                (this.varTypes.get(varName) & typeNum) > 0);\r\n        };\r\n        VariablesStore.prototype.addRulesForMatching = function (rules) {\r\n            this.rulesQueue.push(rules);\r\n        };\r\n        VariablesStore.prototype.matchVariablesAndDependants = function () {\r\n            var _this = this;\r\n            this.changedTypeVars.clear();\r\n            this.initialVarTypes = new Map(this.varTypes);\r\n            this.collectRootVariables();\r\n            this.collectVariablesAndVarDep(this.rulesQueue);\r\n            this.rulesQueue.splice(0);\r\n            this.collectRootVarDependants();\r\n            this.varRefs.forEach(function (refs, v) {\r\n                refs.forEach(function (r) {\r\n                    if (_this.varTypes.has(v)) {\r\n                        _this.resolveVariableType(r, _this.varTypes.get(v));\r\n                    }\r\n                });\r\n            });\r\n            this.unknownColorVars.forEach(function (v) {\r\n                if (_this.unknownBgVars.has(v)) {\r\n                    _this.unknownColorVars.delete(v);\r\n                    _this.unknownBgVars.delete(v);\r\n                    _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\r\n                }\r\n                else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR)) {\r\n                    _this.unknownColorVars.delete(v);\r\n                }\r\n                else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.unknownBgVars.forEach(function (v) {\r\n                var hasColor = _this.findVarRef(v, function (ref) {\r\n                    return (_this.unknownColorVars.has(ref) ||\r\n                        _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR));\r\n                }) != null;\r\n                if (hasColor) {\r\n                    _this.itarateVarRefs(v, function (ref) {\r\n                        _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                    });\r\n                }\r\n                else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                    _this.unknownBgVars.delete(v);\r\n                }\r\n                else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.changedTypeVars.forEach(function (varName) {\r\n                if (_this.typeChangeSubscriptions.has(varName)) {\r\n                    _this.typeChangeSubscriptions\r\n                        .get(varName)\r\n                        .forEach(function (callback) {\r\n                        callback();\r\n                    });\r\n                }\r\n            });\r\n            this.changedTypeVars.clear();\r\n        };\r\n        VariablesStore.prototype.getModifierForVariable = function (options) {\r\n            var _this = this;\r\n            return function (theme) {\r\n                var varName = options.varName, sourceValue = options.sourceValue, rule = options.rule, ignoredImgSelectors = options.ignoredImgSelectors, isCancelled = options.isCancelled;\r\n                var getDeclarations = function () {\r\n                    var declarations = [];\r\n                    var addModifiedValue = function (typeNum, varNameWrapper, colorModifier) {\r\n                        if (!_this.isVarType(varName, typeNum)) {\r\n                            return;\r\n                        }\r\n                        var property = varNameWrapper(varName);\r\n                        var modifiedValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            if (isConstructedColorVar(sourceValue)) {\r\n                                var value = insertVarValues(sourceValue, _this.unstableVarValues);\r\n                                if (!value) {\r\n                                    value = typeNum === VAR_TYPE_BGCOLOR ? '#ffffff' : '#000000';\r\n                                }\r\n                                modifiedValue = colorModifier(value, theme);\r\n                            }\r\n                            else {\r\n                                modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) { return varNameWrapper(v); }, function (fallback) { return colorModifier(fallback, theme); });\r\n                            }\r\n                        }\r\n                        else {\r\n                            modifiedValue = colorModifier(sourceValue, theme);\r\n                        }\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue,\r\n                        });\r\n                    };\r\n                    addModifiedValue(VAR_TYPE_BGCOLOR, wrapBgColorVariableName, tryModifyBgColor);\r\n                    addModifiedValue(VAR_TYPE_TEXTCOLOR, wrapTextColorVariableName, tryModifyTextColor);\r\n                    addModifiedValue(VAR_TYPE_BORDERCOLOR, wrapBorderColorVariableName, tryModifyBorderColor);\r\n                    if (_this.isVarType(varName, VAR_TYPE_BGIMG)) {\r\n                        var property = wrapBgImgVariableName(varName);\r\n                        var modifiedValue = sourceValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) { return wrapBgColorVariableName(v); }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                        }\r\n                        var bgModifier = getBgImageModifier(modifiedValue, rule, ignoredImgSelectors, isCancelled);\r\n                        modifiedValue = typeof bgModifier === 'function' ? bgModifier(theme) : bgModifier;\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue,\r\n                        });\r\n                    }\r\n                    return declarations;\r\n                };\r\n                var callbacks = new Set();\r\n                var addListener = function (onTypeChange) {\r\n                    var callback = function () {\r\n                        var decs = getDeclarations();\r\n                        onTypeChange(decs);\r\n                    };\r\n                    callbacks.add(callback);\r\n                    _this.subscribeForVarTypeChange(varName, callback);\r\n                };\r\n                var removeListeners = function () {\r\n                    callbacks.forEach(function (callback) {\r\n                        _this.unsubscribeFromVariableTypeChanges(varName, callback);\r\n                    });\r\n                };\r\n                return {\r\n                    declarations: getDeclarations(),\r\n                    onTypeChange: { addListener: addListener, removeListeners: removeListeners },\r\n                };\r\n            };\r\n        };\r\n        VariablesStore.prototype.getModifierForVarDependant = function (property, sourceValue) {\r\n            var _this = this;\r\n            if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\r\n                var isBg_1 = property.startsWith('background');\r\n                var isText_1 = (property === 'color' || property === 'caret-color');\r\n                return function (theme) {\r\n                    var value = insertVarValues(sourceValue, _this.unstableVarValues);\r\n                    if (!value) {\r\n                        value = isBg_1 ? '#ffffff' : '#000000';\r\n                    }\r\n                    var modifier = isBg_1 ? tryModifyBgColor : isText_1 ? tryModifyTextColor : tryModifyBorderColor;\r\n                    return modifier(value, theme);\r\n                };\r\n            }\r\n            if (property === 'background-color') {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapBgColorVariableName(v); }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                };\r\n            }\r\n            if (property === 'color' || property === 'caret-color') {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapTextColorVariableName(v); }, function (fallback) { return tryModifyTextColor(fallback, theme); });\r\n                };\r\n            }\r\n            if (property === 'background' || property === 'background-image' || property === 'box-shadow') {\r\n                return function (theme) {\r\n                    var unknownVars = new Set();\r\n                    var modify = function () {\r\n                        var variableReplaced = replaceCSSVariablesNames(sourceValue, function (v) {\r\n                            if (_this.isVarType(v, VAR_TYPE_BGCOLOR)) {\r\n                                return wrapBgColorVariableName(v);\r\n                            }\r\n                            if (_this.isVarType(v, VAR_TYPE_BGIMG)) {\r\n                                return wrapBgImgVariableName(v);\r\n                            }\r\n                            unknownVars.add(v);\r\n                            return v;\r\n                        }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                        if (property === 'box-shadow') {\r\n                            var shadowModifier = getShadowModifierWithInfo(variableReplaced);\r\n                            var modifiedShadow = shadowModifier(theme);\r\n                            if (modifiedShadow.unparseableMatchesLength !== modifiedShadow.matchesLength) {\r\n                                return modifiedShadow.result;\r\n                            }\r\n                        }\r\n                        return variableReplaced;\r\n                    };\r\n                    var modified = modify();\r\n                    if (unknownVars.size > 0) {\r\n                        return new Promise(function (resolve) {\r\n                            var firstUnknownVar = unknownVars.values().next().value;\r\n                            var callback = function () {\r\n                                _this.unsubscribeFromVariableTypeChanges(firstUnknownVar, callback);\r\n                                var newValue = modify();\r\n                                resolve(newValue);\r\n                            };\r\n                            _this.subscribeForVarTypeChange(firstUnknownVar, callback);\r\n                        });\r\n                    }\r\n                    return modified;\r\n                };\r\n            }\r\n            if (property.startsWith('border') || property.startsWith('outline')) {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapBorderColorVariableName(v); }, function (fallback) { return tryModifyBorderColor(fallback, theme); });\r\n                };\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.subscribeForVarTypeChange = function (varName, callback) {\r\n            if (!this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.set(varName, new Set());\r\n            }\r\n            var rootStore = this.typeChangeSubscriptions.get(varName);\r\n            if (!rootStore.has(callback)) {\r\n                rootStore.add(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.unsubscribeFromVariableTypeChanges = function (varName, callback) {\r\n            if (this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.get(varName).delete(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.collectVariablesAndVarDep = function (ruleList) {\r\n            var _this = this;\r\n            ruleList.forEach(function (rules) {\r\n                iterateCSSRules(rules, function (rule) {\r\n                    rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\r\n                        if (isVariable(property)) {\r\n                            _this.inspectVariable(property, value);\r\n                        }\r\n                        if (isVarDependant(value)) {\r\n                            _this.inspectVarDependant(property, value);\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n        };\r\n        VariablesStore.prototype.collectRootVariables = function () {\r\n            var _this = this;\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVariable(property)) {\r\n                    _this.inspectVariable(property, value);\r\n                }\r\n            });\r\n        };\r\n        VariablesStore.prototype.inspectVariable = function (varName, value) {\r\n            this.unstableVarValues.set(varName, value);\r\n            if (isVarDependant(value) && isConstructedColorVar(value)) {\r\n                this.unknownColorVars.add(varName);\r\n                this.definedVars.add(varName);\r\n            }\r\n            if (this.definedVars.has(varName)) {\r\n                return;\r\n            }\r\n            this.definedVars.add(varName);\r\n            var color = tryParseColor(value);\r\n            if (color) {\r\n                this.unknownColorVars.add(varName);\r\n            }\r\n            else if (value.includes('url(') ||\r\n                value.includes('linear-gradient(') ||\r\n                value.includes('radial-gradient(')) {\r\n                this.resolveVariableType(varName, VAR_TYPE_BGIMG);\r\n            }\r\n        };\r\n        VariablesStore.prototype.resolveVariableType = function (varName, typeNum) {\r\n            var initialType = this.initialVarTypes.get(varName) || 0;\r\n            var currentType = this.varTypes.get(varName) || 0;\r\n            var newType = currentType | typeNum;\r\n            this.varTypes.set(varName, newType);\r\n            if (newType !== initialType || this.undefinedVars.has(varName)) {\r\n                this.changedTypeVars.add(varName);\r\n                this.undefinedVars.delete(varName);\r\n            }\r\n            this.unknownColorVars.delete(varName);\r\n            this.unknownBgVars.delete(varName);\r\n        };\r\n        VariablesStore.prototype.collectRootVarDependants = function () {\r\n            var _this = this;\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVarDependant(value)) {\r\n                    _this.inspectVarDependant(property, value);\r\n                }\r\n            });\r\n        };\r\n        VariablesStore.prototype.inspectVarDependant = function (property, value) {\r\n            var _this = this;\r\n            if (isVariable(property)) {\r\n                this.iterateVarDeps(value, function (ref) {\r\n                    if (!_this.varRefs.has(property)) {\r\n                        _this.varRefs.set(property, new Set());\r\n                    }\r\n                    _this.varRefs.get(property).add(ref);\r\n                });\r\n            }\r\n            else if (property === 'background-color' || property === 'box-shadow') {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_BGCOLOR); });\r\n            }\r\n            else if (property === 'color' || property === 'caret-color') {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR); });\r\n            }\r\n            else if (property.startsWith('border') || property.startsWith('outline')) {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR); });\r\n            }\r\n            else if (property === 'background' || property === 'background-image') {\r\n                this.iterateVarDeps(value, function (v) {\r\n                    if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                        return;\r\n                    }\r\n                    var isBgColor = _this.findVarRef(v, function (ref) {\r\n                        return (_this.unknownColorVars.has(ref) ||\r\n                            _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR));\r\n                    }) != null;\r\n                    _this.itarateVarRefs(v, function (ref) {\r\n                        if (isBgColor) {\r\n                            _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                        }\r\n                        else {\r\n                            _this.unknownBgVars.add(ref);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        };\r\n        VariablesStore.prototype.iterateVarDeps = function (value, iterator) {\r\n            var varDeps = new Set();\r\n            iterateVarDependencies(value, function (v) { return varDeps.add(v); });\r\n            varDeps.forEach(function (v) { return iterator(v); });\r\n        };\r\n        VariablesStore.prototype.findVarRef = function (varName, iterator, stack) {\r\n            var e_1, _a;\r\n            if (stack === void 0) { stack = new Set(); }\r\n            if (stack.has(varName)) {\r\n                return null;\r\n            }\r\n            stack.add(varName);\r\n            var result = iterator(varName);\r\n            if (result) {\r\n                return varName;\r\n            }\r\n            var refs = this.varRefs.get(varName);\r\n            if (!refs || refs.size === 0) {\r\n                return null;\r\n            }\r\n            try {\r\n                for (var refs_1 = __values(refs), refs_1_1 = refs_1.next(); !refs_1_1.done; refs_1_1 = refs_1.next()) {\r\n                    var ref = refs_1_1.value;\r\n                    var found = this.findVarRef(ref, iterator, stack);\r\n                    if (found) {\r\n                        return found;\r\n                    }\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (refs_1_1 && !refs_1_1.done && (_a = refs_1.return)) _a.call(refs_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.itarateVarRefs = function (varName, iterator) {\r\n            this.findVarRef(varName, function (ref) {\r\n                iterator(ref);\r\n                return false;\r\n            });\r\n        };\r\n        VariablesStore.prototype.setOnRootVariableChange = function (callback) {\r\n            this.onRootVariableDefined = callback;\r\n        };\r\n        VariablesStore.prototype.putRootVars = function (styleElement, theme) {\r\n            var e_2, _a;\r\n            var _this = this;\r\n            var sheet = styleElement.sheet;\r\n            if (sheet.cssRules.length > 0) {\r\n                sheet.deleteRule(0);\r\n            }\r\n            var declarations = new Map();\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVariable(property)) {\r\n                    if (_this.isVarType(property, VAR_TYPE_BGCOLOR)) {\r\n                        declarations.set(wrapBgColorVariableName(property), tryModifyBgColor(value, theme));\r\n                    }\r\n                    if (_this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\r\n                        declarations.set(wrapTextColorVariableName(property), tryModifyTextColor(value, theme));\r\n                    }\r\n                    if (_this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\r\n                        declarations.set(wrapBorderColorVariableName(property), tryModifyBorderColor(value, theme));\r\n                    }\r\n                    _this.subscribeForVarTypeChange(property, _this.onRootVariableDefined);\r\n                }\r\n            });\r\n            var cssLines = [];\r\n            cssLines.push(':root {');\r\n            try {\r\n                for (var declarations_1 = __values(declarations), declarations_1_1 = declarations_1.next(); !declarations_1_1.done; declarations_1_1 = declarations_1.next()) {\r\n                    var _b = __read(declarations_1_1.value, 2), property = _b[0], value = _b[1];\r\n                    cssLines.push(\"    \" + property + \": \" + value + \";\");\r\n                }\r\n            }\r\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\r\n            finally {\r\n                try {\r\n                    if (declarations_1_1 && !declarations_1_1.done && (_a = declarations_1.return)) _a.call(declarations_1);\r\n                }\r\n                finally { if (e_2) throw e_2.error; }\r\n            }\r\n            cssLines.push('}');\r\n            var cssText = cssLines.join('\\n');\r\n            sheet.insertRule(cssText);\r\n        };\r\n        return VariablesStore;\r\n    }());\r\n    var variablesStore = new VariablesStore();\r\n    function getVariableRange(input, searchStart) {\r\n        if (searchStart === void 0) { searchStart = 0; }\r\n        var start = input.indexOf('var(', searchStart);\r\n        if (start >= 0) {\r\n            var range = getParenthesesRange(input, start + 3);\r\n            if (range) {\r\n                return { start: start, end: range.end };\r\n            }\r\n            return null;\r\n        }\r\n    }\r\n    function getVariablesMatches(input) {\r\n        var ranges = [];\r\n        var i = 0;\r\n        var range;\r\n        while ((range = getVariableRange(input, i))) {\r\n            var start = range.start, end = range.end;\r\n            ranges.push({ start: start, end: end, value: input.substring(start, end) });\r\n            i = range.end + 1;\r\n        }\r\n        return ranges;\r\n    }\r\n    function replaceVariablesMatches(input, replacer) {\r\n        var matches = getVariablesMatches(input);\r\n        var matchesCount = matches.length;\r\n        if (matchesCount === 0) {\r\n            return input;\r\n        }\r\n        var inputLength = input.length;\r\n        var replacements = matches.map(function (m) { return replacer(m.value); });\r\n        var parts = [];\r\n        parts.push(input.substring(0, matches[0].start));\r\n        for (var i = 0; i < matchesCount; i++) {\r\n            parts.push(replacements[i]);\r\n            var start = matches[i].end;\r\n            var end = i < matchesCount - 1 ? matches[i + 1].start : inputLength;\r\n            parts.push(input.substring(start, end));\r\n        }\r\n        return parts.join('');\r\n    }\r\n    function getVariableNameAndFallback(match) {\r\n        var commaIndex = match.indexOf(',');\r\n        var name;\r\n        var fallback;\r\n        if (commaIndex >= 0) {\r\n            name = match.substring(4, commaIndex).trim();\r\n            fallback = match.substring(commaIndex + 1, match.length - 1).trim();\r\n        }\r\n        else {\r\n            name = match.substring(4, match.length - 1).trim();\r\n            fallback = '';\r\n        }\r\n        return { name: name, fallback: fallback };\r\n    }\r\n    function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match), name = _a.name, fallback = _a.fallback;\r\n            var newName = nameReplacer(name);\r\n            if (!fallback) {\r\n                return \"var(\" + newName + \")\";\r\n            }\r\n            var newFallback;\r\n            if (isVarDependant(fallback)) {\r\n                newFallback = replaceCSSVariablesNames(fallback, nameReplacer, fallbackReplacer);\r\n            }\r\n            else if (fallbackReplacer) {\r\n                newFallback = fallbackReplacer(fallback);\r\n            }\r\n            else {\r\n                newFallback = fallback;\r\n            }\r\n            return \"var(\" + newName + \", \" + newFallback + \")\";\r\n        };\r\n        return replaceVariablesMatches(value, matchReplacer);\r\n    }\r\n    function iterateVarDependencies(value, iterator) {\r\n        replaceCSSVariablesNames(value, function (varName) {\r\n            iterator(varName);\r\n            return varName;\r\n        });\r\n    }\r\n    function wrapBgColorVariableName(name) {\r\n        return \"--darkreader-bg\" + name;\r\n    }\r\n    function wrapTextColorVariableName(name) {\r\n        return \"--darkreader-text\" + name;\r\n    }\r\n    function wrapBorderColorVariableName(name) {\r\n        return \"--darkreader-border\" + name;\r\n    }\r\n    function wrapBgImgVariableName(name) {\r\n        return \"--darkreader-bgimg\" + name;\r\n    }\r\n    function isVariable(property) {\r\n        return property.startsWith('--');\r\n    }\r\n    function isVarDependant(value) {\r\n        return value.includes('var(');\r\n    }\r\n    function isConstructedColorVar(value) {\r\n        return value.match(/^\\s*(rgb|hsl)a?\\(/);\r\n    }\r\n    var rawValueRegex = /^\\d{1,3}, ?\\d{1,3}, ?\\d{1,3}$/;\r\n    function parseRawValue(color) {\r\n        if (rawValueRegex.test(color)) {\r\n            var splitted = color.split(',');\r\n            var resultInRGB_1 = 'rgb(';\r\n            splitted.forEach(function (number) {\r\n                resultInRGB_1 += number.trim() + \", \";\r\n            });\r\n            resultInRGB_1 = resultInRGB_1.substr(0, resultInRGB_1.length - 2);\r\n            resultInRGB_1 += ')';\r\n            return { isRaw: true, color: resultInRGB_1 };\r\n        }\r\n        return { isRaw: false, color: color };\r\n    }\r\n    function handleRawValue(color, theme, modifyFunction) {\r\n        var _a = parseRawValue(color), isRaw = _a.isRaw, newColor = _a.color;\r\n        var rgb = tryParseColor(newColor);\r\n        if (rgb) {\r\n            var outputColor = modifyFunction(rgb, theme);\r\n            if (isRaw) {\r\n                var outputInRGB = tryParseColor(outputColor);\r\n                return outputInRGB ? outputInRGB.r + \", \" + outputInRGB.g + \", \" + outputInRGB.b : outputColor;\r\n            }\r\n            return outputColor;\r\n        }\r\n        return newColor;\r\n    }\r\n    function tryModifyBgColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyBackgroundColor);\r\n    }\r\n    function tryModifyTextColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyForegroundColor);\r\n    }\r\n    function tryModifyBorderColor(color, theme) {\r\n        return handleRawValue(color, theme, modifyBorderColor);\r\n    }\r\n    function insertVarValues(source, varValues, stack) {\r\n        if (stack === void 0) { stack = new Set(); }\r\n        var containsUnresolvedVar = false;\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match), name = _a.name, fallback = _a.fallback;\r\n            if (stack.has(name)) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            stack.add(name);\r\n            var varValue = varValues.get(name) || fallback;\r\n            var inserted = null;\r\n            if (varValue) {\r\n                if (isVarDependant(varValue)) {\r\n                    inserted = insertVarValues(varValue, varValues, stack);\r\n                }\r\n                else {\r\n                    inserted = varValue;\r\n                }\r\n            }\r\n            if (!inserted) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            return inserted;\r\n        };\r\n        var replaced = replaceVariablesMatches(source, matchReplacer);\r\n        if (containsUnresolvedVar) {\r\n            return null;\r\n        }\r\n        return replaced;\r\n    }\n\n    var overrides = {\r\n        'background-color': {\r\n            customProp: '--darkreader-inline-bgcolor',\r\n            cssProp: 'background-color',\r\n            dataAttr: 'data-darkreader-inline-bgcolor',\r\n        },\r\n        'background-image': {\r\n            customProp: '--darkreader-inline-bgimage',\r\n            cssProp: 'background-image',\r\n            dataAttr: 'data-darkreader-inline-bgimage',\r\n        },\r\n        'border-color': {\r\n            customProp: '--darkreader-inline-border',\r\n            cssProp: 'border-color',\r\n            dataAttr: 'data-darkreader-inline-border',\r\n        },\r\n        'border-bottom-color': {\r\n            customProp: '--darkreader-inline-border-bottom',\r\n            cssProp: 'border-bottom-color',\r\n            dataAttr: 'data-darkreader-inline-border-bottom',\r\n        },\r\n        'border-left-color': {\r\n            customProp: '--darkreader-inline-border-left',\r\n            cssProp: 'border-left-color',\r\n            dataAttr: 'data-darkreader-inline-border-left',\r\n        },\r\n        'border-right-color': {\r\n            customProp: '--darkreader-inline-border-right',\r\n            cssProp: 'border-right-color',\r\n            dataAttr: 'data-darkreader-inline-border-right',\r\n        },\r\n        'border-top-color': {\r\n            customProp: '--darkreader-inline-border-top',\r\n            cssProp: 'border-top-color',\r\n            dataAttr: 'data-darkreader-inline-border-top',\r\n        },\r\n        'box-shadow': {\r\n            customProp: '--darkreader-inline-boxshadow',\r\n            cssProp: 'box-shadow',\r\n            dataAttr: 'data-darkreader-inline-boxshadow',\r\n        },\r\n        'color': {\r\n            customProp: '--darkreader-inline-color',\r\n            cssProp: 'color',\r\n            dataAttr: 'data-darkreader-inline-color',\r\n        },\r\n        'fill': {\r\n            customProp: '--darkreader-inline-fill',\r\n            cssProp: 'fill',\r\n            dataAttr: 'data-darkreader-inline-fill',\r\n        },\r\n        'stroke': {\r\n            customProp: '--darkreader-inline-stroke',\r\n            cssProp: 'stroke',\r\n            dataAttr: 'data-darkreader-inline-stroke',\r\n        },\r\n        'outline-color': {\r\n            customProp: '--darkreader-inline-outline',\r\n            cssProp: 'outline-color',\r\n            dataAttr: 'data-darkreader-inline-outline',\r\n        },\r\n        'stop-color': {\r\n            customProp: '--darkreader-inline-stopcolor',\r\n            cssProp: 'stop-color',\r\n            dataAttr: 'data-darkreader-inline-stopcolor',\r\n        },\r\n    };\r\n    var overridesList = Object.values(overrides);\r\n    var normalizedPropList = {};\r\n    overridesList.forEach(function (_a) {\r\n        var cssProp = _a.cssProp, customProp = _a.customProp;\r\n        return normalizedPropList[customProp] = cssProp;\r\n    });\r\n    var INLINE_STYLE_ATTRS = ['style', 'fill', 'stop-color', 'stroke', 'bgcolor', 'color'];\r\n    var INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(function (attr) { return \"[\" + attr + \"]\"; }).join(', ');\r\n    function getInlineOverrideStyle() {\r\n        return overridesList.map(function (_a) {\r\n            var dataAttr = _a.dataAttr, customProp = _a.customProp, cssProp = _a.cssProp;\r\n            return [\r\n                \"[\" + dataAttr + \"] {\",\r\n                \"  \" + cssProp + \": var(\" + customProp + \") !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }).join('\\n');\r\n    }\r\n    function getInlineStyleElements(root) {\r\n        var results = [];\r\n        if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\r\n            results.push(root);\r\n        }\r\n        if (root instanceof Element || (isShadowDomSupported && root instanceof ShadowRoot) || root instanceof Document) {\r\n            push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        }\r\n        return results;\r\n    }\r\n    var treeObservers = new Map();\r\n    var attrObservers = new Map();\r\n    function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\r\n        deepWatchForInlineStyles(document, elementStyleDidChange, shadowRootDiscovered);\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            deepWatchForInlineStyles(host.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\r\n        });\r\n    }\r\n    function deepWatchForInlineStyles(root, elementStyleDidChange, shadowRootDiscovered) {\r\n        if (treeObservers.has(root)) {\r\n            treeObservers.get(root).disconnect();\r\n            attrObservers.get(root).disconnect();\r\n        }\r\n        var discoveredNodes = new WeakSet();\r\n        function discoverNodes(node) {\r\n            getInlineStyleElements(node).forEach(function (el) {\r\n                if (discoveredNodes.has(el)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(el);\r\n                elementStyleDidChange(el);\r\n            });\r\n            iterateShadowHosts(node, function (n) {\r\n                if (discoveredNodes.has(node)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(node);\r\n                shadowRootDiscovered(n.shadowRoot);\r\n                deepWatchForInlineStyles(n.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\r\n            });\r\n        }\r\n        var treeObserver = createOptimizedTreeObserver(root, {\r\n            onMinorMutations: function (_a) {\r\n                var additions = _a.additions;\r\n                additions.forEach(function (added) { return discoverNodes(added); });\r\n            },\r\n            onHugeMutations: function () {\r\n                discoverNodes(root);\r\n            },\r\n        });\r\n        treeObservers.set(root, treeObserver);\r\n        var attemptCount = 0;\r\n        var start = null;\r\n        var ATTEMPTS_INTERVAL = getDuration({ seconds: 10 });\r\n        var RETRY_TIMEOUT = getDuration({ seconds: 2 });\r\n        var MAX_ATTEMPTS_COUNT = 50;\r\n        var cache = [];\r\n        var timeoutId = null;\r\n        var handleAttributeMutations = throttle(function (mutations) {\r\n            mutations.forEach(function (m) {\r\n                if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\r\n                    elementStyleDidChange(m.target);\r\n                }\r\n            });\r\n        });\r\n        var attrObserver = new MutationObserver(function (mutations) {\r\n            if (timeoutId) {\r\n                cache.push.apply(cache, __spreadArray([], __read(mutations), false));\r\n                return;\r\n            }\r\n            attemptCount++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            }\r\n            else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attemptCount = 0;\r\n                        timeoutId = null;\r\n                        var attributeCache = cache;\r\n                        cache = [];\r\n                        handleAttributeMutations(attributeCache);\r\n                    }, RETRY_TIMEOUT);\r\n                    cache.push.apply(cache, __spreadArray([], __read(mutations), false));\r\n                    return;\r\n                }\r\n                start = now;\r\n                attemptCount = 1;\r\n            }\r\n            handleAttributeMutations(mutations);\r\n        });\r\n        attrObserver.observe(root, {\r\n            attributes: true,\r\n            attributeFilter: INLINE_STYLE_ATTRS.concat(overridesList.map(function (_a) {\r\n                var dataAttr = _a.dataAttr;\r\n                return dataAttr;\r\n            })),\r\n            subtree: true,\r\n        });\r\n        attrObservers.set(root, attrObserver);\r\n    }\r\n    function stopWatchingForInlineStyles() {\r\n        treeObservers.forEach(function (o) { return o.disconnect(); });\r\n        attrObservers.forEach(function (o) { return o.disconnect(); });\r\n        treeObservers.clear();\r\n        attrObservers.clear();\r\n    }\r\n    var inlineStyleCache = new WeakMap();\r\n    var filterProps = ['brightness', 'contrast', 'grayscale', 'sepia', 'mode'];\r\n    function getInlineStyleCacheKey(el, theme) {\r\n        return INLINE_STYLE_ATTRS\r\n            .map(function (attr) { return attr + \"=\\\"\" + el.getAttribute(attr) + \"\\\"\"; })\r\n            .concat(filterProps.map(function (prop) { return prop + \"=\\\"\" + theme[prop] + \"\\\"\"; }))\r\n            .join(' ');\r\n    }\r\n    function shouldIgnoreInlineStyle(element, selectors) {\r\n        for (var i = 0, len = selectors.length; i < len; i++) {\r\n            var ingnoredSelector = selectors[i];\r\n            if (element.matches(ingnoredSelector)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function overrideInlineStyle(element, theme, ignoreInlineSelectors, ignoreImageSelectors) {\r\n        var cacheKey = getInlineStyleCacheKey(element, theme);\r\n        if (cacheKey === inlineStyleCache.get(element)) {\r\n            return;\r\n        }\r\n        var unsetProps = new Set(Object.keys(overrides));\r\n        function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\r\n            var _a = overrides[targetCSSProp], customProp = _a.customProp, dataAttr = _a.dataAttr;\r\n            var mod = getModifiableCSSDeclaration(modifierCSSProp, cssVal, {}, variablesStore, ignoreImageSelectors, null);\r\n            if (!mod) {\r\n                return;\r\n            }\r\n            var value = mod.value;\r\n            if (typeof value === 'function') {\r\n                value = value(theme);\r\n            }\r\n            element.style.setProperty(customProp, value);\r\n            if (!element.hasAttribute(dataAttr)) {\r\n                element.setAttribute(dataAttr, '');\r\n            }\r\n            unsetProps.delete(targetCSSProp);\r\n        }\r\n        if (ignoreInlineSelectors.length > 0) {\r\n            if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\r\n                unsetProps.forEach(function (cssProp) {\r\n                    element.removeAttribute(overrides[cssProp].dataAttr);\r\n                });\r\n                return;\r\n            }\r\n        }\r\n        if (element.hasAttribute('bgcolor')) {\r\n            var value = element.getAttribute('bgcolor');\r\n            if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\r\n                value = \"#\" + value;\r\n            }\r\n            setCustomProp('background-color', 'background-color', value);\r\n        }\r\n        if (element.hasAttribute('color') && element.rel !== 'mask-icon') {\r\n            var value = element.getAttribute('color');\r\n            if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\r\n                value = \"#\" + value;\r\n            }\r\n            setCustomProp('color', 'color', value);\r\n        }\r\n        if (element instanceof SVGElement) {\r\n            if (element.hasAttribute('fill')) {\r\n                var SMALL_SVG_LIMIT_1 = 32;\r\n                var value_1 = element.getAttribute('fill');\r\n                if (value_1 !== 'none') {\r\n                    if (!(element instanceof SVGTextElement)) {\r\n                        var handleSVGElement = function () {\r\n                            var _a = element.getBoundingClientRect(), width = _a.width, height = _a.height;\r\n                            var isBg = (width > SMALL_SVG_LIMIT_1 || height > SMALL_SVG_LIMIT_1);\r\n                            setCustomProp('fill', isBg ? 'background-color' : 'color', value_1);\r\n                        };\r\n                        if (isReadyStateComplete()) {\r\n                            handleSVGElement();\r\n                        }\r\n                        else {\r\n                            addReadyStateCompleteListener(handleSVGElement);\r\n                        }\r\n                    }\r\n                    else {\r\n                        setCustomProp('fill', 'color', value_1);\r\n                    }\r\n                }\r\n            }\r\n            if (element.hasAttribute('stop-color')) {\r\n                setCustomProp('stop-color', 'background-color', element.getAttribute('stop-color'));\r\n            }\r\n        }\r\n        if (element.hasAttribute('stroke')) {\r\n            var value = element.getAttribute('stroke');\r\n            setCustomProp('stroke', element instanceof SVGLineElement || element instanceof SVGTextElement ? 'border-color' : 'color', value);\r\n        }\r\n        element.style && iterateCSSDeclarations(element.style, function (property, value) {\r\n            if (property === 'background-image' && value.includes('url')) {\r\n                return;\r\n            }\r\n            if (overrides.hasOwnProperty(property)) {\r\n                setCustomProp(property, property, value);\r\n            }\r\n            else {\r\n                var overridenProp = normalizedPropList[property];\r\n                if (overridenProp &&\r\n                    (!element.style.getPropertyValue(overridenProp) && !element.hasAttribute(overridenProp))) {\r\n                    if (overridenProp === 'background-color' && element.hasAttribute('bgcolor')) {\r\n                        return;\r\n                    }\r\n                    element.style.setProperty(property, '');\r\n                }\r\n            }\r\n        });\r\n        if (element.style && element instanceof SVGTextElement && element.style.fill) {\r\n            setCustomProp('fill', 'color', element.style.getPropertyValue('fill'));\r\n        }\r\n        forEach(unsetProps, function (cssProp) {\r\n            element.removeAttribute(overrides[cssProp].dataAttr);\r\n        });\r\n        inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\r\n    }\n\n    var metaThemeColorName = 'theme-color';\r\n    var metaThemeColorSelector = \"meta[name=\\\"\" + metaThemeColorName + \"\\\"]\";\r\n    var srcMetaThemeColor = null;\r\n    var observer = null;\r\n    function changeMetaThemeColor(meta, theme) {\r\n        srcMetaThemeColor = srcMetaThemeColor || meta.content;\r\n        try {\r\n            var color = parse(srcMetaThemeColor);\r\n            meta.content = modifyBackgroundColor(color, theme);\r\n        }\r\n        catch (err) {\r\n            logWarn(err);\r\n        }\r\n    }\r\n    function changeMetaThemeColorWhenAvailable(theme) {\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta) {\r\n            changeMetaThemeColor(meta, theme);\r\n        }\r\n        else {\r\n            if (observer) {\r\n                observer.disconnect();\r\n            }\r\n            observer = new MutationObserver(function (mutations) {\r\n                loop: for (var i = 0; i < mutations.length; i++) {\r\n                    var addedNodes = mutations[i].addedNodes;\r\n                    for (var j = 0; j < addedNodes.length; j++) {\r\n                        var node = addedNodes[j];\r\n                        if (node instanceof HTMLMetaElement && node.name === metaThemeColorName) {\r\n                            observer.disconnect();\r\n                            observer = null;\r\n                            changeMetaThemeColor(node, theme);\r\n                            break loop;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            observer.observe(document.head, { childList: true });\r\n        }\r\n    }\r\n    function restoreMetaThemeColor() {\r\n        if (observer) {\r\n            observer.disconnect();\r\n            observer = null;\r\n        }\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta && srcMetaThemeColor) {\r\n            meta.content = srcMetaThemeColor;\r\n        }\r\n    }\n\n    var themeCacheKeys = [\r\n        'mode',\r\n        'brightness',\r\n        'contrast',\r\n        'grayscale',\r\n        'sepia',\r\n        'darkSchemeBackgroundColor',\r\n        'darkSchemeTextColor',\r\n        'lightSchemeBackgroundColor',\r\n        'lightSchemeTextColor',\r\n    ];\r\n    function getThemeKey(theme) {\r\n        return themeCacheKeys.map(function (p) { return p + \":\" + theme[p]; }).join(';');\r\n    }\r\n    var asyncQueue = createAsyncTasksQueue();\r\n    function createStyleSheetModifier() {\r\n        var renderId = 0;\r\n        var rulesTextCache = new Set();\r\n        var rulesModCache = new Map();\r\n        var varTypeChangeCleaners = new Set();\r\n        var prevFilterKey = null;\r\n        var hasNonLoadedLink = false;\r\n        var wasRebuilt = false;\r\n        function shouldRebuildStyle() {\r\n            return hasNonLoadedLink && !wasRebuilt;\r\n        }\r\n        function modifySheet(options) {\r\n            var rules = options.sourceCSSRules;\r\n            var theme = options.theme, ignoreImageAnalysis = options.ignoreImageAnalysis, force = options.force, prepareSheet = options.prepareSheet, isAsyncCancelled = options.isAsyncCancelled;\r\n            var rulesChanged = (rulesModCache.size === 0);\r\n            var notFoundCacheKeys = new Set(rulesModCache.keys());\r\n            var themeKey = getThemeKey(theme);\r\n            var themeChanged = (themeKey !== prevFilterKey);\r\n            if (hasNonLoadedLink) {\r\n                wasRebuilt = true;\r\n            }\r\n            var modRules = [];\r\n            iterateCSSRules(rules, function (rule) {\r\n                var cssText = rule.cssText;\r\n                var textDiffersFromPrev = false;\r\n                notFoundCacheKeys.delete(cssText);\r\n                if (rule.parentRule instanceof CSSMediaRule) {\r\n                    cssText += \";\" + rule.parentRule.media.mediaText;\r\n                }\r\n                if (!rulesTextCache.has(cssText)) {\r\n                    rulesTextCache.add(cssText);\r\n                    textDiffersFromPrev = true;\r\n                }\r\n                if (textDiffersFromPrev) {\r\n                    rulesChanged = true;\r\n                }\r\n                else {\r\n                    modRules.push(rulesModCache.get(cssText));\r\n                    return;\r\n                }\r\n                var modDecs = [];\r\n                rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\r\n                    var mod = getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageAnalysis, isAsyncCancelled);\r\n                    if (mod) {\r\n                        modDecs.push(mod);\r\n                    }\r\n                });\r\n                var modRule = null;\r\n                if (modDecs.length > 0) {\r\n                    var parentRule = rule.parentRule;\r\n                    modRule = { selector: rule.selectorText, declarations: modDecs, parentRule: parentRule };\r\n                    modRules.push(modRule);\r\n                }\r\n                rulesModCache.set(cssText, modRule);\r\n            }, function () {\r\n                hasNonLoadedLink = true;\r\n            });\r\n            notFoundCacheKeys.forEach(function (key) {\r\n                rulesTextCache.delete(key);\r\n                rulesModCache.delete(key);\r\n            });\r\n            prevFilterKey = themeKey;\r\n            if (!force && !rulesChanged && !themeChanged) {\r\n                return;\r\n            }\r\n            renderId++;\r\n            function setRule(target, index, rule) {\r\n                var selector = rule.selector, declarations = rule.declarations;\r\n                var getDeclarationText = function (dec) {\r\n                    var property = dec.property, value = dec.value, important = dec.important, sourceValue = dec.sourceValue;\r\n                    return property + \": \" + (value == null ? sourceValue : value) + (important ? ' !important' : '') + \";\";\r\n                };\r\n                var cssRulesText = '';\r\n                declarations.forEach(function (declarations) {\r\n                    cssRulesText += getDeclarationText(declarations) + \" \";\r\n                });\r\n                var ruleText = selector + \" { \" + cssRulesText + \" }\";\r\n                target.insertRule(ruleText, index);\r\n            }\r\n            var asyncDeclarations = new Map();\r\n            var varDeclarations = new Map();\r\n            var asyncDeclarationCounter = 0;\r\n            var varDeclarationCounter = 0;\r\n            var rootReadyGroup = { rule: null, rules: [], isGroup: true };\r\n            var groupRefs = new WeakMap();\r\n            function getGroup(rule) {\r\n                if (rule == null) {\r\n                    return rootReadyGroup;\r\n                }\r\n                if (groupRefs.has(rule)) {\r\n                    return groupRefs.get(rule);\r\n                }\r\n                var group = { rule: rule, rules: [], isGroup: true };\r\n                groupRefs.set(rule, group);\r\n                var parentGroup = getGroup(rule.parentRule);\r\n                parentGroup.rules.push(group);\r\n                return group;\r\n            }\r\n            varTypeChangeCleaners.forEach(function (clear) { return clear(); });\r\n            varTypeChangeCleaners.clear();\r\n            modRules.filter(function (r) { return r; }).forEach(function (_a) {\r\n                var selector = _a.selector, declarations = _a.declarations, parentRule = _a.parentRule;\r\n                var group = getGroup(parentRule);\r\n                var readyStyleRule = { selector: selector, declarations: [], isGroup: false };\r\n                var readyDeclarations = readyStyleRule.declarations;\r\n                group.rules.push(readyStyleRule);\r\n                function handleAsyncDeclaration(property, modified, important, sourceValue) {\r\n                    var asyncKey = ++asyncDeclarationCounter;\r\n                    var asyncDeclaration = { property: property, value: null, important: important, asyncKey: asyncKey, sourceValue: sourceValue };\r\n                    readyDeclarations.push(asyncDeclaration);\r\n                    var currentRenderId = renderId;\r\n                    modified.then(function (asyncValue) {\r\n                        if (!asyncValue || isAsyncCancelled() || currentRenderId !== renderId) {\r\n                            return;\r\n                        }\r\n                        asyncDeclaration.value = asyncValue;\r\n                        asyncQueue.add(function () {\r\n                            if (isAsyncCancelled() || currentRenderId !== renderId) {\r\n                                return;\r\n                            }\r\n                            rebuildAsyncRule(asyncKey);\r\n                        });\r\n                    });\r\n                }\r\n                function handleVarDeclarations(property, modified, important, sourceValue) {\r\n                    var _a = modified, varDecs = _a.declarations, onTypeChange = _a.onTypeChange;\r\n                    var varKey = ++varDeclarationCounter;\r\n                    var currentRenderId = renderId;\r\n                    var initialIndex = readyDeclarations.length;\r\n                    var oldDecs = [];\r\n                    if (varDecs.length === 0) {\r\n                        var tempDec = { property: property, value: sourceValue, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                        readyDeclarations.push(tempDec);\r\n                        oldDecs = [tempDec];\r\n                    }\r\n                    varDecs.forEach(function (mod) {\r\n                        if (mod.value instanceof Promise) {\r\n                            handleAsyncDeclaration(mod.property, mod.value, important, sourceValue);\r\n                        }\r\n                        else {\r\n                            var readyDec = { property: mod.property, value: mod.value, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                            readyDeclarations.push(readyDec);\r\n                            oldDecs.push(readyDec);\r\n                        }\r\n                    });\r\n                    onTypeChange.addListener(function (newDecs) {\r\n                        if (isAsyncCancelled() || currentRenderId !== renderId) {\r\n                            return;\r\n                        }\r\n                        var readyVarDecs = newDecs.map(function (mod) {\r\n                            return { property: mod.property, value: mod.value, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                        });\r\n                        var index = readyDeclarations.indexOf(oldDecs[0], initialIndex);\r\n                        readyDeclarations.splice.apply(readyDeclarations, __spreadArray([index, oldDecs.length], __read(readyVarDecs), false));\r\n                        oldDecs = readyVarDecs;\r\n                        rebuildVarRule(varKey);\r\n                    });\r\n                    varTypeChangeCleaners.add(function () { return onTypeChange.removeListeners(); });\r\n                }\r\n                declarations.forEach(function (_a) {\r\n                    var property = _a.property, value = _a.value, important = _a.important, sourceValue = _a.sourceValue;\r\n                    if (typeof value === 'function') {\r\n                        var modified = value(theme);\r\n                        if (modified instanceof Promise) {\r\n                            handleAsyncDeclaration(property, modified, important, sourceValue);\r\n                        }\r\n                        else if (property.startsWith('--')) {\r\n                            handleVarDeclarations(property, modified, important, sourceValue);\r\n                        }\r\n                        else {\r\n                            readyDeclarations.push({ property: property, value: modified, important: important, sourceValue: sourceValue });\r\n                        }\r\n                    }\r\n                    else {\r\n                        readyDeclarations.push({ property: property, value: value, important: important, sourceValue: sourceValue });\r\n                    }\r\n                });\r\n            });\r\n            var sheet = prepareSheet();\r\n            function buildStyleSheet() {\r\n                function createTarget(group, parent) {\r\n                    var rule = group.rule;\r\n                    if (rule instanceof CSSMediaRule) {\r\n                        var media = rule.media;\r\n                        var index = parent.cssRules.length;\r\n                        parent.insertRule(\"@media \" + media.mediaText + \" {}\", index);\r\n                        return parent.cssRules[index];\r\n                    }\r\n                    return parent;\r\n                }\r\n                function iterateReadyRules(group, target, styleIterator) {\r\n                    group.rules.forEach(function (r) {\r\n                        if (r.isGroup) {\r\n                            var t = createTarget(r, target);\r\n                            iterateReadyRules(r, t, styleIterator);\r\n                        }\r\n                        else {\r\n                            styleIterator(r, target);\r\n                        }\r\n                    });\r\n                }\r\n                iterateReadyRules(rootReadyGroup, sheet, function (rule, target) {\r\n                    var index = target.cssRules.length;\r\n                    rule.declarations.forEach(function (_a) {\r\n                        var asyncKey = _a.asyncKey, varKey = _a.varKey;\r\n                        if (asyncKey != null) {\r\n                            asyncDeclarations.set(asyncKey, { rule: rule, target: target, index: index });\r\n                        }\r\n                        if (varKey != null) {\r\n                            varDeclarations.set(varKey, { rule: rule, target: target, index: index });\r\n                        }\r\n                    });\r\n                    setRule(target, index, rule);\r\n                });\r\n            }\r\n            function rebuildAsyncRule(key) {\r\n                var _a = asyncDeclarations.get(key), rule = _a.rule, target = _a.target, index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n                asyncDeclarations.delete(key);\r\n            }\r\n            function rebuildVarRule(key) {\r\n                var _a = varDeclarations.get(key), rule = _a.rule, target = _a.target, index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n            }\r\n            buildStyleSheet();\r\n        }\r\n        return { modifySheet: modifySheet, shouldRebuildStyle: shouldRebuildStyle };\r\n    }\n\n    var STYLE_SELECTOR = 'style, link[rel*=\"stylesheet\" i]:not([disabled])';\r\n    function shouldManageStyle(element) {\r\n        return ((element instanceof HTMLStyleElement ||\r\n            element instanceof SVGStyleElement ||\r\n            (element instanceof HTMLLinkElement &&\r\n                element.rel &&\r\n                element.rel.toLowerCase().includes('stylesheet') &&\r\n                !element.disabled &&\r\n                (isFirefox ? !element.href.startsWith('moz-extension://') : true))) &&\r\n            !element.classList.contains('darkreader') &&\r\n            element.media.toLowerCase() !== 'print' &&\r\n            !element.classList.contains('stylus'));\r\n    }\r\n    function getManageableStyles(node, results, deep) {\r\n        if (results === void 0) { results = []; }\r\n        if (deep === void 0) { deep = true; }\r\n        if (shouldManageStyle(node)) {\r\n            results.push(node);\r\n        }\r\n        else if (node instanceof Element || (isShadowDomSupported && node instanceof ShadowRoot) || node === document) {\r\n            forEach(node.querySelectorAll(STYLE_SELECTOR), function (style) { return getManageableStyles(style, results, false); });\r\n            if (deep) {\r\n                iterateShadowHosts(node, function (host) { return getManageableStyles(host.shadowRoot, results, false); });\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    var syncStyleSet = new WeakSet();\r\n    var corsStyleSet = new WeakSet();\r\n    var canOptimizeUsingProxy$1 = false;\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\r\n            canOptimizeUsingProxy$1 = true;\r\n        });\r\n    }\r\n    var loadingLinkCounter = 0;\r\n    var rejectorsForLoadingLinks = new Map();\r\n    function cleanLoadingLinks() {\r\n        rejectorsForLoadingLinks.clear();\r\n    }\r\n    function manageStyle(element, _a) {\r\n        var update = _a.update, loadingStart = _a.loadingStart, loadingEnd = _a.loadingEnd;\r\n        var prevStyles = [];\r\n        var next = element;\r\n        while ((next = next.nextElementSibling) && next.matches('.darkreader')) {\r\n            prevStyles.push(next);\r\n        }\r\n        var corsCopy = prevStyles.find(function (el) { return el.matches('.darkreader--cors') && !corsStyleSet.has(el); }) || null;\r\n        var syncStyle = prevStyles.find(function (el) { return el.matches('.darkreader--sync') && !syncStyleSet.has(el); }) || null;\r\n        var corsCopyPositionWatcher = null;\r\n        var syncStylePositionWatcher = null;\r\n        var cancelAsyncOperations = false;\r\n        var isOverrideEmpty = true;\r\n        var sheetModifier = createStyleSheetModifier();\r\n        var observer = new MutationObserver(function () {\r\n            update();\r\n        });\r\n        var observerOptions = { attributes: true, childList: true, subtree: true, characterData: true };\r\n        function containsCSSImport() {\r\n            return element instanceof HTMLStyleElement && element.textContent.trim().match(cssImportRegex);\r\n        }\r\n        function hasImports(cssRules, checkCrossOrigin) {\r\n            var result = false;\r\n            if (cssRules) {\r\n                var rule = void 0;\r\n                cssRulesLoop: for (var i = 0, len = cssRules.length; i < len; i++) {\r\n                    rule = cssRules[i];\r\n                    if (rule.href) {\r\n                        if (checkCrossOrigin) {\r\n                            if (rule.href.startsWith('http') && !rule.href.startsWith(location.origin)) {\r\n                                result = true;\r\n                                break cssRulesLoop;\r\n                            }\r\n                        }\r\n                        else {\r\n                            result = true;\r\n                            break cssRulesLoop;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        function getRulesSync() {\r\n            if (corsCopy) {\r\n                logInfo('[getRulesSync] Using cors-copy.');\r\n                return corsCopy.sheet.cssRules;\r\n            }\r\n            if (containsCSSImport()) {\r\n                logInfo('[getRulesSync] CSSImport detected.');\r\n                return null;\r\n            }\r\n            var cssRules = safeGetSheetRules();\r\n            if (element instanceof HTMLLinkElement && !isRelativeHrefOnAbsolutePath(element.href) && hasImports(cssRules, false)) {\r\n                logInfo('[getRulesSync] CSSImportRule detected on non-local href.');\r\n                return null;\r\n            }\r\n            if (hasImports(cssRules, true)) {\r\n                logInfo('[getRulesSync] Cross-Origin CSSImportRule detected.');\r\n                return null;\r\n            }\r\n            logInfo('[getRulesSync] Using cssRules.');\r\n            !cssRules && logWarn('[getRulesSync] cssRules is null, trying again.');\r\n            return cssRules;\r\n        }\r\n        function insertStyle() {\r\n            if (corsCopy) {\r\n                if (element.nextSibling !== corsCopy) {\r\n                    element.parentNode.insertBefore(corsCopy, element.nextSibling);\r\n                }\r\n                if (corsCopy.nextSibling !== syncStyle) {\r\n                    element.parentNode.insertBefore(syncStyle, corsCopy.nextSibling);\r\n                }\r\n            }\r\n            else if (element.nextSibling !== syncStyle) {\r\n                element.parentNode.insertBefore(syncStyle, element.nextSibling);\r\n            }\r\n        }\r\n        function createSyncStyle() {\r\n            syncStyle = element instanceof SVGStyleElement ? document.createElementNS('http://www.w3.org/2000/svg', 'style') : document.createElement('style');\r\n            syncStyle.classList.add('darkreader');\r\n            syncStyle.classList.add('darkreader--sync');\r\n            syncStyle.media = 'screen';\r\n            if (!isChromium && element.title) {\r\n                syncStyle.title = element.title;\r\n            }\r\n            syncStyleSet.add(syncStyle);\r\n        }\r\n        var isLoadingRules = false;\r\n        var wasLoadingError = false;\r\n        var loadingLinkId = ++loadingLinkCounter;\r\n        function getRulesAsync() {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var cssText, cssBasePath, _a, cssRules, accessError, err_1, fullCSSText, err_2;\r\n                var _b;\r\n                return __generator(this, function (_c) {\r\n                    switch (_c.label) {\r\n                        case 0:\r\n                            if (!(element instanceof HTMLLinkElement)) return [3, 7];\r\n                            _a = __read(getRulesOrError(), 2), cssRules = _a[0], accessError = _a[1];\r\n                            if (accessError) {\r\n                                logWarn(accessError);\r\n                            }\r\n                            if (!((!cssRules && !accessError && !isSafari) || (isSafari && !element.sheet) || isStillLoadingError(accessError))) return [3, 5];\r\n                            _c.label = 1;\r\n                        case 1:\r\n                            _c.trys.push([1, 3, , 4]);\r\n                            logInfo(\"Linkelement \" + loadingLinkId + \" is not loaded yet and thus will be await for\", element);\r\n                            return [4, linkLoading(element, loadingLinkId)];\r\n                        case 2:\r\n                            _c.sent();\r\n                            return [3, 4];\r\n                        case 3:\r\n                            err_1 = _c.sent();\r\n                            logWarn(err_1);\r\n                            wasLoadingError = true;\r\n                            return [3, 4];\r\n                        case 4:\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            _b = __read(getRulesOrError(), 2), cssRules = _b[0], accessError = _b[1];\r\n                            if (accessError) {\r\n                                logWarn(accessError);\r\n                            }\r\n                            _c.label = 5;\r\n                        case 5:\r\n                            if (cssRules) {\r\n                                if (!hasImports(cssRules, false)) {\r\n                                    return [2, cssRules];\r\n                                }\r\n                            }\r\n                            return [4, loadText(element.href)];\r\n                        case 6:\r\n                            cssText = _c.sent();\r\n                            cssBasePath = getCSSBaseBath(element.href);\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            return [3, 8];\r\n                        case 7:\r\n                            if (containsCSSImport()) {\r\n                                cssText = element.textContent.trim();\r\n                                cssBasePath = getCSSBaseBath(location.href);\r\n                            }\r\n                            else {\r\n                                return [2, null];\r\n                            }\r\n                            _c.label = 8;\r\n                        case 8:\r\n                            if (!cssText) return [3, 13];\r\n                            _c.label = 9;\r\n                        case 9:\r\n                            _c.trys.push([9, 11, , 12]);\r\n                            return [4, replaceCSSImports(cssText, cssBasePath)];\r\n                        case 10:\r\n                            fullCSSText = _c.sent();\r\n                            corsCopy = createCORSCopy(element, fullCSSText);\r\n                            return [3, 12];\r\n                        case 11:\r\n                            err_2 = _c.sent();\r\n                            logWarn(err_2);\r\n                            return [3, 12];\r\n                        case 12:\r\n                            if (corsCopy) {\r\n                                corsCopyPositionWatcher = watchForNodePosition(corsCopy, 'prev-sibling');\r\n                                return [2, corsCopy.sheet.cssRules];\r\n                            }\r\n                            _c.label = 13;\r\n                        case 13: return [2, null];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function details(options) {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                if (options.secondRound) {\r\n                    logWarn('Detected dead-lock at details(), returning early to prevent it.');\r\n                    return null;\r\n                }\r\n                if (isLoadingRules || wasLoadingError) {\r\n                    return null;\r\n                }\r\n                isLoadingRules = true;\r\n                loadingStart();\r\n                getRulesAsync()\r\n                    .then(function (results) {\r\n                    isLoadingRules = false;\r\n                    loadingEnd();\r\n                    if (results) {\r\n                        update();\r\n                    }\r\n                })\r\n                    .catch(function (err) {\r\n                    logWarn(err);\r\n                    isLoadingRules = false;\r\n                    loadingEnd();\r\n                });\r\n                return null;\r\n            }\r\n            return { rules: rules };\r\n        }\r\n        var forceRenderStyle = false;\r\n        function render(theme, ignoreImageAnalysis) {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                return;\r\n            }\r\n            cancelAsyncOperations = false;\r\n            function removeCSSRulesFromSheet(sheet) {\r\n                try {\r\n                    if (sheet.replaceSync) {\r\n                        sheet.replaceSync('');\r\n                        return;\r\n                    }\r\n                }\r\n                catch (err) {\r\n                    logWarn('Could not use fastpath for removing rules from stylesheet', err);\r\n                }\r\n                for (var i = sheet.cssRules.length - 1; i >= 0; i--) {\r\n                    sheet.deleteRule(i);\r\n                }\r\n            }\r\n            function prepareOverridesSheet() {\r\n                if (!syncStyle) {\r\n                    createSyncStyle();\r\n                }\r\n                syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n                insertStyle();\r\n                if (syncStyle.sheet == null) {\r\n                    syncStyle.textContent = '';\r\n                }\r\n                var sheet = syncStyle.sheet;\r\n                removeCSSRulesFromSheet(sheet);\r\n                if (syncStylePositionWatcher) {\r\n                    syncStylePositionWatcher.run();\r\n                }\r\n                else {\r\n                    syncStylePositionWatcher = watchForNodePosition(syncStyle, 'prev-sibling', function () {\r\n                        forceRenderStyle = true;\r\n                        buildOverrides();\r\n                    });\r\n                }\r\n                return syncStyle.sheet;\r\n            }\r\n            function buildOverrides() {\r\n                var force = forceRenderStyle;\r\n                forceRenderStyle = false;\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: force,\r\n                    isAsyncCancelled: function () { return cancelAsyncOperations; },\r\n                });\r\n                isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\r\n                if (sheetModifier.shouldRebuildStyle()) {\r\n                    addReadyStateCompleteListener(function () { return update(); });\r\n                }\r\n            }\r\n            buildOverrides();\r\n        }\r\n        function getRulesOrError() {\r\n            try {\r\n                if (element.sheet == null) {\r\n                    return [null, null];\r\n                }\r\n                return [element.sheet.cssRules, null];\r\n            }\r\n            catch (err) {\r\n                return [null, err];\r\n            }\r\n        }\r\n        function isStillLoadingError(error) {\r\n            return error && error.message && error.message.includes('loading');\r\n        }\r\n        function safeGetSheetRules() {\r\n            var _a = __read(getRulesOrError(), 2), cssRules = _a[0], err = _a[1];\r\n            if (err) {\r\n                logWarn(err);\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        function watchForSheetChanges() {\r\n            watchForSheetChangesUsingProxy();\r\n            if (!isThunderbird && !(canOptimizeUsingProxy$1 && element.sheet)) {\r\n                watchForSheetChangesUsingRAF();\r\n            }\r\n        }\r\n        var rulesChangeKey = null;\r\n        var rulesCheckFrameId = null;\r\n        function getRulesChangeKey() {\r\n            var rules = safeGetSheetRules();\r\n            return rules ? rules.length : null;\r\n        }\r\n        function didRulesKeyChange() {\r\n            return getRulesChangeKey() !== rulesChangeKey;\r\n        }\r\n        function watchForSheetChangesUsingRAF() {\r\n            rulesChangeKey = getRulesChangeKey();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            var checkForUpdate = function () {\r\n                if (didRulesKeyChange()) {\r\n                    rulesChangeKey = getRulesChangeKey();\r\n                    update();\r\n                }\r\n                if (canOptimizeUsingProxy$1 && element.sheet) {\r\n                    stopWatchingForSheetChangesUsingRAF();\r\n                    return;\r\n                }\r\n                rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\r\n            };\r\n            checkForUpdate();\r\n        }\r\n        function stopWatchingForSheetChangesUsingRAF() {\r\n            cancelAnimationFrame(rulesCheckFrameId);\r\n        }\r\n        var areSheetChangesPending = false;\r\n        function onSheetChange() {\r\n            canOptimizeUsingProxy$1 = true;\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            if (areSheetChangesPending) {\r\n                return;\r\n            }\r\n            function handleSheetChanges() {\r\n                areSheetChangesPending = false;\r\n                if (cancelAsyncOperations) {\r\n                    return;\r\n                }\r\n                update();\r\n            }\r\n            areSheetChangesPending = true;\r\n            if (typeof queueMicrotask === 'function') {\r\n                queueMicrotask(handleSheetChanges);\r\n            }\r\n            else {\r\n                requestAnimationFrame(handleSheetChanges);\r\n            }\r\n        }\r\n        function watchForSheetChangesUsingProxy() {\r\n            element.addEventListener('__darkreader__updateSheet', onSheetChange);\r\n        }\r\n        function stopWatchingForSheetChangesUsingProxy() {\r\n            element.removeEventListener('__darkreader__updateSheet', onSheetChange);\r\n        }\r\n        function stopWatchingForSheetChanges() {\r\n            stopWatchingForSheetChangesUsingProxy();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n        }\r\n        function pause() {\r\n            observer.disconnect();\r\n            cancelAsyncOperations = true;\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n            stopWatchingForSheetChanges();\r\n        }\r\n        function destroy() {\r\n            pause();\r\n            removeNode(corsCopy);\r\n            removeNode(syncStyle);\r\n            loadingEnd();\r\n            if (rejectorsForLoadingLinks.has(loadingLinkId)) {\r\n                var reject = rejectorsForLoadingLinks.get(loadingLinkId);\r\n                rejectorsForLoadingLinks.delete(loadingLinkId);\r\n                reject && reject();\r\n            }\r\n        }\r\n        function watch() {\r\n            observer.observe(element, observerOptions);\r\n            if (element instanceof HTMLStyleElement) {\r\n                watchForSheetChanges();\r\n            }\r\n        }\r\n        var maxMoveCount = 10;\r\n        var moveCount = 0;\r\n        function restore() {\r\n            if (!syncStyle) {\r\n                return;\r\n            }\r\n            moveCount++;\r\n            if (moveCount > maxMoveCount) {\r\n                logWarn('Style sheet was moved multiple times', element);\r\n                return;\r\n            }\r\n            logWarn('Restore style', syncStyle, element);\r\n            insertStyle();\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.skip();\r\n            if (!isOverrideEmpty) {\r\n                forceRenderStyle = true;\r\n                update();\r\n            }\r\n        }\r\n        return {\r\n            details: details,\r\n            render: render,\r\n            pause: pause,\r\n            destroy: destroy,\r\n            watch: watch,\r\n            restore: restore,\r\n        };\r\n    }\r\n    function linkLoading(link, loadingId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var cleanUp = function () {\r\n                            link.removeEventListener('load', onLoad);\r\n                            link.removeEventListener('error', onError);\r\n                            rejectorsForLoadingLinks.delete(loadingId);\r\n                        };\r\n                        var onLoad = function () {\r\n                            cleanUp();\r\n                            logInfo(\"Linkelement \" + loadingId + \" has been loaded\");\r\n                            resolve();\r\n                        };\r\n                        var onError = function () {\r\n                            cleanUp();\r\n                            reject(\"Linkelement \" + loadingId + \" couldn't be loaded. \" + link.href);\r\n                        };\r\n                        rejectorsForLoadingLinks.set(loadingId, function () {\r\n                            cleanUp();\r\n                            reject();\r\n                        });\r\n                        link.addEventListener('load', onLoad);\r\n                        link.addEventListener('error', onError);\r\n                        if (!link.href) {\r\n                            onError();\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    function getCSSImportURL(importDeclaration) {\r\n        return getCSSURLValue(importDeclaration\r\n            .substring(7)\r\n            .trim()\r\n            .replace(/;$/, '')\r\n            .replace(/screen$/, ''));\r\n    }\r\n    function loadText(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!url.startsWith('data:')) return [3, 3];\r\n                        return [4, fetch(url)];\r\n                    case 1: return [4, (_a.sent()).text()];\r\n                    case 2: return [2, _a.sent()];\r\n                    case 3: return [4, bgFetch({ url: url, responseType: 'text', mimeType: 'text/css', origin: window.location.origin })];\r\n                    case 4: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function replaceCSSImports(cssText, basePath, cache) {\r\n        if (cache === void 0) { cache = new Map(); }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var importMatches, importMatches_1, importMatches_1_1, match, importURL, absoluteURL, importedCSS, err_3, e_1_1;\r\n            var e_1, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        cssText = removeCSSComments(cssText);\r\n                        cssText = replaceCSSFontFace(cssText);\r\n                        cssText = replaceCSSRelativeURLsWithAbsolute(cssText, basePath);\r\n                        importMatches = getMatches(cssImportRegex, cssText);\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 10, 11, 12]);\r\n                        importMatches_1 = __values(importMatches), importMatches_1_1 = importMatches_1.next();\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!!importMatches_1_1.done) return [3, 9];\r\n                        match = importMatches_1_1.value;\r\n                        importURL = getCSSImportURL(match);\r\n                        absoluteURL = getAbsoluteURL(basePath, importURL);\r\n                        importedCSS = void 0;\r\n                        if (!cache.has(absoluteURL)) return [3, 3];\r\n                        importedCSS = cache.get(absoluteURL);\r\n                        return [3, 7];\r\n                    case 3:\r\n                        _b.trys.push([3, 6, , 7]);\r\n                        return [4, loadText(absoluteURL)];\r\n                    case 4:\r\n                        importedCSS = _b.sent();\r\n                        cache.set(absoluteURL, importedCSS);\r\n                        return [4, replaceCSSImports(importedCSS, getCSSBaseBath(absoluteURL), cache)];\r\n                    case 5:\r\n                        importedCSS = _b.sent();\r\n                        return [3, 7];\r\n                    case 6:\r\n                        err_3 = _b.sent();\r\n                        logWarn(err_3);\r\n                        importedCSS = '';\r\n                        return [3, 7];\r\n                    case 7:\r\n                        cssText = cssText.split(match).join(importedCSS);\r\n                        _b.label = 8;\r\n                    case 8:\r\n                        importMatches_1_1 = importMatches_1.next();\r\n                        return [3, 2];\r\n                    case 9: return [3, 12];\r\n                    case 10:\r\n                        e_1_1 = _b.sent();\r\n                        e_1 = { error: e_1_1 };\r\n                        return [3, 12];\r\n                    case 11:\r\n                        try {\r\n                            if (importMatches_1_1 && !importMatches_1_1.done && (_a = importMatches_1.return)) _a.call(importMatches_1);\r\n                        }\r\n                        finally { if (e_1) throw e_1.error; }\r\n                        return [7];\r\n                    case 12:\r\n                        cssText = cssText.trim();\r\n                        return [2, cssText];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function createCORSCopy(srcElement, cssText) {\r\n        if (!cssText) {\r\n            return null;\r\n        }\r\n        var cors = document.createElement('style');\r\n        cors.classList.add('darkreader');\r\n        cors.classList.add('darkreader--cors');\r\n        cors.media = 'screen';\r\n        cors.textContent = cssText;\r\n        srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\r\n        cors.sheet.disabled = true;\r\n        corsStyleSet.add(cors);\r\n        return cors;\r\n    }\n\n    var observers = [];\r\n    var observedRoots;\r\n    var undefinedGroups = new Map();\r\n    var elementsDefinitionCallback;\r\n    function collectUndefinedElements(root) {\r\n        if (!isDefinedSelectorSupported) {\r\n            return;\r\n        }\r\n        forEach(root.querySelectorAll(':not(:defined)'), function (el) {\r\n            var tag = el.tagName.toLowerCase();\r\n            if (!tag.includes('-')) {\r\n                var extendedTag = el.getAttribute('is');\r\n                if (extendedTag) {\r\n                    tag = extendedTag;\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n            }\r\n            if (!undefinedGroups.has(tag)) {\r\n                undefinedGroups.set(tag, new Set());\r\n                customElementsWhenDefined(tag).then(function () {\r\n                    if (elementsDefinitionCallback) {\r\n                        var elements = undefinedGroups.get(tag);\r\n                        undefinedGroups.delete(tag);\r\n                        elementsDefinitionCallback(Array.from(elements));\r\n                    }\r\n                });\r\n            }\r\n            undefinedGroups.get(tag).add(el);\r\n        });\r\n    }\r\n    var canOptimizeUsingProxy = false;\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\r\n            canOptimizeUsingProxy = true;\r\n        });\r\n    }\r\n    var resolvers = new Map();\r\n    function handleIsDefined(e) {\r\n        canOptimizeUsingProxy = true;\r\n        if (resolvers.has(e.detail.tag)) {\r\n            var resolve = resolvers.get(e.detail.tag);\r\n            resolve();\r\n        }\r\n    }\r\n    function customElementsWhenDefined(tag) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve) {\r\n                        if (window.customElements && typeof customElements.whenDefined === 'function') {\r\n                            customElements.whenDefined(tag).then(function () { return resolve(); });\r\n                        }\r\n                        else if (canOptimizeUsingProxy) {\r\n                            resolvers.set(tag, resolve);\r\n                            document.dispatchEvent(new CustomEvent('__darkreader__addUndefinedResolver', { detail: { tag: tag } }));\r\n                        }\r\n                        else {\r\n                            var checkIfDefined_1 = function () {\r\n                                var elements = undefinedGroups.get(tag);\r\n                                if (elements && elements.size > 0) {\r\n                                    if (elements.values().next().value.matches(':defined')) {\r\n                                        resolve();\r\n                                    }\r\n                                    else {\r\n                                        requestAnimationFrame(checkIfDefined_1);\r\n                                    }\r\n                                }\r\n                            };\r\n                            requestAnimationFrame(checkIfDefined_1);\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    function watchWhenCustomElementsDefined(callback) {\r\n        elementsDefinitionCallback = callback;\r\n    }\r\n    function unsubscribeFromDefineCustomElements() {\r\n        elementsDefinitionCallback = null;\r\n        undefinedGroups.clear();\r\n        document.removeEventListener('__darkreader__isDefined', handleIsDefined);\r\n    }\r\n    function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\r\n        stopWatchingForStyleChanges();\r\n        var prevStyles = new Set(currentStyles);\r\n        var prevStyleSiblings = new WeakMap();\r\n        var nextStyleSiblings = new WeakMap();\r\n        function saveStylePosition(style) {\r\n            prevStyleSiblings.set(style, style.previousElementSibling);\r\n            nextStyleSiblings.set(style, style.nextElementSibling);\r\n        }\r\n        function forgetStylePosition(style) {\r\n            prevStyleSiblings.delete(style);\r\n            nextStyleSiblings.delete(style);\r\n        }\r\n        function didStylePositionChange(style) {\r\n            return style.previousElementSibling !== prevStyleSiblings.get(style) || style.nextElementSibling !== nextStyleSiblings.get(style);\r\n        }\r\n        currentStyles.forEach(saveStylePosition);\r\n        function handleStyleOperations(operations) {\r\n            var createdStyles = operations.createdStyles, removedStyles = operations.removedStyles, movedStyles = operations.movedStyles;\r\n            createdStyles.forEach(function (s) { return saveStylePosition(s); });\r\n            movedStyles.forEach(function (s) { return saveStylePosition(s); });\r\n            removedStyles.forEach(function (s) { return forgetStylePosition(s); });\r\n            createdStyles.forEach(function (s) { return prevStyles.add(s); });\r\n            removedStyles.forEach(function (s) { return prevStyles.delete(s); });\r\n            if (createdStyles.size + removedStyles.size + movedStyles.size > 0) {\r\n                update({\r\n                    created: Array.from(createdStyles),\r\n                    removed: Array.from(removedStyles),\r\n                    moved: Array.from(movedStyles),\r\n                    updated: [],\r\n                });\r\n            }\r\n        }\r\n        function handleMinorTreeMutations(_a) {\r\n            var additions = _a.additions, moves = _a.moves, deletions = _a.deletions;\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            additions.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return createdStyles.add(style); }); });\r\n            deletions.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return removedStyles.add(style); }); });\r\n            moves.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return movedStyles.add(style); }); });\r\n            handleStyleOperations({ createdStyles: createdStyles, removedStyles: removedStyles, movedStyles: movedStyles });\r\n            additions.forEach(function (n) {\r\n                iterateShadowHosts(n, subscribeForShadowRootChanges);\r\n                collectUndefinedElements(n);\r\n            });\r\n        }\r\n        function handleHugeTreeMutations(root) {\r\n            var styles = new Set(getManageableStyles(root));\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            styles.forEach(function (s) {\r\n                if (!prevStyles.has(s)) {\r\n                    createdStyles.add(s);\r\n                }\r\n            });\r\n            prevStyles.forEach(function (s) {\r\n                if (!styles.has(s)) {\r\n                    removedStyles.add(s);\r\n                }\r\n            });\r\n            styles.forEach(function (s) {\r\n                if (!createdStyles.has(s) && !removedStyles.has(s) && didStylePositionChange(s)) {\r\n                    movedStyles.add(s);\r\n                }\r\n            });\r\n            handleStyleOperations({ createdStyles: createdStyles, removedStyles: removedStyles, movedStyles: movedStyles });\r\n            iterateShadowHosts(root, subscribeForShadowRootChanges);\r\n            collectUndefinedElements(root);\r\n        }\r\n        function handleAttributeMutations(mutations) {\r\n            var updatedStyles = new Set();\r\n            var removedStyles = new Set();\r\n            mutations.forEach(function (m) {\r\n                var target = m.target;\r\n                if (target.isConnected) {\r\n                    if (shouldManageStyle(target)) {\r\n                        updatedStyles.add(target);\r\n                    }\r\n                    else if (target instanceof HTMLLinkElement && target.disabled) {\r\n                        removedStyles.add(target);\r\n                    }\r\n                }\r\n            });\r\n            if (updatedStyles.size + removedStyles.size > 0) {\r\n                update({\r\n                    updated: Array.from(updatedStyles),\r\n                    created: [],\r\n                    removed: Array.from(removedStyles),\r\n                    moved: [],\r\n                });\r\n            }\r\n        }\r\n        function observe(root) {\r\n            var treeObserver = createOptimizedTreeObserver(root, {\r\n                onMinorMutations: handleMinorTreeMutations,\r\n                onHugeMutations: handleHugeTreeMutations,\r\n            });\r\n            var attrObserver = new MutationObserver(handleAttributeMutations);\r\n            attrObserver.observe(root, { attributes: true, attributeFilter: ['rel', 'disabled', 'media'], subtree: true });\r\n            observers.push(treeObserver, attrObserver);\r\n            observedRoots.add(root);\r\n        }\r\n        function subscribeForShadowRootChanges(node) {\r\n            var shadowRoot = node.shadowRoot;\r\n            if (shadowRoot == null || observedRoots.has(shadowRoot)) {\r\n                return;\r\n            }\r\n            observe(shadowRoot);\r\n            shadowRootDiscovered(shadowRoot);\r\n        }\r\n        observe(document);\r\n        iterateShadowHosts(document.documentElement, subscribeForShadowRootChanges);\r\n        watchWhenCustomElementsDefined(function (hosts) {\r\n            var newStyles = [];\r\n            hosts.forEach(function (host) { return push(newStyles, getManageableStyles(host.shadowRoot)); });\r\n            update({ created: newStyles, updated: [], removed: [], moved: [] });\r\n            hosts.forEach(function (host) {\r\n                var shadowRoot = host.shadowRoot;\r\n                if (shadowRoot == null) {\r\n                    return;\r\n                }\r\n                subscribeForShadowRootChanges(host);\r\n                iterateShadowHosts(shadowRoot, subscribeForShadowRootChanges);\r\n                collectUndefinedElements(shadowRoot);\r\n            });\r\n        });\r\n        document.addEventListener('__darkreader__isDefined', handleIsDefined);\r\n        collectUndefinedElements(document);\r\n    }\r\n    function resetObservers() {\r\n        observers.forEach(function (o) { return o.disconnect(); });\r\n        observers.splice(0, observers.length);\r\n        observedRoots = new WeakSet();\r\n    }\r\n    function stopWatchingForStyleChanges() {\r\n        resetObservers();\r\n        unsubscribeFromDefineCustomElements();\r\n    }\n\n    function hexify(number) {\r\n        return (number < 16 ? '0' : '') + number.toString(16);\r\n    }\r\n    function generateUID() {\r\n        if (typeof crypto === 'undefined')\r\n            return 'xxx-xxxx';\r\n        if ('randomUUID' in crypto) {\r\n            var uuid = crypto.randomUUID();\r\n            return uuid.substring(0, 8) + uuid.substring(9, 13) + uuid.substring(14, 18) + uuid.substring(19, 23) + uuid.substring(24);\r\n        }\r\n        return Array.from(crypto.getRandomValues(new Uint8Array(16)))\r\n            .map(function (x) { return hexify(x); })\r\n            .join('');\r\n    }\n\n    var adoptedStyleOverrides = new WeakMap();\r\n    var overrideList = new WeakSet();\r\n    function createAdoptedStyleSheetOverride(node) {\r\n        var cancelAsyncOperations = false;\r\n        function injectSheet(sheet, override) {\r\n            var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\r\n            var sheetIndex = newSheets.indexOf(sheet);\r\n            var existingIndex = newSheets.indexOf(override);\r\n            if (sheetIndex === existingIndex - 1) {\r\n                return;\r\n            }\r\n            if (existingIndex >= 0) {\r\n                newSheets.splice(existingIndex, 1);\r\n            }\r\n            newSheets.splice(sheetIndex + 1, 0, override);\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function destroy() {\r\n            cancelAsyncOperations = true;\r\n            var newSheets = __spreadArray([], __read(node.adoptedStyleSheets), false);\r\n            node.adoptedStyleSheets.forEach(function (adoptedStyleSheet) {\r\n                if (overrideList.has(adoptedStyleSheet)) {\r\n                    var existingIndex = newSheets.indexOf(adoptedStyleSheet);\r\n                    if (existingIndex >= 0) {\r\n                        newSheets.splice(existingIndex, 1);\r\n                    }\r\n                    adoptedStyleOverrides.delete(adoptedStyleSheet);\r\n                    overrideList.delete(adoptedStyleSheet);\r\n                }\r\n            });\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function render(theme, ignoreImageAnalysis) {\r\n            node.adoptedStyleSheets.forEach(function (sheet) {\r\n                if (overrideList.has(sheet)) {\r\n                    return;\r\n                }\r\n                var rules = sheet.rules;\r\n                var override = new CSSStyleSheet();\r\n                function prepareOverridesSheet() {\r\n                    for (var i = override.cssRules.length - 1; i >= 0; i--) {\r\n                        override.deleteRule(i);\r\n                    }\r\n                    injectSheet(sheet, override);\r\n                    adoptedStyleOverrides.set(sheet, override);\r\n                    overrideList.add(override);\r\n                    return override;\r\n                }\r\n                var sheetModifier = createStyleSheetModifier();\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: false,\r\n                    isAsyncCancelled: function () { return cancelAsyncOperations; },\r\n                });\r\n            });\r\n        }\r\n        return {\r\n            render: render,\r\n            destroy: destroy\r\n        };\r\n    }\n\n    function injectProxy(enableStyleSheetsProxy) {\r\n        document.dispatchEvent(new CustomEvent('__darkreader__inlineScriptsAllowed'));\r\n        var addRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'addRule');\r\n        var insertRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'insertRule');\r\n        var deleteRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'deleteRule');\r\n        var removeRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'removeRule');\r\n        var documentStyleSheetsDescriptor = enableStyleSheetsProxy ?\r\n            Object.getOwnPropertyDescriptor(Document.prototype, 'styleSheets') : null;\r\n        var shouldWrapHTMLElement = location.hostname.endsWith('baidu.com');\r\n        var getElementsByTagNameDescriptor = shouldWrapHTMLElement ?\r\n            Object.getOwnPropertyDescriptor(Element.prototype, 'getElementsByTagName') : null;\r\n        var cleanUp = function () {\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'addRule', addRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', insertRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', deleteRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', removeRuleDescriptor);\r\n            document.removeEventListener('__darkreader__cleanUp', cleanUp);\r\n            document.removeEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\r\n            if (enableStyleSheetsProxy) {\r\n                Object.defineProperty(Document.prototype, 'styleSheets', documentStyleSheetsDescriptor);\r\n            }\r\n            if (shouldWrapHTMLElement) {\r\n                Object.defineProperty(Element.prototype, 'getElementsByTagName', getElementsByTagNameDescriptor);\r\n            }\r\n        };\r\n        var addUndefinedResolver = function (e) {\r\n            customElements.whenDefined(e.detail.tag).then(function () {\r\n                document.dispatchEvent(new CustomEvent('__darkreader__isDefined', { detail: { tag: e.detail.tag } }));\r\n            });\r\n        };\r\n        document.addEventListener('__darkreader__cleanUp', cleanUp);\r\n        document.addEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\r\n        var updateSheetEvent = new Event('__darkreader__updateSheet');\r\n        function proxyAddRule(selector, style, index) {\r\n            addRuleDescriptor.value.call(this, selector, style, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return -1;\r\n        }\r\n        function proxyInsertRule(rule, index) {\r\n            var returnValue = insertRuleDescriptor.value.call(this, rule, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return returnValue;\r\n        }\r\n        function proxyDeleteRule(index) {\r\n            deleteRuleDescriptor.value.call(this, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyRemoveRule(index) {\r\n            removeRuleDescriptor.value.call(this, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyDocumentStyleSheets() {\r\n            var docSheets = documentStyleSheetsDescriptor.get.call(this);\r\n            var filtered = __spreadArray([], __read(docSheets), false).filter(function (styleSheet) {\r\n                return !styleSheet.ownerNode.classList.contains('darkreader');\r\n            });\r\n            return Object.setPrototypeOf(filtered, StyleSheetList.prototype);\r\n        }\r\n        function proxyGetElementsByTagName(tagName) {\r\n            var _this = this;\r\n            if (tagName !== 'style') {\r\n                return getElementsByTagNameDescriptor.value.call(this, tagName);\r\n            }\r\n            var getCurrentElementValue = function () {\r\n                var elements = getElementsByTagNameDescriptor.value.call(_this, tagName);\r\n                return Object.setPrototypeOf(__spreadArray([], __read(elements), false).filter(function (element) {\r\n                    return !element.classList.contains('darkreader');\r\n                }), NodeList.prototype);\r\n            };\r\n            var elements = getCurrentElementValue();\r\n            var NodeListBehavior = {\r\n                get: function (_, property) {\r\n                    return getCurrentElementValue()[Number(property)];\r\n                }\r\n            };\r\n            elements = new Proxy(elements, NodeListBehavior);\r\n            return elements;\r\n        }\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'addRule', Object.assign({}, addRuleDescriptor, { value: proxyAddRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', Object.assign({}, insertRuleDescriptor, { value: proxyInsertRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', Object.assign({}, deleteRuleDescriptor, { value: proxyDeleteRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', Object.assign({}, removeRuleDescriptor, { value: proxyRemoveRule }));\r\n        if (enableStyleSheetsProxy) {\r\n            Object.defineProperty(Document.prototype, 'styleSheets', Object.assign({}, documentStyleSheetsDescriptor, { get: proxyDocumentStyleSheets }));\r\n        }\r\n        if (shouldWrapHTMLElement) {\r\n            Object.defineProperty(Element.prototype, 'getElementsByTagName', Object.assign({}, getElementsByTagNameDescriptor, { value: proxyGetElementsByTagName }));\r\n        }\r\n    }\n\n    var INSTANCE_ID = generateUID();\r\n    var styleManagers = new Map();\r\n    var adoptedStyleManagers = [];\r\n    var filter = null;\r\n    var fixes = null;\r\n    var isIFrame$1 = null;\r\n    var ignoredImageAnalysisSelectors = null;\r\n    var ignoredInlineSelectors = null;\r\n    function createOrUpdateStyle(className, root) {\r\n        if (root === void 0) { root = document.head || document; }\r\n        var element = root.querySelector(\".\" + className);\r\n        if (!element) {\r\n            element = document.createElement('style');\r\n            element.classList.add('darkreader');\r\n            element.classList.add(className);\r\n            element.media = 'screen';\r\n            element.textContent = '';\r\n        }\r\n        return element;\r\n    }\r\n    function createOrUpdateScript(className, root) {\r\n        if (root === void 0) { root = document.head || document; }\r\n        var element = root.querySelector(\".\" + className);\r\n        if (!element) {\r\n            element = document.createElement('script');\r\n            element.classList.add('darkreader');\r\n            element.classList.add(className);\r\n        }\r\n        return element;\r\n    }\r\n    var nodePositionWatchers = new Map();\r\n    function setupNodePositionWatcher(node, alias) {\r\n        nodePositionWatchers.has(alias) && nodePositionWatchers.get(alias).stop();\r\n        nodePositionWatchers.set(alias, watchForNodePosition(node, 'parent'));\r\n    }\r\n    function stopStylePositionWatchers() {\r\n        forEach(nodePositionWatchers.values(), function (watcher) { return watcher.stop(); });\r\n        nodePositionWatchers.clear();\r\n    }\r\n    function createStaticStyleOverrides() {\r\n        var fallbackStyle = createOrUpdateStyle('darkreader--fallback', document);\r\n        fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: true });\r\n        document.head.insertBefore(fallbackStyle, document.head.firstChild);\r\n        setupNodePositionWatcher(fallbackStyle, 'fallback');\r\n        var userAgentStyle = createOrUpdateStyle('darkreader--user-agent');\r\n        userAgentStyle.textContent = getModifiedUserAgentStyle(filter, isIFrame$1, filter.styleSystemControls);\r\n        document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(userAgentStyle, 'user-agent');\r\n        var textStyle = createOrUpdateStyle('darkreader--text');\r\n        if (filter.useFont || filter.textStroke > 0) {\r\n            textStyle.textContent = createTextStyle(filter);\r\n        }\r\n        else {\r\n            textStyle.textContent = '';\r\n        }\r\n        document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(textStyle, 'text');\r\n        var invertStyle = createOrUpdateStyle('darkreader--invert');\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                fixes.invert.join(', ') + \" {\",\r\n                \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), { contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100) })) + \" !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }\r\n        else {\r\n            invertStyle.textContent = '';\r\n        }\r\n        document.head.insertBefore(invertStyle, textStyle.nextSibling);\r\n        setupNodePositionWatcher(invertStyle, 'invert');\r\n        var inlineStyle = createOrUpdateStyle('darkreader--inline');\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\r\n        setupNodePositionWatcher(inlineStyle, 'inline');\r\n        var overrideStyle = createOrUpdateStyle('darkreader--override');\r\n        overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\r\n        document.head.appendChild(overrideStyle);\r\n        setupNodePositionWatcher(overrideStyle, 'override');\r\n        var variableStyle = createOrUpdateStyle('darkreader--variables');\r\n        var selectionColors = getSelectionColor(filter);\r\n        var darkSchemeBackgroundColor = filter.darkSchemeBackgroundColor, darkSchemeTextColor = filter.darkSchemeTextColor, lightSchemeBackgroundColor = filter.lightSchemeBackgroundColor, lightSchemeTextColor = filter.lightSchemeTextColor, mode = filter.mode;\r\n        var schemeBackgroundColor = mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\r\n        var schemeTextColor = mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\r\n        schemeBackgroundColor = modifyBackgroundColor(parse(schemeBackgroundColor), filter);\r\n        schemeTextColor = modifyForegroundColor(parse(schemeTextColor), filter);\r\n        variableStyle.textContent = [\r\n            \":root {\",\r\n            \"   --darkreader-neutral-background: \" + schemeBackgroundColor + \";\",\r\n            \"   --darkreader-neutral-text: \" + schemeTextColor + \";\",\r\n            \"   --darkreader-selection-background: \" + selectionColors.backgroundColorSelection + \";\",\r\n            \"   --darkreader-selection-text: \" + selectionColors.foregroundColorSelection + \";\",\r\n            \"}\",\r\n        ].join('\\n');\r\n        document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\r\n        setupNodePositionWatcher(variableStyle, 'variables');\r\n        var rootVarsStyle = createOrUpdateStyle('darkreader--root-vars');\r\n        document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\r\n        var proxyScript = createOrUpdateScript('darkreader--proxy');\r\n        proxyScript.append(\"(\" + injectProxy + \")(!\" + (fixes && fixes.disableStyleSheetsProxy) + \")\");\r\n        document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\r\n        proxyScript.remove();\r\n    }\r\n    var shadowRootsWithOverrides = new Set();\r\n    function createShadowStaticStyleOverrides(root) {\r\n        var inlineStyle = createOrUpdateStyle('darkreader--inline', root);\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        root.insertBefore(inlineStyle, root.firstChild);\r\n        var overrideStyle = createOrUpdateStyle('darkreader--override', root);\r\n        overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\r\n        root.insertBefore(overrideStyle, inlineStyle.nextSibling);\r\n        var invertStyle = createOrUpdateStyle('darkreader--invert', root);\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                fixes.invert.join(', ') + \" {\",\r\n                \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), { contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100) })) + \" !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }\r\n        else {\r\n            invertStyle.textContent = '';\r\n        }\r\n        root.insertBefore(invertStyle, overrideStyle.nextSibling);\r\n        shadowRootsWithOverrides.add(root);\r\n    }\r\n    function replaceCSSTemplates($cssText) {\r\n        return $cssText.replace(/\\${(.+?)}/g, function (_, $color) {\r\n            var color = tryParseColor($color);\r\n            if (color) {\r\n                return modifyColor(color, filter);\r\n            }\r\n            logWarn(\"Couldn't parse CSSTemplate's color.\");\r\n            return $color;\r\n        });\r\n    }\r\n    function cleanFallbackStyle() {\r\n        var fallback = document.querySelector('.darkreader--fallback');\r\n        if (fallback) {\r\n            fallback.textContent = '';\r\n        }\r\n    }\r\n    function createDynamicStyleOverrides() {\r\n        cancelRendering();\r\n        var allStyles = getManageableStyles(document);\r\n        var newManagers = allStyles.filter(function (style) { return !styleManagers.has(style); }).map(function (style) { return createManager(style); });\r\n        newManagers\r\n            .map(function (manager) { return manager.details({ secondRound: false }); })\r\n            .filter(function (detail) { return detail && detail.rules.length > 0; })\r\n            .forEach(function (detail) {\r\n            variablesStore.addRulesForMatching(detail.rules);\r\n        });\r\n        variablesStore.matchVariablesAndDependants();\r\n        variablesStore.setOnRootVariableChange(function () {\r\n            variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n        });\r\n        variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n        styleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n        }\r\n        newManagers.forEach(function (manager) { return manager.watch(); });\r\n        var inlineStyleElements = toArray(document.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            createShadowStaticStyleOverrides(host.shadowRoot);\r\n            var elements = host.shadowRoot.querySelectorAll(INLINE_STYLE_SELECTOR);\r\n            if (elements.length > 0) {\r\n                push(inlineStyleElements, elements);\r\n            }\r\n        });\r\n        inlineStyleElements.forEach(function (el) { return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors); });\r\n        handleAdoptedStyleSheets(document);\r\n    }\r\n    var loadingStylesCounter = 0;\r\n    var loadingStyles = new Set();\r\n    function createManager(element) {\r\n        var loadingStyleId = ++loadingStylesCounter;\r\n        logInfo(\"New manager for element, with loadingStyleID \" + loadingStyleId, element);\r\n        function loadingStart() {\r\n            if (!isDOMReady() || !didDocumentShowUp) {\r\n                loadingStyles.add(loadingStyleId);\r\n                logInfo(\"Current amount of styles loading: \" + loadingStyles.size);\r\n                var fallbackStyle = document.querySelector('.darkreader--fallback');\r\n                if (!fallbackStyle.textContent) {\r\n                    fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: false });\r\n                }\r\n            }\r\n        }\r\n        function loadingEnd() {\r\n            loadingStyles.delete(loadingStyleId);\r\n            logInfo(\"Removed loadingStyle \" + loadingStyleId + \", now awaiting: \" + loadingStyles.size);\r\n            logInfo(\"To-do to be loaded\", loadingStyles);\r\n            if (loadingStyles.size === 0 && isDOMReady()) {\r\n                cleanFallbackStyle();\r\n            }\r\n        }\r\n        function update() {\r\n            var details = manager.details({ secondRound: true });\r\n            if (!details) {\r\n                return;\r\n            }\r\n            variablesStore.addRulesForMatching(details.rules);\r\n            variablesStore.matchVariablesAndDependants();\r\n            manager.render(filter, ignoredImageAnalysisSelectors);\r\n        }\r\n        var manager = manageStyle(element, { update: update, loadingStart: loadingStart, loadingEnd: loadingEnd });\r\n        styleManagers.set(element, manager);\r\n        return manager;\r\n    }\r\n    function removeManager(element) {\r\n        var manager = styleManagers.get(element);\r\n        if (manager) {\r\n            manager.destroy();\r\n            styleManagers.delete(element);\r\n        }\r\n    }\r\n    var throttledRenderAllStyles = throttle(function (callback) {\r\n        styleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        adoptedStyleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        callback && callback();\r\n    });\r\n    var cancelRendering = function () {\r\n        throttledRenderAllStyles.cancel();\r\n    };\r\n    function onDOMReady() {\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n            return;\r\n        }\r\n        logWarn(\"DOM is ready, but still have styles being loaded.\", loadingStyles);\r\n    }\r\n    var documentVisibilityListener = null;\r\n    var didDocumentShowUp = typeof document !== 'undefined' && !document.hidden;\r\n    function watchForDocumentVisibility(callback) {\r\n        var alreadyWatching = Boolean(documentVisibilityListener);\r\n        documentVisibilityListener = function () {\r\n            if (!document.hidden) {\r\n                stopWatchingForDocumentVisibility();\r\n                callback();\r\n                didDocumentShowUp = true;\r\n            }\r\n        };\r\n        if (!alreadyWatching) {\r\n            document.addEventListener('visibilitychange', documentVisibilityListener);\r\n        }\r\n    }\r\n    function stopWatchingForDocumentVisibility() {\r\n        document.removeEventListener('visibilitychange', documentVisibilityListener);\r\n        documentVisibilityListener = null;\r\n    }\r\n    function createThemeAndWatchForUpdates() {\r\n        createStaticStyleOverrides();\r\n        function runDynamicStyle() {\r\n            createDynamicStyleOverrides();\r\n            watchForUpdates();\r\n        }\r\n        if (document.hidden) {\r\n            watchForDocumentVisibility(runDynamicStyle);\r\n        }\r\n        else {\r\n            runDynamicStyle();\r\n        }\r\n        changeMetaThemeColorWhenAvailable(filter);\r\n    }\r\n    function handleAdoptedStyleSheets(node) {\r\n        if (Array.isArray(node.adoptedStyleSheets)) {\r\n            if (node.adoptedStyleSheets.length > 0) {\r\n                var newManger = createAdoptedStyleSheetOverride(node);\r\n                adoptedStyleManagers.push(newManger);\r\n                newManger.render(filter, ignoredImageAnalysisSelectors);\r\n            }\r\n        }\r\n    }\r\n    function watchForUpdates() {\r\n        var managedStyles = Array.from(styleManagers.keys());\r\n        watchForStyleChanges(managedStyles, function (_a) {\r\n            var created = _a.created, updated = _a.updated, removed = _a.removed, moved = _a.moved;\r\n            var stylesToRemove = removed;\r\n            var stylesToManage = created\r\n                .concat(updated)\r\n                .concat(moved)\r\n                .filter(function (style) { return !styleManagers.has(style); });\r\n            var stylesToRestore = moved.filter(function (style) { return styleManagers.has(style); });\r\n            logInfo(\"Styles to be removed:\", stylesToRemove);\r\n            stylesToRemove.forEach(function (style) { return removeManager(style); });\r\n            var newManagers = stylesToManage.map(function (style) { return createManager(style); });\r\n            newManagers\r\n                .map(function (manager) { return manager.details({ secondRound: false }); })\r\n                .filter(function (detail) { return detail && detail.rules.length > 0; })\r\n                .forEach(function (detail) {\r\n                variablesStore.addRulesForMatching(detail.rules);\r\n            });\r\n            variablesStore.matchVariablesAndDependants();\r\n            newManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n            newManagers.forEach(function (manager) { return manager.watch(); });\r\n            stylesToRestore.forEach(function (style) { return styleManagers.get(style).restore(); });\r\n        }, function (shadowRoot) {\r\n            createShadowStaticStyleOverrides(shadowRoot);\r\n            handleAdoptedStyleSheets(shadowRoot);\r\n        });\r\n        watchForInlineStyles(function (element) {\r\n            overrideInlineStyle(element, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\r\n            if (element === document.documentElement) {\r\n                var styleAttr = element.getAttribute('style');\r\n                if (styleAttr.includes('--')) {\r\n                    variablesStore.matchVariablesAndDependants();\r\n                    variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n                }\r\n            }\r\n        }, function (root) {\r\n            createShadowStaticStyleOverrides(root);\r\n            var inlineStyleElements = root.querySelectorAll(INLINE_STYLE_SELECTOR);\r\n            if (inlineStyleElements.length > 0) {\r\n                forEach(inlineStyleElements, function (el) { return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors); });\r\n            }\r\n        });\r\n        addDOMReadyListener(onDOMReady);\r\n    }\r\n    function stopWatchingForUpdates() {\r\n        styleManagers.forEach(function (manager) { return manager.pause(); });\r\n        stopStylePositionWatchers();\r\n        stopWatchingForStyleChanges();\r\n        stopWatchingForInlineStyles();\r\n        removeDOMReadyListener(onDOMReady);\r\n        cleanReadyStateCompleteListeners();\r\n    }\r\n    function createDarkReaderInstanceMarker() {\r\n        var metaElement = document.createElement('meta');\r\n        metaElement.name = 'darkreader';\r\n        metaElement.content = INSTANCE_ID;\r\n        document.head.appendChild(metaElement);\r\n    }\r\n    function isAnotherDarkReaderInstanceActive() {\r\n        var meta = document.querySelector('meta[name=\"darkreader\"]');\r\n        if (meta) {\r\n            if (meta.content !== INSTANCE_ID) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        createDarkReaderInstanceMarker();\r\n        return false;\r\n    }\r\n    function createOrUpdateDynamicTheme(filterConfig, dynamicThemeFixes, iframe) {\r\n        filter = filterConfig;\r\n        fixes = dynamicThemeFixes;\r\n        if (fixes) {\r\n            ignoredImageAnalysisSelectors = Array.isArray(fixes.ignoreImageAnalysis) ? fixes.ignoreImageAnalysis : [];\r\n            ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle) ? fixes.ignoreInlineStyle : [];\r\n        }\r\n        else {\r\n            ignoredImageAnalysisSelectors = [];\r\n            ignoredInlineSelectors = [];\r\n        }\r\n        isIFrame$1 = iframe;\r\n        if (document.head) {\r\n            if (isAnotherDarkReaderInstanceActive()) {\r\n                return;\r\n            }\r\n            document.documentElement.setAttribute('data-darkreader-mode', 'dynamic');\r\n            document.documentElement.setAttribute('data-darkreader-scheme', filter.mode ? 'dark' : 'dimmed');\r\n            createThemeAndWatchForUpdates();\r\n        }\r\n        else {\r\n            if (!isFirefox) {\r\n                var fallbackStyle = createOrUpdateStyle('darkreader--fallback');\r\n                document.documentElement.appendChild(fallbackStyle);\r\n                fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: true });\r\n            }\r\n            var headObserver_1 = new MutationObserver(function () {\r\n                if (document.head) {\r\n                    headObserver_1.disconnect();\r\n                    if (isAnotherDarkReaderInstanceActive()) {\r\n                        removeDynamicTheme();\r\n                        return;\r\n                    }\r\n                    createThemeAndWatchForUpdates();\r\n                }\r\n            });\r\n            headObserver_1.observe(document, { childList: true, subtree: true });\r\n        }\r\n    }\r\n    function removeProxy() {\r\n        document.dispatchEvent(new CustomEvent('__darkreader__cleanUp'));\r\n        removeNode(document.head.querySelector('.darkreader--proxy'));\r\n    }\r\n    function removeDynamicTheme() {\r\n        document.documentElement.removeAttribute(\"data-darkreader-mode\");\r\n        document.documentElement.removeAttribute(\"data-darkreader-scheme\");\r\n        cleanDynamicThemeCache();\r\n        removeNode(document.querySelector('.darkreader--fallback'));\r\n        if (document.head) {\r\n            restoreMetaThemeColor();\r\n            removeNode(document.head.querySelector('.darkreader--user-agent'));\r\n            removeNode(document.head.querySelector('.darkreader--text'));\r\n            removeNode(document.head.querySelector('.darkreader--invert'));\r\n            removeNode(document.head.querySelector('.darkreader--inline'));\r\n            removeNode(document.head.querySelector('.darkreader--override'));\r\n            removeNode(document.head.querySelector('.darkreader--variables'));\r\n            removeNode(document.head.querySelector('.darkreader--root-vars'));\r\n            removeNode(document.head.querySelector('meta[name=\"darkreader\"]'));\r\n            removeProxy();\r\n        }\r\n        shadowRootsWithOverrides.forEach(function (root) {\r\n            removeNode(root.querySelector('.darkreader--inline'));\r\n            removeNode(root.querySelector('.darkreader--override'));\r\n        });\r\n        shadowRootsWithOverrides.clear();\r\n        forEach(styleManagers.keys(), function (el) { return removeManager(el); });\r\n        loadingStyles.clear();\r\n        cleanLoadingLinks();\r\n        forEach(document.querySelectorAll('.darkreader'), removeNode);\r\n        adoptedStyleManagers.forEach(function (manager) {\r\n            manager.destroy();\r\n        });\r\n        adoptedStyleManagers.splice(0);\r\n    }\r\n    function cleanDynamicThemeCache() {\r\n        variablesStore.clear();\r\n        parsedURLCache.clear();\r\n        stopWatchingForDocumentVisibility();\r\n        cancelRendering();\r\n        stopWatchingForUpdates();\r\n        cleanModificationCache();\r\n    }\n\n    var blobRegex = /url\\(\\\"(blob\\:.*?)\\\"\\)/g;\r\n    function replaceBlobs(text) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promises, data;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        promises = [];\r\n                        getMatches(blobRegex, text, 1).forEach(function (url) {\r\n                            var promise = loadAsDataURL(url);\r\n                            promises.push(promise);\r\n                        });\r\n                        return [4, Promise.all(promises)];\r\n                    case 1:\r\n                        data = _a.sent();\r\n                        return [2, text.replace(blobRegex, function () { return \"url(\\\"\" + data.shift() + \"\\\")\"; })];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var banner = \"/*\\n                        _______\\n                       /       \\\\\\n                      .==.    .==.\\n                     ((  ))==((  ))\\n                    / \\\"==\\\"    \\\"==\\\"\\\\\\n                   /____|| || ||___\\\\\\n       ________     ____    ________  ___    ___\\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\\n                https://darkreader.org\\n*/\\n\\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/master/LICENSE */\\n\";\r\n    function collectCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            function addStaticCSS(selector, comment) {\r\n                var staticStyle = document.querySelector(selector);\r\n                if (staticStyle && staticStyle.textContent) {\r\n                    css.push(\"/* \" + comment + \" */\");\r\n                    css.push(staticStyle.textContent);\r\n                    css.push('');\r\n                }\r\n            }\r\n            var css, modifiedCSS, formattedCSS, _a, _b;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        css = [banner];\r\n                        addStaticCSS('.darkreader--fallback', 'Fallback Style');\r\n                        addStaticCSS('.darkreader--user-agent', 'User-Agent Style');\r\n                        addStaticCSS('.darkreader--text', 'Text Style');\r\n                        addStaticCSS('.darkreader--invert', 'Invert Style');\r\n                        addStaticCSS('.darkreader--variables', 'Variables Style');\r\n                        modifiedCSS = [];\r\n                        document.querySelectorAll('.darkreader--sync').forEach(function (element) {\r\n                            forEach(element.sheet.cssRules, function (rule) {\r\n                                rule && rule.cssText && modifiedCSS.push(rule.cssText);\r\n                            });\r\n                        });\r\n                        if (!modifiedCSS.length) return [3, 2];\r\n                        formattedCSS = formatCSS(modifiedCSS.join('\\n'));\r\n                        css.push('/* Modified CSS */');\r\n                        _b = (_a = css).push;\r\n                        return [4, replaceBlobs(formattedCSS)];\r\n                    case 1:\r\n                        _b.apply(_a, [_c.sent()]);\r\n                        css.push('');\r\n                        _c.label = 2;\r\n                    case 2:\r\n                        addStaticCSS('.darkreader--override', 'Override Style');\r\n                        return [2, css.join('\\n')];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    var isDarkReaderEnabled = false;\r\n    var isIFrame = (function () {\r\n        if (typeof window === 'undefined')\r\n            return false;\r\n        try {\r\n            return window.self !== window.top;\r\n        }\r\n        catch (err) {\r\n            console.warn(err);\r\n            return true;\r\n        }\r\n    })();\r\n    function enable(themeOptions, fixes) {\r\n        if (themeOptions === void 0) { themeOptions = {}; }\r\n        if (fixes === void 0) { fixes = null; }\r\n        var theme = __assign(__assign({}, DEFAULT_THEME), themeOptions);\r\n        if (theme.engine !== ThemeEngines.dynamicTheme) {\r\n            throw new Error('Theme engine is not supported.');\r\n        }\r\n        createOrUpdateDynamicTheme(theme, fixes, isIFrame);\r\n        isDarkReaderEnabled = true;\r\n    }\r\n    function isEnabled() {\r\n        return isDarkReaderEnabled;\r\n    }\r\n    function disable() {\r\n        removeDynamicTheme();\r\n        isDarkReaderEnabled = false;\r\n    }\r\n    var store = {\r\n        themeOptions: null,\r\n        fixes: null,\r\n    };\r\n    function handleColorScheme() {\r\n        var darkScheme = matchMedia('(prefers-color-scheme: dark)');\r\n        if (darkScheme.matches) {\r\n            enable(store.themeOptions, store.fixes);\r\n        }\r\n        else {\r\n            disable();\r\n        }\r\n    }\r\n    function auto(themeOptions, fixes) {\r\n        if (themeOptions === void 0) { themeOptions = {}; }\r\n        if (fixes === void 0) { fixes = null; }\r\n        var darkScheme = matchMedia('(prefers-color-scheme: dark)');\r\n        if (themeOptions) {\r\n            store = { themeOptions: themeOptions, fixes: fixes };\r\n            handleColorScheme();\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.addEventListener('change', handleColorScheme);\r\n            }\r\n            else {\r\n                darkScheme.addListener(handleColorScheme);\r\n            }\r\n        }\r\n        else {\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.removeEventListener('change', handleColorScheme);\r\n            }\r\n            else {\r\n                darkScheme.removeListener(handleColorScheme);\r\n            }\r\n            disable();\r\n        }\r\n    }\r\n    function exportGeneratedCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, collectCSS()];\r\n                    case 1: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var setFetchMethod = setFetchMethod$1;\n\n    exports.auto = auto;\n    exports.disable = disable;\n    exports.enable = enable;\n    exports.exportGeneratedCSS = exportGeneratedCSS;\n    exports.isEnabled = isEnabled;\n    exports.setFetchMethod = setFetchMethod;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n"]},"metadata":{},"sourceType":"script"}