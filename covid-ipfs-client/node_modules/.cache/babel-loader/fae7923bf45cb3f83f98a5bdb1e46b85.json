{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar _excluded = [\"size\", \"collapse\", \"collapseLabel\", \"initialValues\", \"onValuesChange\", \"form\", \"placement\", \"formRef\", \"bordered\", \"ignoreRules\", \"footerRender\"];\nimport { FilterOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { FieldLabel, FilterDropdown } from '@ant-design/pro-utils';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport React, { useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport { BaseForm } from '../../BaseForm';\nimport './index.less';\n/**\n * 单行的查询表单，一般用于配合 table 或者 list使用 有时也会用于 card 的额外区域\n *\n * @param props\n */\n\nvar LightFilterContainer = function LightFilterContainer(props) {\n  var items = props.items,\n      prefixCls = props.prefixCls,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 'middle' : _props$size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      onValuesChange = props.onValuesChange,\n      bordered = props.bordered,\n      values = props.values,\n      footerRender = props.footerRender,\n      placement = props.placement;\n  var intl = useIntl();\n  var lightFilterClassName = \"\".concat(prefixCls, \"-light-filter\");\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(function () {\n    return _objectSpread({}, values);\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      moreValues = _useState4[0],\n      setMoreValues = _useState4[1];\n\n  useEffect(function () {\n    setMoreValues(_objectSpread({}, values));\n  }, [values]);\n\n  var _useMemo = useMemo(function () {\n    var collapseItemsArr = [];\n    var outsideItemsArr = [];\n    items.forEach(function (item) {\n      var _ref = item.props || {},\n          secondary = _ref.secondary;\n\n      if (secondary || collapse) {\n        collapseItemsArr.push(item);\n      } else {\n        outsideItemsArr.push(item);\n      }\n    });\n    return {\n      collapseItems: collapseItemsArr,\n      outsideItems: outsideItemsArr\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.items]),\n      collapseItems = _useMemo.collapseItems,\n      outsideItems = _useMemo.outsideItems;\n\n  var collapseLabelRender = function collapseLabelRender() {\n    if (collapseLabel) {\n      return collapseLabel;\n    }\n\n    if (collapse) {\n      return /*#__PURE__*/React.createElement(FilterOutlined, {\n        className: \"\".concat(lightFilterClassName, \"-collapse-icon\")\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(FieldLabel, {\n      size: size,\n      label: intl.getMessage('form.lightFilter.more', '更多筛选'),\n      expanded: open\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(lightFilterClassName, \"\".concat(lightFilterClassName, \"-\").concat(size), _defineProperty({}, \"\".concat(lightFilterClassName, \"-effective\"), Object.keys(values).some(function (key) {\n      return values[key];\n    })))\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-container\")\n  }, outsideItems.map(function (child, index) {\n    var key = child.key;\n    var fieldProps = child.props.fieldProps;\n    var newPlacement = (fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement) ? fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement : placement;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-item\"),\n      key: key || index\n    }, /*#__PURE__*/React.cloneElement(child, {\n      fieldProps: _objectSpread(_objectSpread({}, child.props.fieldProps), {}, {\n        placement: newPlacement\n      }),\n      // proFieldProps 会直接作为 ProField 的 props 传递过去\n      proFieldProps: {\n        light: true,\n        label: child.props.label,\n        bordered: bordered\n      },\n      bordered: bordered\n    }));\n  }), collapseItems.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-item\"),\n    key: \"more\"\n  }, /*#__PURE__*/React.createElement(FilterDropdown, {\n    padding: 24,\n    onVisibleChange: setOpen,\n    visible: open,\n    placement: placement,\n    label: collapseLabelRender(),\n    footerRender: footerRender,\n    footer: {\n      onConfirm: function onConfirm() {\n        onValuesChange(_objectSpread({}, moreValues));\n        setOpen(false);\n      },\n      onClear: function onClear() {\n        var clearValues = {};\n        collapseItems.forEach(function (child) {\n          var name = child.props.name;\n          clearValues[name] = undefined;\n        });\n        onValuesChange(clearValues);\n      }\n    }\n  }, collapseItems.map(function (child) {\n    var key = child.key;\n    var _child$props = child.props,\n        name = _child$props.name,\n        fieldProps = _child$props.fieldProps;\n\n    var newFieldProps = _objectSpread(_objectSpread({}, fieldProps), {}, {\n      onChange: function onChange(e) {\n        setMoreValues(_objectSpread(_objectSpread({}, moreValues), {}, _defineProperty({}, name, (e === null || e === void 0 ? void 0 : e.target) ? e.target.value : e)));\n        return false;\n      }\n    });\n\n    if (moreValues.hasOwnProperty(name)) {\n      newFieldProps[child.props.valuePropName || 'value'] = moreValues[name];\n    }\n\n    var newPlacement = (fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement) ? fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement : placement;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-line\"),\n      key: key\n    }, /*#__PURE__*/React.cloneElement(child, {\n      fieldProps: _objectSpread(_objectSpread({}, newFieldProps), {}, {\n        placement: newPlacement\n      })\n    }));\n  }))) : null));\n};\n\nfunction LightFilter(props) {\n  var size = props.size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      initialValues = props.initialValues,\n      _onValuesChange = props.onValuesChange,\n      userForm = props.form,\n      placement = props.placement,\n      userFormRef = props.formRef,\n      bordered = props.bordered,\n      ignoreRules = props.ignoreRules,\n      footerRender = props.footerRender,\n      reset = _objectWithoutProperties(props, _excluded);\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-form');\n\n  var _useState5 = useState(function () {\n    return _objectSpread({}, initialValues);\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var formRef = useRef();\n  useImperativeHandle(userFormRef, function () {\n    return formRef.current;\n  });\n  return /*#__PURE__*/React.createElement(BaseForm, _extends({\n    size: size,\n    initialValues: initialValues,\n    form: userForm,\n    contentRender: function contentRender(items) {\n      return /*#__PURE__*/React.createElement(LightFilterContainer, {\n        prefixCls: prefixCls,\n        items: items.flatMap(function (item) {\n          /** 如果是 ProFormGroup，直接拼接dom */\n          if ((item === null || item === void 0 ? void 0 : item.type.displayName) === 'ProForm-Group') return item.props.children;\n          return item;\n        }),\n        size: size,\n        bordered: bordered,\n        collapse: collapse,\n        collapseLabel: collapseLabel,\n        placement: placement,\n        values: values || {},\n        footerRender: footerRender,\n        onValuesChange: function onValuesChange(newValues) {\n          var _formRef$current, _formRef$current2;\n\n          var newAllValues = _objectSpread(_objectSpread({}, values), newValues);\n\n          setValues(newAllValues);\n          (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setFieldsValue(newAllValues);\n          (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.submit();\n\n          if (_onValuesChange) {\n            _onValuesChange(newValues, newAllValues);\n          }\n        }\n      });\n    },\n    formRef: formRef,\n    formItemProps: {\n      colon: false,\n      labelAlign: 'left'\n    },\n    fieldProps: {\n      style: {\n        width: undefined\n      }\n    }\n  }, omit(reset, ['labelWidth']), {\n    onValuesChange: function onValuesChange(_, allValues) {\n      var _formRef$current3;\n\n      setValues(allValues);\n      _onValuesChange === null || _onValuesChange === void 0 ? void 0 : _onValuesChange(_, allValues);\n      (_formRef$current3 = formRef.current) === null || _formRef$current3 === void 0 ? void 0 : _formRef$current3.submit();\n    }\n  }));\n}\n\nexport { LightFilter };","map":{"version":3,"sources":["/Users/jameszow/Documents/RustWorkSpace/covid-ipfs/covid-ipfs-client/node_modules/@ant-design/pro-form/es/layouts/LightFilter/index.js"],"names":["_extends","_ConfigProvider","_objectWithoutProperties","_defineProperty","_objectSpread","_slicedToArray","_excluded","FilterOutlined","useIntl","FieldLabel","FilterDropdown","classNames","omit","React","useContext","useEffect","useImperativeHandle","useMemo","useRef","useState","BaseForm","LightFilterContainer","props","items","prefixCls","_props$size","size","collapse","collapseLabel","onValuesChange","bordered","values","footerRender","placement","intl","lightFilterClassName","concat","_useState","_useState2","open","setOpen","_useState3","_useState4","moreValues","setMoreValues","_useMemo","collapseItemsArr","outsideItemsArr","forEach","item","_ref","secondary","push","collapseItems","outsideItems","collapseLabelRender","createElement","className","label","getMessage","expanded","Object","keys","some","key","map","child","index","fieldProps","newPlacement","cloneElement","proFieldProps","light","length","padding","onVisibleChange","visible","footer","onConfirm","onClear","clearValues","name","undefined","_child$props","newFieldProps","onChange","e","target","value","hasOwnProperty","valuePropName","LightFilter","initialValues","_onValuesChange","userForm","form","userFormRef","formRef","ignoreRules","reset","_useContext","ConfigContext","getPrefixCls","_useState5","_useState6","setValues","current","contentRender","flatMap","type","displayName","children","newValues","_formRef$current","_formRef$current2","newAllValues","setFieldsValue","submit","formItemProps","colon","labelAlign","style","width","_","allValues","_formRef$current3"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar _excluded = [\"size\", \"collapse\", \"collapseLabel\", \"initialValues\", \"onValuesChange\", \"form\", \"placement\", \"formRef\", \"bordered\", \"ignoreRules\", \"footerRender\"];\nimport { FilterOutlined } from '@ant-design/icons';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { FieldLabel, FilterDropdown } from '@ant-design/pro-utils';\nimport classNames from 'classnames';\nimport omit from 'omit.js';\nimport React, { useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport { BaseForm } from '../../BaseForm';\nimport './index.less';\n/**\n * 单行的查询表单，一般用于配合 table 或者 list使用 有时也会用于 card 的额外区域\n *\n * @param props\n */\n\nvar LightFilterContainer = function LightFilterContainer(props) {\n  var items = props.items,\n      prefixCls = props.prefixCls,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 'middle' : _props$size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      onValuesChange = props.onValuesChange,\n      bordered = props.bordered,\n      values = props.values,\n      footerRender = props.footerRender,\n      placement = props.placement;\n  var intl = useIntl();\n  var lightFilterClassName = \"\".concat(prefixCls, \"-light-filter\");\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(function () {\n    return _objectSpread({}, values);\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      moreValues = _useState4[0],\n      setMoreValues = _useState4[1];\n\n  useEffect(function () {\n    setMoreValues(_objectSpread({}, values));\n  }, [values]);\n\n  var _useMemo = useMemo(function () {\n    var collapseItemsArr = [];\n    var outsideItemsArr = [];\n    items.forEach(function (item) {\n      var _ref = item.props || {},\n          secondary = _ref.secondary;\n\n      if (secondary || collapse) {\n        collapseItemsArr.push(item);\n      } else {\n        outsideItemsArr.push(item);\n      }\n    });\n    return {\n      collapseItems: collapseItemsArr,\n      outsideItems: outsideItemsArr\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.items]),\n      collapseItems = _useMemo.collapseItems,\n      outsideItems = _useMemo.outsideItems;\n\n  var collapseLabelRender = function collapseLabelRender() {\n    if (collapseLabel) {\n      return collapseLabel;\n    }\n\n    if (collapse) {\n      return /*#__PURE__*/React.createElement(FilterOutlined, {\n        className: \"\".concat(lightFilterClassName, \"-collapse-icon\")\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(FieldLabel, {\n      size: size,\n      label: intl.getMessage('form.lightFilter.more', '更多筛选'),\n      expanded: open\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(lightFilterClassName, \"\".concat(lightFilterClassName, \"-\").concat(size), _defineProperty({}, \"\".concat(lightFilterClassName, \"-effective\"), Object.keys(values).some(function (key) {\n      return values[key];\n    })))\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-container\")\n  }, outsideItems.map(function (child, index) {\n    var key = child.key;\n    var fieldProps = child.props.fieldProps;\n    var newPlacement = (fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement) ? fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement : placement;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-item\"),\n      key: key || index\n    }, /*#__PURE__*/React.cloneElement(child, {\n      fieldProps: _objectSpread(_objectSpread({}, child.props.fieldProps), {}, {\n        placement: newPlacement\n      }),\n      // proFieldProps 会直接作为 ProField 的 props 传递过去\n      proFieldProps: {\n        light: true,\n        label: child.props.label,\n        bordered: bordered\n      },\n      bordered: bordered\n    }));\n  }), collapseItems.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-item\"),\n    key: \"more\"\n  }, /*#__PURE__*/React.createElement(FilterDropdown, {\n    padding: 24,\n    onVisibleChange: setOpen,\n    visible: open,\n    placement: placement,\n    label: collapseLabelRender(),\n    footerRender: footerRender,\n    footer: {\n      onConfirm: function onConfirm() {\n        onValuesChange(_objectSpread({}, moreValues));\n        setOpen(false);\n      },\n      onClear: function onClear() {\n        var clearValues = {};\n        collapseItems.forEach(function (child) {\n          var name = child.props.name;\n          clearValues[name] = undefined;\n        });\n        onValuesChange(clearValues);\n      }\n    }\n  }, collapseItems.map(function (child) {\n    var key = child.key;\n    var _child$props = child.props,\n        name = _child$props.name,\n        fieldProps = _child$props.fieldProps;\n\n    var newFieldProps = _objectSpread(_objectSpread({}, fieldProps), {}, {\n      onChange: function onChange(e) {\n        setMoreValues(_objectSpread(_objectSpread({}, moreValues), {}, _defineProperty({}, name, (e === null || e === void 0 ? void 0 : e.target) ? e.target.value : e)));\n        return false;\n      }\n    });\n\n    if (moreValues.hasOwnProperty(name)) {\n      newFieldProps[child.props.valuePropName || 'value'] = moreValues[name];\n    }\n\n    var newPlacement = (fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement) ? fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.placement : placement;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-line\"),\n      key: key\n    }, /*#__PURE__*/React.cloneElement(child, {\n      fieldProps: _objectSpread(_objectSpread({}, newFieldProps), {}, {\n        placement: newPlacement\n      })\n    }));\n  }))) : null));\n};\n\nfunction LightFilter(props) {\n  var size = props.size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      initialValues = props.initialValues,\n      _onValuesChange = props.onValuesChange,\n      userForm = props.form,\n      placement = props.placement,\n      userFormRef = props.formRef,\n      bordered = props.bordered,\n      ignoreRules = props.ignoreRules,\n      footerRender = props.footerRender,\n      reset = _objectWithoutProperties(props, _excluded);\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-form');\n\n  var _useState5 = useState(function () {\n    return _objectSpread({}, initialValues);\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var formRef = useRef();\n  useImperativeHandle(userFormRef, function () {\n    return formRef.current;\n  });\n  return /*#__PURE__*/React.createElement(BaseForm, _extends({\n    size: size,\n    initialValues: initialValues,\n    form: userForm,\n    contentRender: function contentRender(items) {\n      return /*#__PURE__*/React.createElement(LightFilterContainer, {\n        prefixCls: prefixCls,\n        items: items.flatMap(function (item) {\n          /** 如果是 ProFormGroup，直接拼接dom */\n          if ((item === null || item === void 0 ? void 0 : item.type.displayName) === 'ProForm-Group') return item.props.children;\n          return item;\n        }),\n        size: size,\n        bordered: bordered,\n        collapse: collapse,\n        collapseLabel: collapseLabel,\n        placement: placement,\n        values: values || {},\n        footerRender: footerRender,\n        onValuesChange: function onValuesChange(newValues) {\n          var _formRef$current, _formRef$current2;\n\n          var newAllValues = _objectSpread(_objectSpread({}, values), newValues);\n\n          setValues(newAllValues);\n          (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setFieldsValue(newAllValues);\n          (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.submit();\n\n          if (_onValuesChange) {\n            _onValuesChange(newValues, newAllValues);\n          }\n        }\n      });\n    },\n    formRef: formRef,\n    formItemProps: {\n      colon: false,\n      labelAlign: 'left'\n    },\n    fieldProps: {\n      style: {\n        width: undefined\n      }\n    }\n  }, omit(reset, ['labelWidth']), {\n    onValuesChange: function onValuesChange(_, allValues) {\n      var _formRef$current3;\n\n      setValues(allValues);\n      _onValuesChange === null || _onValuesChange === void 0 ? void 0 : _onValuesChange(_, allValues);\n      (_formRef$current3 = formRef.current) === null || _formRef$current3 === void 0 ? void 0 : _formRef$current3.submit();\n    }\n  }));\n}\n\nexport { LightFilter };"]},"metadata":{},"sourceType":"module"}