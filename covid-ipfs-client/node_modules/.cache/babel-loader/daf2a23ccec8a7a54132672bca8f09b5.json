{"ast":null,"code":"import \"antd/es/popover/style\";\nimport _Popover from \"antd/es/popover\";\nimport \"antd/es/input-number/style\";\nimport _InputNumber from \"antd/es/input-number\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nvar _excluded = [\"content\", \"numberFormatOptions\", \"numberPopoverRender\"],\n    _excluded2 = [\"text\", \"mode\", \"render\", \"renderFormItem\", \"fieldProps\", \"proFieldKey\", \"plain\", \"valueEnum\", \"placeholder\", \"locale\", \"customSymbol\", \"numberFormatOptions\", \"numberPopoverRender\"];\nimport { intlMap as allIntlMap, useIntl } from '@ant-design/pro-provider';\nimport omit from 'omit.js';\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport React, { useMemo } from 'react';\nvar defaultMoneyIntl = new Intl.NumberFormat('zh-Hans-CN', {\n  currency: 'CNY',\n  style: 'currency'\n});\nvar enMoneyIntl = {\n  style: 'currency',\n  currency: 'USD'\n};\nvar ruMoneyIntl = {\n  style: 'currency',\n  currency: 'RUB'\n};\nvar rsMoneyIntl = {\n  style: 'currency',\n  currency: 'RSD'\n};\nvar msMoneyIntl = {\n  style: 'currency',\n  currency: 'MYR'\n};\nvar ptMoneyIntl = {\n  style: 'currency',\n  currency: 'BRL'\n};\nvar intlMap = {\n  default: defaultMoneyIntl,\n  'zh-Hans-CN': {\n    currency: 'CNY',\n    style: 'currency'\n  },\n  'en-US': enMoneyIntl,\n  'ru-RU': ruMoneyIntl,\n  'ms-MY': msMoneyIntl,\n  'sr-RS': rsMoneyIntl,\n  'pt-BR': ptMoneyIntl\n};\n\nvar getTextByLocale = function getTextByLocale(localeStr, paramsText, precision, config) {\n  var moneyText = paramsText;\n\n  if (typeof moneyText === 'string') {\n    moneyText = Number(moneyText);\n  }\n\n  if (!moneyText && moneyText !== 0) return '';\n  return new Intl.NumberFormat(localeStr || 'zh-Hans-CN', _objectSpread(_objectSpread({}, intlMap[localeStr || 'zh-Hans-CN'] || intlMap['zh-Hans-CN']), {}, {\n    maximumFractionDigits: precision\n  }, config)).format(moneyText);\n};\n\nvar DefaultPrecisionCont = 2;\nvar InputNumberPopover = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var content = _ref.content,\n      numberFormatOptions = _ref.numberFormatOptions,\n      numberPopoverRender = _ref.numberPopoverRender,\n      rest = _objectWithoutProperties(_ref, _excluded);\n\n  var _useMergedState = useMergedState(function () {\n    return rest.defaultValue;\n  }, {\n    value: rest.value,\n    onChange: rest.onChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      value = _useMergedState2[0],\n      onChange = _useMergedState2[1];\n\n  var dom = content === null || content === void 0 ? void 0 : content(_objectSpread(_objectSpread({}, rest), {}, {\n    value: value\n  }));\n  var props = {\n    visible: dom ? rest.visible : false\n  };\n  return /*#__PURE__*/React.createElement(_Popover, _extends({\n    placement: \"topLeft\"\n  }, props, {\n    trigger: ['focus', 'click'],\n    content: dom,\n    getPopupContainer: function getPopupContainer(triggerNode) {\n      return (triggerNode === null || triggerNode === void 0 ? void 0 : triggerNode.parentElement) || document.body;\n    }\n  }), /*#__PURE__*/React.createElement(_InputNumber, _extends({\n    ref: ref\n  }, rest, {\n    value: value,\n    onChange: onChange\n  })));\n});\n/**\n * 金额组件\n *\n * @param FieldMoneyProps {\n *     text: number;\n *     moneySymbol?: string; }\n */\n\nvar FieldMoney = function FieldMoney(_ref2, ref) {\n  var _fieldProps$customSym, _fieldProps$precision;\n\n  var text = _ref2.text,\n      type = _ref2.mode,\n      render = _ref2.render,\n      renderFormItem = _ref2.renderFormItem,\n      fieldProps = _ref2.fieldProps,\n      proFieldKey = _ref2.proFieldKey,\n      plain = _ref2.plain,\n      valueEnum = _ref2.valueEnum,\n      placeholder = _ref2.placeholder,\n      _ref2$locale = _ref2.locale,\n      locale = _ref2$locale === void 0 ? (_fieldProps$customSym = fieldProps.customSymbol) !== null && _fieldProps$customSym !== void 0 ? _fieldProps$customSym : 'zh-Hans-CN' : _ref2$locale,\n      _ref2$customSymbol = _ref2.customSymbol,\n      customSymbol = _ref2$customSymbol === void 0 ? fieldProps.customSymbol : _ref2$customSymbol,\n      _ref2$numberFormatOpt = _ref2.numberFormatOptions,\n      numberFormatOptions = _ref2$numberFormatOpt === void 0 ? fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.numberFormatOptions : _ref2$numberFormatOpt,\n      _ref2$numberPopoverRe = _ref2.numberPopoverRender,\n      numberPopoverRender = _ref2$numberPopoverRe === void 0 ? (fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.numberPopoverRender) || false : _ref2$numberPopoverRe,\n      rest = _objectWithoutProperties(_ref2, _excluded2);\n\n  var precision = (_fieldProps$precision = fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.precision) !== null && _fieldProps$precision !== void 0 ? _fieldProps$precision : DefaultPrecisionCont;\n  var intl = useIntl(); // 当手动传入locale时，应该以传入的locale为准，未传入时则根据全局的locale进行国际化\n\n  if (locale && allIntlMap[locale]) {\n    intl = allIntlMap[locale];\n  }\n\n  var moneySymbol = useMemo(function () {\n    if (customSymbol) {\n      return customSymbol;\n    }\n\n    var defaultText = intl.getMessage('moneySymbol', '￥');\n\n    if (rest.moneySymbol === false || fieldProps.moneySymbol === false) {\n      return undefined;\n    }\n\n    return defaultText;\n  }, [customSymbol, fieldProps.moneySymbol, intl, rest.moneySymbol]);\n\n  if (type === 'read') {\n    var dom = /*#__PURE__*/React.createElement(\"span\", {\n      ref: ref\n    }, getTextByLocale(moneySymbol ? locale : false, text, precision, numberFormatOptions !== null && numberFormatOptions !== void 0 ? numberFormatOptions : fieldProps.numberFormatOptions));\n\n    if (render) {\n      return render(text, _objectSpread({\n        mode: type\n      }, fieldProps), dom);\n    }\n\n    return dom;\n  }\n\n  if (type === 'edit' || type === 'update') {\n    var _dom = /*#__PURE__*/React.createElement(InputNumberPopover, _extends({\n      content: function content(props) {\n        var _props$value, _props$value$toString;\n\n        if (numberPopoverRender === false) return;\n        if (!props.value) return;\n        var reg = new RegExp(\"/B(?=(d{\".concat(3 + (precision - DefaultPrecisionCont), \"})+(?!d))/g\"));\n        var localeText = getTextByLocale(moneySymbol ? locale : false, (_props$value = props.value) === null || _props$value === void 0 ? void 0 : (_props$value$toString = _props$value.toString()) === null || _props$value$toString === void 0 ? void 0 : _props$value$toString.replace(reg, ','), precision, _objectSpread(_objectSpread({}, numberFormatOptions), {}, {\n          notation: 'compact'\n        }));\n\n        if (typeof numberPopoverRender === 'function') {\n          return numberPopoverRender === null || numberPopoverRender === void 0 ? void 0 : numberPopoverRender(props, localeText);\n        }\n\n        return localeText;\n      },\n      ref: ref,\n      precision: precision // 删除默认min={0}，允许输入一个负数的金额，用户可自行配置min来限制是否允许小于0的金额\n      ,\n      formatter: function formatter(value) {\n        if (value && moneySymbol) {\n          var reg = new RegExp(\"/B(?=(d{\".concat(3 + (precision - DefaultPrecisionCont), \"})+(?!d))/g\"));\n          return \"\".concat(moneySymbol, \" \").concat(value).replace(reg, ',');\n        }\n\n        return value === null || value === void 0 ? void 0 : value.toString();\n      },\n      parser: function parser(value) {\n        if (moneySymbol && value) {\n          return value.replace(new RegExp(\"\\\\\".concat(moneySymbol, \"\\\\s?|(,*)\"), 'g'), '');\n        }\n\n        return value;\n      },\n      placeholder: placeholder\n    }, omit(fieldProps, ['numberFormatOptions', 'precision', 'numberPopoverRender', 'customSymbol'])));\n\n    if (renderFormItem) {\n      return renderFormItem(text, _objectSpread({\n        mode: type\n      }, fieldProps), _dom);\n    }\n\n    return _dom;\n  }\n\n  return null;\n};\n\nexport default /*#__PURE__*/React.forwardRef(FieldMoney);","map":{"version":3,"sources":["/Users/jameszow/Documents/RustWorkSpace/covid-ipfs/covid-ipfs-client/node_modules/@ant-design/pro-field/es/components/Money/index.js"],"names":["_Popover","_InputNumber","_extends","_slicedToArray","_objectWithoutProperties","_objectSpread","_excluded","_excluded2","intlMap","allIntlMap","useIntl","omit","useMergedState","React","useMemo","defaultMoneyIntl","Intl","NumberFormat","currency","style","enMoneyIntl","ruMoneyIntl","rsMoneyIntl","msMoneyIntl","ptMoneyIntl","default","getTextByLocale","localeStr","paramsText","precision","config","moneyText","Number","maximumFractionDigits","format","DefaultPrecisionCont","InputNumberPopover","forwardRef","_ref","ref","content","numberFormatOptions","numberPopoverRender","rest","_useMergedState","defaultValue","value","onChange","_useMergedState2","dom","props","visible","createElement","placement","trigger","getPopupContainer","triggerNode","parentElement","document","body","FieldMoney","_ref2","_fieldProps$customSym","_fieldProps$precision","text","type","mode","render","renderFormItem","fieldProps","proFieldKey","plain","valueEnum","placeholder","_ref2$locale","locale","customSymbol","_ref2$customSymbol","_ref2$numberFormatOpt","_ref2$numberPopoverRe","intl","moneySymbol","defaultText","getMessage","undefined","_dom","_props$value","_props$value$toString","reg","RegExp","concat","localeText","toString","replace","notation","formatter","parser"],"mappings":"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","sourcesContent":["import \"antd/es/popover/style\";\nimport _Popover from \"antd/es/popover\";\nimport \"antd/es/input-number/style\";\nimport _InputNumber from \"antd/es/input-number\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nvar _excluded = [\"content\", \"numberFormatOptions\", \"numberPopoverRender\"],\n    _excluded2 = [\"text\", \"mode\", \"render\", \"renderFormItem\", \"fieldProps\", \"proFieldKey\", \"plain\", \"valueEnum\", \"placeholder\", \"locale\", \"customSymbol\", \"numberFormatOptions\", \"numberPopoverRender\"];\nimport { intlMap as allIntlMap, useIntl } from '@ant-design/pro-provider';\nimport omit from 'omit.js';\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport React, { useMemo } from 'react';\nvar defaultMoneyIntl = new Intl.NumberFormat('zh-Hans-CN', {\n  currency: 'CNY',\n  style: 'currency'\n});\nvar enMoneyIntl = {\n  style: 'currency',\n  currency: 'USD'\n};\nvar ruMoneyIntl = {\n  style: 'currency',\n  currency: 'RUB'\n};\nvar rsMoneyIntl = {\n  style: 'currency',\n  currency: 'RSD'\n};\nvar msMoneyIntl = {\n  style: 'currency',\n  currency: 'MYR'\n};\nvar ptMoneyIntl = {\n  style: 'currency',\n  currency: 'BRL'\n};\nvar intlMap = {\n  default: defaultMoneyIntl,\n  'zh-Hans-CN': {\n    currency: 'CNY',\n    style: 'currency'\n  },\n  'en-US': enMoneyIntl,\n  'ru-RU': ruMoneyIntl,\n  'ms-MY': msMoneyIntl,\n  'sr-RS': rsMoneyIntl,\n  'pt-BR': ptMoneyIntl\n};\n\nvar getTextByLocale = function getTextByLocale(localeStr, paramsText, precision, config) {\n  var moneyText = paramsText;\n\n  if (typeof moneyText === 'string') {\n    moneyText = Number(moneyText);\n  }\n\n  if (!moneyText && moneyText !== 0) return '';\n  return new Intl.NumberFormat(localeStr || 'zh-Hans-CN', _objectSpread(_objectSpread({}, intlMap[localeStr || 'zh-Hans-CN'] || intlMap['zh-Hans-CN']), {}, {\n    maximumFractionDigits: precision\n  }, config)).format(moneyText);\n};\n\nvar DefaultPrecisionCont = 2;\nvar InputNumberPopover = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var content = _ref.content,\n      numberFormatOptions = _ref.numberFormatOptions,\n      numberPopoverRender = _ref.numberPopoverRender,\n      rest = _objectWithoutProperties(_ref, _excluded);\n\n  var _useMergedState = useMergedState(function () {\n    return rest.defaultValue;\n  }, {\n    value: rest.value,\n    onChange: rest.onChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      value = _useMergedState2[0],\n      onChange = _useMergedState2[1];\n\n  var dom = content === null || content === void 0 ? void 0 : content(_objectSpread(_objectSpread({}, rest), {}, {\n    value: value\n  }));\n  var props = {\n    visible: dom ? rest.visible : false\n  };\n  return /*#__PURE__*/React.createElement(_Popover, _extends({\n    placement: \"topLeft\"\n  }, props, {\n    trigger: ['focus', 'click'],\n    content: dom,\n    getPopupContainer: function getPopupContainer(triggerNode) {\n      return (triggerNode === null || triggerNode === void 0 ? void 0 : triggerNode.parentElement) || document.body;\n    }\n  }), /*#__PURE__*/React.createElement(_InputNumber, _extends({\n    ref: ref\n  }, rest, {\n    value: value,\n    onChange: onChange\n  })));\n});\n/**\n * 金额组件\n *\n * @param FieldMoneyProps {\n *     text: number;\n *     moneySymbol?: string; }\n */\n\nvar FieldMoney = function FieldMoney(_ref2, ref) {\n  var _fieldProps$customSym, _fieldProps$precision;\n\n  var text = _ref2.text,\n      type = _ref2.mode,\n      render = _ref2.render,\n      renderFormItem = _ref2.renderFormItem,\n      fieldProps = _ref2.fieldProps,\n      proFieldKey = _ref2.proFieldKey,\n      plain = _ref2.plain,\n      valueEnum = _ref2.valueEnum,\n      placeholder = _ref2.placeholder,\n      _ref2$locale = _ref2.locale,\n      locale = _ref2$locale === void 0 ? (_fieldProps$customSym = fieldProps.customSymbol) !== null && _fieldProps$customSym !== void 0 ? _fieldProps$customSym : 'zh-Hans-CN' : _ref2$locale,\n      _ref2$customSymbol = _ref2.customSymbol,\n      customSymbol = _ref2$customSymbol === void 0 ? fieldProps.customSymbol : _ref2$customSymbol,\n      _ref2$numberFormatOpt = _ref2.numberFormatOptions,\n      numberFormatOptions = _ref2$numberFormatOpt === void 0 ? fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.numberFormatOptions : _ref2$numberFormatOpt,\n      _ref2$numberPopoverRe = _ref2.numberPopoverRender,\n      numberPopoverRender = _ref2$numberPopoverRe === void 0 ? (fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.numberPopoverRender) || false : _ref2$numberPopoverRe,\n      rest = _objectWithoutProperties(_ref2, _excluded2);\n\n  var precision = (_fieldProps$precision = fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.precision) !== null && _fieldProps$precision !== void 0 ? _fieldProps$precision : DefaultPrecisionCont;\n  var intl = useIntl(); // 当手动传入locale时，应该以传入的locale为准，未传入时则根据全局的locale进行国际化\n\n  if (locale && allIntlMap[locale]) {\n    intl = allIntlMap[locale];\n  }\n\n  var moneySymbol = useMemo(function () {\n    if (customSymbol) {\n      return customSymbol;\n    }\n\n    var defaultText = intl.getMessage('moneySymbol', '￥');\n\n    if (rest.moneySymbol === false || fieldProps.moneySymbol === false) {\n      return undefined;\n    }\n\n    return defaultText;\n  }, [customSymbol, fieldProps.moneySymbol, intl, rest.moneySymbol]);\n\n  if (type === 'read') {\n    var dom = /*#__PURE__*/React.createElement(\"span\", {\n      ref: ref\n    }, getTextByLocale(moneySymbol ? locale : false, text, precision, numberFormatOptions !== null && numberFormatOptions !== void 0 ? numberFormatOptions : fieldProps.numberFormatOptions));\n\n    if (render) {\n      return render(text, _objectSpread({\n        mode: type\n      }, fieldProps), dom);\n    }\n\n    return dom;\n  }\n\n  if (type === 'edit' || type === 'update') {\n    var _dom = /*#__PURE__*/React.createElement(InputNumberPopover, _extends({\n      content: function content(props) {\n        var _props$value, _props$value$toString;\n\n        if (numberPopoverRender === false) return;\n        if (!props.value) return;\n        var reg = new RegExp(\"/B(?=(d{\".concat(3 + (precision - DefaultPrecisionCont), \"})+(?!d))/g\"));\n        var localeText = getTextByLocale(moneySymbol ? locale : false, (_props$value = props.value) === null || _props$value === void 0 ? void 0 : (_props$value$toString = _props$value.toString()) === null || _props$value$toString === void 0 ? void 0 : _props$value$toString.replace(reg, ','), precision, _objectSpread(_objectSpread({}, numberFormatOptions), {}, {\n          notation: 'compact'\n        }));\n\n        if (typeof numberPopoverRender === 'function') {\n          return numberPopoverRender === null || numberPopoverRender === void 0 ? void 0 : numberPopoverRender(props, localeText);\n        }\n\n        return localeText;\n      },\n      ref: ref,\n      precision: precision // 删除默认min={0}，允许输入一个负数的金额，用户可自行配置min来限制是否允许小于0的金额\n      ,\n      formatter: function formatter(value) {\n        if (value && moneySymbol) {\n          var reg = new RegExp(\"/B(?=(d{\".concat(3 + (precision - DefaultPrecisionCont), \"})+(?!d))/g\"));\n          return \"\".concat(moneySymbol, \" \").concat(value).replace(reg, ',');\n        }\n\n        return value === null || value === void 0 ? void 0 : value.toString();\n      },\n      parser: function parser(value) {\n        if (moneySymbol && value) {\n          return value.replace(new RegExp(\"\\\\\".concat(moneySymbol, \"\\\\s?|(,*)\"), 'g'), '');\n        }\n\n        return value;\n      },\n      placeholder: placeholder\n    }, omit(fieldProps, ['numberFormatOptions', 'precision', 'numberPopoverRender', 'customSymbol'])));\n\n    if (renderFormItem) {\n      return renderFormItem(text, _objectSpread({\n        mode: type\n      }, fieldProps), _dom);\n    }\n\n    return _dom;\n  }\n\n  return null;\n};\n\nexport default /*#__PURE__*/React.forwardRef(FieldMoney);"]},"metadata":{},"sourceType":"module"}