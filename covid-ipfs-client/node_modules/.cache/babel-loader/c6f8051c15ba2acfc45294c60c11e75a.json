{"ast":null,"code":"import \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nvar _excluded = [\"value\", \"text\"],\n    _excluded2 = [\"mode\", \"valueEnum\", \"render\", \"renderFormItem\", \"request\", \"fieldProps\", \"plain\", \"children\", \"light\", \"proFieldKey\", \"params\", \"label\", \"bordered\", \"id\", \"lightLabel\", \"labelTrigger\"];\nimport { useIntl } from '@ant-design/pro-provider';\nimport { nanoid, useDebounceValue, useDeepCompareEffect, useMountMergeState } from '@ant-design/pro-utils';\nimport React, { useCallback, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport useSWR from 'swr';\nimport TableStatus, { ProFieldBadgeColor } from '../Status';\nimport './index.less';\nimport LightSelect from './LightSelect';\nimport SearchSelect from './SearchSelect';\nexport var ObjToMap = function ObjToMap(value) {\n  if (getType(value) === 'map') {\n    return value;\n  }\n\n  return new Map(Object.entries(value || {}));\n};\n/**\n * 转化 text 和 valueEnum 通过 type 来添加 Status\n *\n * @param text\n * @param valueEnum\n * @param pure 纯净模式，不增加 status\n */\n\nexport var proFieldParsingText = function proFieldParsingText(text, valueEnumParams) {\n  if (Array.isArray(text)) {\n    return /*#__PURE__*/React.createElement(_Space, {\n      split: \",\",\n      size: 2\n    }, text.map(function (value) {\n      return (// @ts-ignore\n        proFieldParsingText(value, valueEnumParams)\n      );\n    }));\n  }\n\n  var valueEnum = ObjToMap(valueEnumParams);\n\n  if (!valueEnum.has(text) && !valueEnum.has(\"\".concat(text))) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var domText = valueEnum.get(text) || valueEnum.get(\"\".concat(text));\n\n  if (!domText) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var status = domText.status,\n      color = domText.color;\n  var Status = TableStatus[status || 'Init']; // 如果类型存在优先使用类型\n\n  if (Status) {\n    return /*#__PURE__*/React.createElement(Status, null, domText.text);\n  } // 如果不存在使用颜色\n\n\n  if (color) {\n    return /*#__PURE__*/React.createElement(ProFieldBadgeColor, {\n      color: color\n    }, domText.text);\n  } // 什么都没有使用 text\n\n\n  return domText.text || domText;\n};\n\nvar Highlight = function Highlight(_ref) {\n  var label = _ref.label,\n      words = _ref.words;\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var lightCls = getPrefixCls('pro-select-item-option-content-light');\n  var optionCls = getPrefixCls('pro-select-item-option-content');\n  var matchKeywordsRE = new RegExp(words.map(function (word) {\n    return word.replace(/[-[\\]/{}()*+?.\\\\^$|]/g, '\\\\$&');\n  }).join('|'), 'gi');\n  var matchText = label;\n  var elements = [];\n\n  while (matchText.length) {\n    var match = matchKeywordsRE.exec(matchText);\n\n    if (!match) {\n      elements.push(matchText);\n      break;\n    }\n\n    var start = match.index;\n    var matchLength = match[0].length + start;\n    elements.push(matchText.slice(0, start), /*#__PURE__*/React.createElement('span', {\n      className: lightCls\n    }, matchText.slice(start, matchLength)));\n    matchText = matchText.slice(matchLength);\n  }\n\n  return /*#__PURE__*/React.createElement.apply(React, ['div', {\n    className: optionCls\n  }].concat(elements));\n};\n/**\n * 获取类型的 type\n *\n * @param obj\n */\n\n\nfunction getType(obj) {\n  // @ts-ignore\n  var type = Object.prototype.toString.call(obj).match(/^\\[object (.*)\\]$/)[1].toLowerCase();\n  if (type === 'string' && _typeof(obj) === 'object') return 'object'; // Let \"new String('')\" return 'object'\n\n  if (obj === null) return 'null'; // PhantomJS has type \"DOMWindow\" for null\n\n  if (obj === undefined) return 'undefined'; // PhantomJS has type \"DOMWindow\" for undefined\n\n  return type;\n}\n/**\n * 递归筛选 item\n *\n * @param item\n * @param keyWords\n * @returns\n */\n\n\nfunction filerByItem(item, keyWords) {\n  var _item$label, _item$value;\n\n  if (!keyWords) return true;\n\n  if ((item === null || item === void 0 ? void 0 : (_item$label = item.label) === null || _item$label === void 0 ? void 0 : _item$label.toString().toLowerCase().includes(keyWords.toLowerCase())) || (item === null || item === void 0 ? void 0 : (_item$value = item.value) === null || _item$value === void 0 ? void 0 : _item$value.toString().toLowerCase().includes(keyWords.toLowerCase()))) {\n    return true;\n  }\n\n  if (item.optionType === 'optGroup' && (item.children || item.options)) {\n    var findItem = [].concat(_toConsumableArray(item.children || []), [item.options || []]).find(function (mapItem) {\n      return filerByItem(mapItem, keyWords);\n    });\n    if (findItem) return true;\n  }\n\n  return false;\n}\n/**\n * 把 value 的枚举转化为数组\n *\n * @param valueEnum\n */\n\n\nexport var proFieldParsingValueEnumToArray = function proFieldParsingValueEnumToArray(valueEnumParams) {\n  var enumArray = [];\n  var valueEnum = ObjToMap(valueEnumParams);\n  valueEnum.forEach(function (_, key) {\n    var value = valueEnum.get(key) || valueEnum.get(\"\".concat(key));\n\n    if (!value) {\n      return;\n    }\n\n    if (_typeof(value) === 'object' && (value === null || value === void 0 ? void 0 : value.text)) {\n      enumArray.push({\n        text: value === null || value === void 0 ? void 0 : value.text,\n        value: key,\n        label: value === null || value === void 0 ? void 0 : value.text,\n        disabled: value.disabled\n      });\n      return;\n    }\n\n    enumArray.push({\n      text: value,\n      value: key\n    });\n  });\n  return enumArray;\n};\nexport var useFieldFetchData = function useFieldFetchData(props) {\n  var _props$fieldProps, _ref3, _props$debounceTime, _props$fieldProps3, _props$fieldProps6;\n\n  var cacheForSwr = props.cacheForSwr;\n\n  var _useState = useState(props.defaultKeyWords),\n      _useState2 = _slicedToArray(_useState, 2),\n      keyWords = _useState2[0],\n      setKeyWords = _useState2[1];\n  /** Key 是用来缓存请求的，如果不在是有问题 */\n\n\n  var _useState3 = useState(function () {\n    if (props.proFieldKey) {\n      return props.proFieldKey.toString();\n    }\n\n    if (props.request) {\n      return nanoid();\n    }\n\n    return 'no-fetch';\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      cacheKey = _useState4[0];\n\n  var proFieldKeyRef = useRef(cacheKey);\n  var getOptionsFormValueEnum = useCallback(function (coverValueEnum) {\n    return proFieldParsingValueEnumToArray(ObjToMap(coverValueEnum)).map(function (_ref2) {\n      var value = _ref2.value,\n          text = _ref2.text,\n          rest = _objectWithoutProperties(_ref2, _excluded);\n\n      return _objectSpread({\n        label: text,\n        value: value,\n        key: value\n      }, rest);\n    });\n  }, []);\n\n  var _useMountMergeState = useMountMergeState(function () {\n    if (props.valueEnum) {\n      return getOptionsFormValueEnum(props.valueEnum);\n    }\n\n    return [];\n  }, {\n    value: (_props$fieldProps = props.fieldProps) === null || _props$fieldProps === void 0 ? void 0 : _props$fieldProps.options\n  }),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      options = _useMountMergeState2[0],\n      setOptions = _useMountMergeState2[1];\n\n  useDeepCompareEffect(function () {\n    var _props$fieldProps2; // 优先使用 fieldProps?.options\n\n\n    if (!props.valueEnum || ((_props$fieldProps2 = props.fieldProps) === null || _props$fieldProps2 === void 0 ? void 0 : _props$fieldProps2.options)) return;\n    setOptions(getOptionsFormValueEnum(props.valueEnum));\n  }, [props.valueEnum]);\n  var swrKey = useDebounceValue([proFieldKeyRef.current, props.params, keyWords], (_ref3 = (_props$debounceTime = props.debounceTime) !== null && _props$debounceTime !== void 0 ? _props$debounceTime : props === null || props === void 0 ? void 0 : (_props$fieldProps3 = props.fieldProps) === null || _props$fieldProps3 === void 0 ? void 0 : _props$fieldProps3.debounceTime) !== null && _ref3 !== void 0 ? _ref3 : 0, [props.params, keyWords]);\n\n  var _useSWR = useSWR(function () {\n    if (!props.request) {\n      return null;\n    }\n\n    return swrKey;\n  }, function (_, params, kw) {\n    return props.request(_objectSpread(_objectSpread({}, params), {}, {\n      keyWords: kw\n    }), props);\n  }, {\n    revalidateIfStale: !cacheForSwr,\n    // 打开 cacheForSwr 的时候才应该支持两个功能\n    revalidateOnReconnect: cacheForSwr,\n    shouldRetryOnError: false,\n    // @todo 这个功能感觉应该搞个API出来\n    revalidateOnFocus: false\n  }),\n      data = _useSWR.data,\n      setLocaleData = _useSWR.mutate,\n      isValidating = _useSWR.isValidating;\n\n  var resOptions = useMemo(function () {\n    var _props$fieldProps4, _props$fieldProps5;\n\n    var opt = options === null || options === void 0 ? void 0 : options.map(function (item) {\n      if (typeof item === 'string') {\n        return {\n          label: item,\n          value: item\n        };\n      }\n\n      if ((item === null || item === void 0 ? void 0 : item.optionType) === 'optGroup' && (item.children || item.options)) {\n        var childrenOptions = [].concat(_toConsumableArray(item.children || []), _toConsumableArray(item.options || [])).filter(function (mapItem) {\n          return filerByItem(mapItem, keyWords);\n        });\n        return _objectSpread(_objectSpread({}, item), {}, {\n          children: childrenOptions,\n          options: childrenOptions\n        });\n      }\n\n      return item;\n    }); // filterOption 为 true 时 filter数据, filterOption 默认为true\n\n    if (((_props$fieldProps4 = props.fieldProps) === null || _props$fieldProps4 === void 0 ? void 0 : _props$fieldProps4.filterOption) === true || ((_props$fieldProps5 = props.fieldProps) === null || _props$fieldProps5 === void 0 ? void 0 : _props$fieldProps5.filterOption) === undefined) {\n      return opt === null || opt === void 0 ? void 0 : opt.filter(function (item) {\n        if (!item) return false;\n        if (!keyWords) return true;\n        return filerByItem(item, keyWords);\n      });\n    }\n\n    return opt;\n  }, [options, keyWords, (_props$fieldProps6 = props.fieldProps) === null || _props$fieldProps6 === void 0 ? void 0 : _props$fieldProps6.filterOption]);\n  return [isValidating, props.request ? data : resOptions, function (fetchKeyWords) {\n    setKeyWords(fetchKeyWords);\n  }, function () {\n    setKeyWords(undefined);\n    setLocaleData([], false);\n  }];\n};\n/**\n * 可以根据 valueEnum 来进行类型的设置\n *\n * @param\n */\n\nvar FieldSelect = function FieldSelect(props, ref) {\n  var mode = props.mode,\n      valueEnum = props.valueEnum,\n      render = props.render,\n      renderFormItem = props.renderFormItem,\n      request = props.request,\n      fieldProps = props.fieldProps,\n      plain = props.plain,\n      children = props.children,\n      light = props.light,\n      proFieldKey = props.proFieldKey,\n      params = props.params,\n      label = props.label,\n      bordered = props.bordered,\n      id = props.id,\n      lightLabel = props.lightLabel,\n      labelTrigger = props.labelTrigger,\n      rest = _objectWithoutProperties(props, _excluded2);\n\n  var inputRef = useRef();\n  var intl = useIntl();\n  var keyWordsRef = useRef('');\n  var fieldNames = fieldProps.fieldNames;\n  useEffect(function () {\n    keyWordsRef.current = fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue;\n  }, [fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue]);\n\n  var _useFieldFetchData = useFieldFetchData(props),\n      _useFieldFetchData2 = _slicedToArray(_useFieldFetchData, 4),\n      loading = _useFieldFetchData2[0],\n      options = _useFieldFetchData2[1],\n      _fetchData = _useFieldFetchData2[2],\n      resetData = _useFieldFetchData2[3];\n\n  var size = useContext(_ConfigProvider.SizeContext);\n  useImperativeHandle(ref, function () {\n    return _objectSpread(_objectSpread({}, inputRef.current || {}), {}, {\n      fetchData: function fetchData() {\n        return _fetchData();\n      }\n    });\n  });\n  var optionsValueEnum = useMemo(function () {\n    if (mode !== 'read') return;\n\n    var _ref4 = fieldNames || {},\n        _ref4$label = _ref4.label,\n        labelPropsName = _ref4$label === void 0 ? 'label' : _ref4$label,\n        _ref4$value = _ref4.value,\n        valuePropsName = _ref4$value === void 0 ? 'value' : _ref4$value,\n        _ref4$options = _ref4.options,\n        optionsPropsName = _ref4$options === void 0 ? 'options' : _ref4$options;\n\n    var valuesMap = new Map();\n\n    var traverseOptions = function traverseOptions(_options) {\n      if (!(_options === null || _options === void 0 ? void 0 : _options.length)) {\n        return valuesMap;\n      }\n\n      var length = _options.length;\n      var i = 0;\n\n      while (i < length) {\n        var cur = _options[i++];\n        valuesMap.set(cur[valuePropsName], cur[labelPropsName]);\n        traverseOptions(cur[optionsPropsName]);\n      }\n\n      return valuesMap;\n    };\n\n    return traverseOptions(options);\n  }, [fieldNames, mode, options]);\n\n  if (mode === 'read') {\n    var dom = /*#__PURE__*/React.createElement(React.Fragment, null, proFieldParsingText(rest.text, ObjToMap(valueEnum || optionsValueEnum)));\n\n    if (render) {\n      return render(rest.text, _objectSpread({\n        mode: mode\n      }, fieldProps), dom) || null;\n    }\n\n    return dom;\n  }\n\n  if (mode === 'edit' || mode === 'update') {\n    var renderDom = function renderDom() {\n      if (light) {\n        return /*#__PURE__*/React.createElement(LightSelect, _extends({\n          bordered: bordered,\n          id: id,\n          loading: loading,\n          ref: inputRef,\n          allowClear: true,\n          size: size,\n          options: options,\n          label: label,\n          placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择'),\n          lightLabel: lightLabel,\n          labelTrigger: labelTrigger\n        }, fieldProps));\n      }\n\n      return /*#__PURE__*/React.createElement(SearchSelect, _extends({\n        key: \"SearchSelect\",\n        className: rest.className,\n        style: _objectSpread({\n          minWidth: 100\n        }, rest.style),\n        bordered: bordered,\n        id: id,\n        loading: loading,\n        ref: inputRef,\n        allowClear: true,\n        notFoundContent: loading ? /*#__PURE__*/React.createElement(_Spin, {\n          size: \"small\"\n        }) : fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.notFoundContent,\n        fetchData: function fetchData(keyWord) {\n          keyWordsRef.current = keyWord;\n\n          _fetchData(keyWord);\n        },\n        resetData: resetData,\n        optionItemRender: function optionItemRender(item) {\n          if (typeof item.label === 'string' && keyWordsRef.current) {\n            return /*#__PURE__*/React.createElement(Highlight, {\n              label: item.label,\n              words: [keyWordsRef.current]\n            });\n          }\n\n          return item.label;\n        },\n        placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择'),\n        label: label\n      }, fieldProps, {\n        options: options\n      }));\n    };\n\n    var _dom = renderDom();\n\n    if (renderFormItem) {\n      return renderFormItem(rest.text, _objectSpread(_objectSpread({\n        mode: mode\n      }, fieldProps), {}, {\n        options: options\n      }), _dom) || null;\n    }\n\n    return _dom;\n  }\n\n  return null;\n};\n\nexport default /*#__PURE__*/React.forwardRef(FieldSelect);","map":{"version":3,"sources":["/Users/jameszow/Documents/RustWorkSpace/covid-ipfs/covid-ipfs-client/node_modules/@ant-design/pro-field/es/components/Select/index.js"],"names":["_Spin","_extends","_objectSpread","_objectWithoutProperties","_slicedToArray","_toConsumableArray","_typeof","_ConfigProvider","_Space","_excluded","_excluded2","useIntl","nanoid","useDebounceValue","useDeepCompareEffect","useMountMergeState","React","useCallback","useContext","useEffect","useImperativeHandle","useMemo","useRef","useState","useSWR","TableStatus","ProFieldBadgeColor","LightSelect","SearchSelect","ObjToMap","value","getType","Map","Object","entries","proFieldParsingText","text","valueEnumParams","Array","isArray","createElement","split","size","map","valueEnum","has","concat","label","domText","get","status","color","Status","Highlight","_ref","words","_useContext","ConfigContext","getPrefixCls","lightCls","optionCls","matchKeywordsRE","RegExp","word","replace","join","matchText","elements","length","match","exec","push","start","index","matchLength","slice","className","apply","obj","type","prototype","toString","call","toLowerCase","undefined","filerByItem","item","keyWords","_item$label","_item$value","includes","optionType","children","options","findItem","find","mapItem","proFieldParsingValueEnumToArray","enumArray","forEach","_","key","disabled","useFieldFetchData","props","_props$fieldProps","_ref3","_props$debounceTime","_props$fieldProps3","_props$fieldProps6","cacheForSwr","_useState","defaultKeyWords","_useState2","setKeyWords","_useState3","proFieldKey","request","_useState4","cacheKey","proFieldKeyRef","getOptionsFormValueEnum","coverValueEnum","_ref2","rest","_useMountMergeState","fieldProps","_useMountMergeState2","setOptions","_props$fieldProps2","swrKey","current","params","debounceTime","_useSWR","kw","revalidateIfStale","revalidateOnReconnect","shouldRetryOnError","revalidateOnFocus","data","setLocaleData","mutate","isValidating","resOptions","_props$fieldProps4","_props$fieldProps5","opt","childrenOptions","filter","filterOption","fetchKeyWords","FieldSelect","ref","mode","render","renderFormItem","plain","light","bordered","id","lightLabel","labelTrigger","inputRef","intl","keyWordsRef","fieldNames","searchValue","_useFieldFetchData","_useFieldFetchData2","loading","_fetchData","resetData","SizeContext","fetchData","optionsValueEnum","_ref4","_ref4$label","labelPropsName","_ref4$value","valuePropsName","_ref4$options","optionsPropsName","valuesMap","traverseOptions","_options","i","cur","set","dom","Fragment","renderDom","allowClear","placeholder","getMessage","style","minWidth","notFoundContent","keyWord","optionItemRender","_dom","forwardRef"],"mappings":"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","sourcesContent":["import \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nvar _excluded = [\"value\", \"text\"],\n    _excluded2 = [\"mode\", \"valueEnum\", \"render\", \"renderFormItem\", \"request\", \"fieldProps\", \"plain\", \"children\", \"light\", \"proFieldKey\", \"params\", \"label\", \"bordered\", \"id\", \"lightLabel\", \"labelTrigger\"];\nimport { useIntl } from '@ant-design/pro-provider';\nimport { nanoid, useDebounceValue, useDeepCompareEffect, useMountMergeState } from '@ant-design/pro-utils';\nimport React, { useCallback, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport useSWR from 'swr';\nimport TableStatus, { ProFieldBadgeColor } from '../Status';\nimport './index.less';\nimport LightSelect from './LightSelect';\nimport SearchSelect from './SearchSelect';\nexport var ObjToMap = function ObjToMap(value) {\n  if (getType(value) === 'map') {\n    return value;\n  }\n\n  return new Map(Object.entries(value || {}));\n};\n/**\n * 转化 text 和 valueEnum 通过 type 来添加 Status\n *\n * @param text\n * @param valueEnum\n * @param pure 纯净模式，不增加 status\n */\n\nexport var proFieldParsingText = function proFieldParsingText(text, valueEnumParams) {\n  if (Array.isArray(text)) {\n    return /*#__PURE__*/React.createElement(_Space, {\n      split: \",\",\n      size: 2\n    }, text.map(function (value) {\n      return (// @ts-ignore\n        proFieldParsingText(value, valueEnumParams)\n      );\n    }));\n  }\n\n  var valueEnum = ObjToMap(valueEnumParams);\n\n  if (!valueEnum.has(text) && !valueEnum.has(\"\".concat(text))) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var domText = valueEnum.get(text) || valueEnum.get(\"\".concat(text));\n\n  if (!domText) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var status = domText.status,\n      color = domText.color;\n  var Status = TableStatus[status || 'Init']; // 如果类型存在优先使用类型\n\n  if (Status) {\n    return /*#__PURE__*/React.createElement(Status, null, domText.text);\n  } // 如果不存在使用颜色\n\n\n  if (color) {\n    return /*#__PURE__*/React.createElement(ProFieldBadgeColor, {\n      color: color\n    }, domText.text);\n  } // 什么都没有使用 text\n\n\n  return domText.text || domText;\n};\n\nvar Highlight = function Highlight(_ref) {\n  var label = _ref.label,\n      words = _ref.words;\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var lightCls = getPrefixCls('pro-select-item-option-content-light');\n  var optionCls = getPrefixCls('pro-select-item-option-content');\n  var matchKeywordsRE = new RegExp(words.map(function (word) {\n    return word.replace(/[-[\\]/{}()*+?.\\\\^$|]/g, '\\\\$&');\n  }).join('|'), 'gi');\n  var matchText = label;\n  var elements = [];\n\n  while (matchText.length) {\n    var match = matchKeywordsRE.exec(matchText);\n\n    if (!match) {\n      elements.push(matchText);\n      break;\n    }\n\n    var start = match.index;\n    var matchLength = match[0].length + start;\n    elements.push(matchText.slice(0, start), /*#__PURE__*/React.createElement('span', {\n      className: lightCls\n    }, matchText.slice(start, matchLength)));\n    matchText = matchText.slice(matchLength);\n  }\n\n  return /*#__PURE__*/React.createElement.apply(React, ['div', {\n    className: optionCls\n  }].concat(elements));\n};\n/**\n * 获取类型的 type\n *\n * @param obj\n */\n\n\nfunction getType(obj) {\n  // @ts-ignore\n  var type = Object.prototype.toString.call(obj).match(/^\\[object (.*)\\]$/)[1].toLowerCase();\n  if (type === 'string' && _typeof(obj) === 'object') return 'object'; // Let \"new String('')\" return 'object'\n\n  if (obj === null) return 'null'; // PhantomJS has type \"DOMWindow\" for null\n\n  if (obj === undefined) return 'undefined'; // PhantomJS has type \"DOMWindow\" for undefined\n\n  return type;\n}\n/**\n * 递归筛选 item\n *\n * @param item\n * @param keyWords\n * @returns\n */\n\n\nfunction filerByItem(item, keyWords) {\n  var _item$label, _item$value;\n\n  if (!keyWords) return true;\n\n  if ((item === null || item === void 0 ? void 0 : (_item$label = item.label) === null || _item$label === void 0 ? void 0 : _item$label.toString().toLowerCase().includes(keyWords.toLowerCase())) || (item === null || item === void 0 ? void 0 : (_item$value = item.value) === null || _item$value === void 0 ? void 0 : _item$value.toString().toLowerCase().includes(keyWords.toLowerCase()))) {\n    return true;\n  }\n\n  if (item.optionType === 'optGroup' && (item.children || item.options)) {\n    var findItem = [].concat(_toConsumableArray(item.children || []), [item.options || []]).find(function (mapItem) {\n      return filerByItem(mapItem, keyWords);\n    });\n    if (findItem) return true;\n  }\n\n  return false;\n}\n/**\n * 把 value 的枚举转化为数组\n *\n * @param valueEnum\n */\n\n\nexport var proFieldParsingValueEnumToArray = function proFieldParsingValueEnumToArray(valueEnumParams) {\n  var enumArray = [];\n  var valueEnum = ObjToMap(valueEnumParams);\n  valueEnum.forEach(function (_, key) {\n    var value = valueEnum.get(key) || valueEnum.get(\"\".concat(key));\n\n    if (!value) {\n      return;\n    }\n\n    if (_typeof(value) === 'object' && (value === null || value === void 0 ? void 0 : value.text)) {\n      enumArray.push({\n        text: value === null || value === void 0 ? void 0 : value.text,\n        value: key,\n        label: value === null || value === void 0 ? void 0 : value.text,\n        disabled: value.disabled\n      });\n      return;\n    }\n\n    enumArray.push({\n      text: value,\n      value: key\n    });\n  });\n  return enumArray;\n};\nexport var useFieldFetchData = function useFieldFetchData(props) {\n  var _props$fieldProps, _ref3, _props$debounceTime, _props$fieldProps3, _props$fieldProps6;\n\n  var cacheForSwr = props.cacheForSwr;\n\n  var _useState = useState(props.defaultKeyWords),\n      _useState2 = _slicedToArray(_useState, 2),\n      keyWords = _useState2[0],\n      setKeyWords = _useState2[1];\n  /** Key 是用来缓存请求的，如果不在是有问题 */\n\n\n  var _useState3 = useState(function () {\n    if (props.proFieldKey) {\n      return props.proFieldKey.toString();\n    }\n\n    if (props.request) {\n      return nanoid();\n    }\n\n    return 'no-fetch';\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      cacheKey = _useState4[0];\n\n  var proFieldKeyRef = useRef(cacheKey);\n  var getOptionsFormValueEnum = useCallback(function (coverValueEnum) {\n    return proFieldParsingValueEnumToArray(ObjToMap(coverValueEnum)).map(function (_ref2) {\n      var value = _ref2.value,\n          text = _ref2.text,\n          rest = _objectWithoutProperties(_ref2, _excluded);\n\n      return _objectSpread({\n        label: text,\n        value: value,\n        key: value\n      }, rest);\n    });\n  }, []);\n\n  var _useMountMergeState = useMountMergeState(function () {\n    if (props.valueEnum) {\n      return getOptionsFormValueEnum(props.valueEnum);\n    }\n\n    return [];\n  }, {\n    value: (_props$fieldProps = props.fieldProps) === null || _props$fieldProps === void 0 ? void 0 : _props$fieldProps.options\n  }),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      options = _useMountMergeState2[0],\n      setOptions = _useMountMergeState2[1];\n\n  useDeepCompareEffect(function () {\n    var _props$fieldProps2;\n\n    // 优先使用 fieldProps?.options\n    if (!props.valueEnum || ((_props$fieldProps2 = props.fieldProps) === null || _props$fieldProps2 === void 0 ? void 0 : _props$fieldProps2.options)) return;\n    setOptions(getOptionsFormValueEnum(props.valueEnum));\n  }, [props.valueEnum]);\n  var swrKey = useDebounceValue([proFieldKeyRef.current, props.params, keyWords], (_ref3 = (_props$debounceTime = props.debounceTime) !== null && _props$debounceTime !== void 0 ? _props$debounceTime : props === null || props === void 0 ? void 0 : (_props$fieldProps3 = props.fieldProps) === null || _props$fieldProps3 === void 0 ? void 0 : _props$fieldProps3.debounceTime) !== null && _ref3 !== void 0 ? _ref3 : 0, [props.params, keyWords]);\n\n  var _useSWR = useSWR(function () {\n    if (!props.request) {\n      return null;\n    }\n\n    return swrKey;\n  }, function (_, params, kw) {\n    return props.request(_objectSpread(_objectSpread({}, params), {}, {\n      keyWords: kw\n    }), props);\n  }, {\n    revalidateIfStale: !cacheForSwr,\n    // 打开 cacheForSwr 的时候才应该支持两个功能\n    revalidateOnReconnect: cacheForSwr,\n    shouldRetryOnError: false,\n    // @todo 这个功能感觉应该搞个API出来\n    revalidateOnFocus: false\n  }),\n      data = _useSWR.data,\n      setLocaleData = _useSWR.mutate,\n      isValidating = _useSWR.isValidating;\n\n  var resOptions = useMemo(function () {\n    var _props$fieldProps4, _props$fieldProps5;\n\n    var opt = options === null || options === void 0 ? void 0 : options.map(function (item) {\n      if (typeof item === 'string') {\n        return {\n          label: item,\n          value: item\n        };\n      }\n\n      if ((item === null || item === void 0 ? void 0 : item.optionType) === 'optGroup' && (item.children || item.options)) {\n        var childrenOptions = [].concat(_toConsumableArray(item.children || []), _toConsumableArray(item.options || [])).filter(function (mapItem) {\n          return filerByItem(mapItem, keyWords);\n        });\n        return _objectSpread(_objectSpread({}, item), {}, {\n          children: childrenOptions,\n          options: childrenOptions\n        });\n      }\n\n      return item;\n    }); // filterOption 为 true 时 filter数据, filterOption 默认为true\n\n    if (((_props$fieldProps4 = props.fieldProps) === null || _props$fieldProps4 === void 0 ? void 0 : _props$fieldProps4.filterOption) === true || ((_props$fieldProps5 = props.fieldProps) === null || _props$fieldProps5 === void 0 ? void 0 : _props$fieldProps5.filterOption) === undefined) {\n      return opt === null || opt === void 0 ? void 0 : opt.filter(function (item) {\n        if (!item) return false;\n        if (!keyWords) return true;\n        return filerByItem(item, keyWords);\n      });\n    }\n\n    return opt;\n  }, [options, keyWords, (_props$fieldProps6 = props.fieldProps) === null || _props$fieldProps6 === void 0 ? void 0 : _props$fieldProps6.filterOption]);\n  return [isValidating, props.request ? data : resOptions, function (fetchKeyWords) {\n    setKeyWords(fetchKeyWords);\n  }, function () {\n    setKeyWords(undefined);\n    setLocaleData([], false);\n  }];\n};\n/**\n * 可以根据 valueEnum 来进行类型的设置\n *\n * @param\n */\n\nvar FieldSelect = function FieldSelect(props, ref) {\n  var mode = props.mode,\n      valueEnum = props.valueEnum,\n      render = props.render,\n      renderFormItem = props.renderFormItem,\n      request = props.request,\n      fieldProps = props.fieldProps,\n      plain = props.plain,\n      children = props.children,\n      light = props.light,\n      proFieldKey = props.proFieldKey,\n      params = props.params,\n      label = props.label,\n      bordered = props.bordered,\n      id = props.id,\n      lightLabel = props.lightLabel,\n      labelTrigger = props.labelTrigger,\n      rest = _objectWithoutProperties(props, _excluded2);\n\n  var inputRef = useRef();\n  var intl = useIntl();\n  var keyWordsRef = useRef('');\n  var fieldNames = fieldProps.fieldNames;\n  useEffect(function () {\n    keyWordsRef.current = fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue;\n  }, [fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue]);\n\n  var _useFieldFetchData = useFieldFetchData(props),\n      _useFieldFetchData2 = _slicedToArray(_useFieldFetchData, 4),\n      loading = _useFieldFetchData2[0],\n      options = _useFieldFetchData2[1],\n      _fetchData = _useFieldFetchData2[2],\n      resetData = _useFieldFetchData2[3];\n\n  var size = useContext(_ConfigProvider.SizeContext);\n  useImperativeHandle(ref, function () {\n    return _objectSpread(_objectSpread({}, inputRef.current || {}), {}, {\n      fetchData: function fetchData() {\n        return _fetchData();\n      }\n    });\n  });\n  var optionsValueEnum = useMemo(function () {\n    if (mode !== 'read') return;\n\n    var _ref4 = fieldNames || {},\n        _ref4$label = _ref4.label,\n        labelPropsName = _ref4$label === void 0 ? 'label' : _ref4$label,\n        _ref4$value = _ref4.value,\n        valuePropsName = _ref4$value === void 0 ? 'value' : _ref4$value,\n        _ref4$options = _ref4.options,\n        optionsPropsName = _ref4$options === void 0 ? 'options' : _ref4$options;\n\n    var valuesMap = new Map();\n\n    var traverseOptions = function traverseOptions(_options) {\n      if (!(_options === null || _options === void 0 ? void 0 : _options.length)) {\n        return valuesMap;\n      }\n\n      var length = _options.length;\n      var i = 0;\n\n      while (i < length) {\n        var cur = _options[i++];\n        valuesMap.set(cur[valuePropsName], cur[labelPropsName]);\n        traverseOptions(cur[optionsPropsName]);\n      }\n\n      return valuesMap;\n    };\n\n    return traverseOptions(options);\n  }, [fieldNames, mode, options]);\n\n  if (mode === 'read') {\n    var dom = /*#__PURE__*/React.createElement(React.Fragment, null, proFieldParsingText(rest.text, ObjToMap(valueEnum || optionsValueEnum)));\n\n    if (render) {\n      return render(rest.text, _objectSpread({\n        mode: mode\n      }, fieldProps), dom) || null;\n    }\n\n    return dom;\n  }\n\n  if (mode === 'edit' || mode === 'update') {\n    var renderDom = function renderDom() {\n      if (light) {\n        return /*#__PURE__*/React.createElement(LightSelect, _extends({\n          bordered: bordered,\n          id: id,\n          loading: loading,\n          ref: inputRef,\n          allowClear: true,\n          size: size,\n          options: options,\n          label: label,\n          placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择'),\n          lightLabel: lightLabel,\n          labelTrigger: labelTrigger\n        }, fieldProps));\n      }\n\n      return /*#__PURE__*/React.createElement(SearchSelect, _extends({\n        key: \"SearchSelect\",\n        className: rest.className,\n        style: _objectSpread({\n          minWidth: 100\n        }, rest.style),\n        bordered: bordered,\n        id: id,\n        loading: loading,\n        ref: inputRef,\n        allowClear: true,\n        notFoundContent: loading ? /*#__PURE__*/React.createElement(_Spin, {\n          size: \"small\"\n        }) : fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.notFoundContent,\n        fetchData: function fetchData(keyWord) {\n          keyWordsRef.current = keyWord;\n\n          _fetchData(keyWord);\n        },\n        resetData: resetData,\n        optionItemRender: function optionItemRender(item) {\n          if (typeof item.label === 'string' && keyWordsRef.current) {\n            return /*#__PURE__*/React.createElement(Highlight, {\n              label: item.label,\n              words: [keyWordsRef.current]\n            });\n          }\n\n          return item.label;\n        },\n        placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择'),\n        label: label\n      }, fieldProps, {\n        options: options\n      }));\n    };\n\n    var _dom = renderDom();\n\n    if (renderFormItem) {\n      return renderFormItem(rest.text, _objectSpread(_objectSpread({\n        mode: mode\n      }, fieldProps), {}, {\n        options: options\n      }), _dom) || null;\n    }\n\n    return _dom;\n  }\n\n  return null;\n};\n\nexport default /*#__PURE__*/React.forwardRef(FieldSelect);"]},"metadata":{},"sourceType":"module"}